import{r as ro,g as ke,a as to,b as no,c as io,_ as X,d as $,l as sr,f as er,h as oo,i as ao,j as so,k as ct,S as De,m as ne,n as cr,o as co,p as fi,e as yr}from"./index.027ae11e.js";import{w as G,N as mt}from"./scheduler.e2128b0a.js";import{p as uo}from"./index.a31f2cbe.js";var yt;(function(e){e.account_created="account_created",e.account_credited="account_credited",e.account_debited="account_debited",e.account_home_domain_updated="account_home_domain_updated",e.account_inflation_destination_updated="account_inflation_destination_updated",e.account_removed="account_removed",e.account_thresholds_updated="account_thresholds_updated",e.signer_created="signer_created",e.signer_removed="signer_removed",e.signer_updated="signer_updated",e.trade="trade",e.trustline_created="trustline_created",e.trustline_removed="trustline_removed",e.trustline_updated="trustline_updated"})(yt||(yt={}));var be;(function(e){e.albedo="albedo",e.ledger="ledger",e.freighter="freighter",e.plaintextKey="plaintextKey",e.trezor="trezor"})(be||(be={}));var Le;(function(e){e.ok="ok",e.non_interactive_customer_info_needed="non_interactive_customer_info_needed",e.interactive_customer_info_needed="interactive_customer_info_needed",e.customer_info_status="customer_info_status",e.error="error"})(Le||(Le={}));var Me;(function(e){e.incomplete="incomplete",e.pending_user_transfer_start="pending_user_transfer_start",e.pending_user_transfer_complete="pending_user_transfer_complete",e.pending_external="pending_external",e.pending_anchor="pending_anchor",e.pending_stellar="pending_stellar",e.pending_trust="pending_trust",e.pending_user="pending_user",e.completed="completed",e.refunded="refunded",e.no_market="no_market",e.too_small="too_small",e.too_large="too_large",e.error="error"})(Me||(Me={}));var St;(function(e){e.success="success",e.revised="revised",e.pending="pending",e.actionRequired="action_required",e.rejected="rejected"})(St||(St={}));var Tt;(function(e){e.noFurtherActionRequired="no_further_action_required",e.followNextUrl="follow_next_url"})(Tt||(Tt={}));var lo=ro();const fo=ke(lo);var Rt=to();no();io();Rt&&Rt.isConcatSpreadable;function tt(){const e=new Uint32Array(4);if(typeof crypto<"u"&&crypto.getRandomValues)crypto.getRandomValues(e);else for(let r=0;r<e.length;r++)e[r]=Math.floor(Math.random()*4294967295);return Array.from(e).map(r=>r.toString(36)).join("")}const di={public_key:{risk:"low",title:"View public key",description:"Requests account public key. It's a simple way of authentication for Stellar-based applications. The response ensures that a user owns the corresponding secret key.",unsafe:!1,implicitFlow:!1,params:{token:{description:"Verification token generated by the application (should be unique or random).",required:!1}},returns:["pubkey","signed_message","signature"]},sign_message:{risk:"medium",title:"Sign text message",description:"Requests arbitrary message signing. Can be used to implement identity/ownership verification.",unsafe:!1,implicitFlow:!0,params:{message:{description:"Text message to sign.",required:!0},pubkey:{description:"Specific public key requested by the application.",required:!1}},returns:["pubkey","message","original_message","message_signature"]},tx:{risk:"high",title:"Sign transaction",description:"Requests a signature for the transaction. Returns signed transaction envelope that can be submitted to the network or used for multi-sig coordination.",unsafe:!0,implicitFlow:!0,params:{xdr:{description:"XDR-encoded transaction envelope to sign.",required:!0},pubkey:{description:"Specific public key requested by the application.",required:!1},network:{description:"Stellar network identifier or private network passphrase.",required:!1},horizon:{description:"The URL of the Horizon server.",required:!1},callback:{description:"Optional URL callback where signer will POST signed transaction XDR instead of submitting it to Horizon. ",required:!1},submit:{description:"If set, the signed transaction will be submitted to the Horizon server instead of returning it to the application.",required:!1,type:Boolean}},returns:["xdr","signed_envelope_xdr","pubkey","tx_signature","network","submit"]},pay:{risk:"high",title:"Make payment",description:"Requests a payment from a user. Works with any Stellar asset, supports transaction memo.",unsafe:!1,implicitFlow:!0,params:{amount:{description:"Requested payment amount.",required:!0},destination:{description:"Payment destination.",required:!0},asset_code:{description:"Asset code (skip for XLM).",required:!1},asset_issuer:{description:"Asset issuer (skip for XLM).",required:!1},memo:{description:"Transaction memo (required for exchanges and some anchors).",required:!1},memo_type:{description:"Transaction memo type.",required:!1},pubkey:{description:"Specific public key requested by the application.",required:!1},network:{description:"Stellar network identifier or private network passphrase.",required:!1},horizon:{description:"The URL of the Horizon server.",required:!1},callback:{description:"Optional URL callback where signer will POST signed transaction XDR instead of submitting it to Horizon. ",required:!1},submit:{description:"If set, the signed transaction will be submitted to the Horizon server instead of returning it to the application.",required:!1,type:Boolean}},returns:["amount","destination","asset_code","asset_issuer","memo","memo_type","signed_envelope_xdr","pubkey","tx_signature","network","horizon"]},trust:{risk:"low",title:"Establish trustline",description:"Requests permission to create a trustline to a given Stellar asset. Gradually simplifies the process of creating trustlines for anchors, ICOs, and airdrops.",unsafe:!1,implicitFlow:!0,params:{asset_code:{description:"Trustline asset code.",required:!0},asset_issuer:{description:"Trustline asset issuer address.",required:!0},limit:{description:"Trust limit.",required:!1},memo:{description:"Transaction memo (required for exchanges and some anchors).",required:!1},memo_type:{description:"Transaction memo type.",required:!1},pubkey:{description:"Specific public key requested by the application.",required:!1},network:{description:"Stellar network identifier or private network passphrase.",required:!1},horizon:{description:"The URL of the Horizon server.",required:!1},callback:{description:"Optional URL callback where signer will POST signed transaction XDR instead of submitting it to Horizon. ",required:!1},submit:{description:"If set, the signed transaction will be submitted to the Horizon server instead of returning it to the application.",required:!1,type:Boolean}},returns:["asset_code","asset_issuer","limit","memo","memo_type","signed_envelope_xdr","pubkey","tx_signature","network","horizon"]},exchange:{risk:"high",title:"Purchase tokens",description:"Requests permission to buy tokens on Stellar DEX at market price.",unsafe:!0,implicitFlow:!1,params:{sell_asset_code:{description:"Asset code of the asset to sell.",required:!1},sell_asset_issuer:{description:"Issuer account of the asset to sell.",required:!1},buy_asset_code:{description:"Asset code of the asset to buy.",required:!1},buy_asset_issuer:{description:"Issuer account of the asset to buy.",required:!1},amount:{description:"The amount of asset to buy.",required:!0},max_price:{description:"Maximum price the user willing to pay.",required:!0},memo:{description:"Transaction memo (required for exchanges and some anchors).",required:!1},memo_type:{description:"Transaction memo type.",required:!1},pubkey:{description:"Specific public key requested by the application.",required:!1},network:{description:"Stellar network identifier or private network passphrase.",required:!1},horizon:{description:"The URL of the Horizon server.",required:!1},callback:{description:"Optional URL callback where signer will POST signed transaction XDR instead of submitting it to Horizon. ",required:!1},submit:{description:"If set, the signed transaction will be submitted to the Horizon server instead of returning it to the application.",required:!1,type:Boolean}},returns:["amount","max_price","sell_asset_code","sell_asset_issuer","buy_asset_code","buy_asset_issuer","memo","memo_type","signed_envelope_xdr","pubkey","tx_signature","network","horizon"]},implicit_flow:{risk:"high",title:"Implicit permissions",description:'Requests temporary access token for one or more intents that can be used to execute actions without explicit confirmation from the user. In order to be executed implicitly, an implicit flow permissions for a given intent should be granted and "pubkey" parameter set.',unsafe:!0,implicitFlow:!1,params:{intents:{description:"Requested intents for the implicit flow.",required:!0},network:{description:"Stellar network identifier or private network passphrase.",required:!1}},returns:["granted","intents","grants","session","pubkey","network","valid_until"]}},ut={unhandledError:{message:"Unhandled error occurred. If this error persists, please contact Albedo support.",code:-1},externalError:{message:"External error occurred.",code:-2},invalidIntentRequest:{message:"Intent request is invalid.",code:-3},actionRejectedByUser:{message:"Action request was rejected by the user.",code:-4},horizonError:{message:"Transaction failed when submitted to Stellar network.",code:-5},callbackError:{message:"Callback redirect failed.",code:-6}},po="@albedo-link/intent",ho="0.9.6",Eo="A lightweight browser wrapper for Albedo API that provides a promise-based interface for all supported intents.",vo="StellarExpertTeam<info@stellar.expert>",_o="MIT",go="https://github.com/stellar-expert/albedo",mo={url:"https://github.com/stellar-expert/albedo/issues",email:"info@stellar.expert"},yo={type:"git",url:"https://github.com/stellar-expert/albedo.git"},So={postbuild:"node ./build/update-readme.js",build:"webpack --mode=production --config ./webpack.config.js",test:"./node_modules/.bin/mocha --require @babel/register"},To="./lib/albedo.intent.js",Ro="./src/index.js",wo=["stellar","SSO","signer","intent","multi-sig"],Oo={"@babel/core":"^7.11.6","@babel/plugin-proposal-class-properties":"^7.10.4","@babel/plugin-proposal-decorators":"^7.10.5","@babel/plugin-proposal-object-rest-spread":"^7.11.0","@babel/plugin-proposal-private-methods":"^7.10.4","@babel/plugin-syntax-dynamic-import":"^7.8.3","@babel/preset-env":"^7.11.5","@babel/register":"^7.11.5","babel-loader":"^8.1.0",chai:"^4.2.0",esm:"^3.2.25",mocha:"^8.1.3",sinon:"^9.1.0","terser-webpack-plugin":"^4.2.2",webpack:"^4.44.2","webpack-cli":"^3.3.12"},bo={name:po,version:ho,description:Eo,author:vo,license:_o,homepage:go,bugs:mo,repository:yo,scripts:So,main:To,module:Ro,keywords:wo,devDependencies:Oo};function lt(e,r=!1){this.windowHandler=e,this.ephemeral=!!r,this.isLoaded=!1,this.pendingRequests={},this.preprocessRequestParams=null,this.onLoaded=new Promise((t,i)=>this.onLoadedCallback=t).then(()=>this),this.messageHandler=this.messageHandler.bind(this),G.addEventListener("message",this.messageHandler,!1)}lt.prototype={isLoaded:!1,markLoaded(){const{onLoadedCallback:e}=this;e&&(this.onLoadedCallback=null,this.isLoaded=!0,e())},messageHandler({data:e}){if(e.albedo)return e.albedo,this.markLoaded();if(e.albedoIntentResult){const{__reqid:r,...t}=e.albedoIntentResult,i=this.pendingRequests[r];i&&(delete this.pendingRequests[r],i(t.error,t),this.ephemeral&&(G.removeEventListener("message",this.messageHandler,!1),this.windowHandler.close()))}},transportCloseHandler(){for(let e in this.pendingRequests)if(this.pendingRequests.hasOwnProperty(e)){const r=this.pendingRequests[e];delete this.pendingRequests[e],r(ut.actionRejectedByUser)}},postMessage(e){const r=tt();return new Promise((t,i)=>{this.onLoaded.then(()=>{this.pendingRequests[r]=(o,n)=>o?i(o):t(n),e=Object.assign({__reqid:r,__albedo_intent_version:bo.version},e),this.preprocessRequestParams&&(e=this.preprocessRequestParams(e)),this.windowHandler.postMessage(e,"*")})})}};function Io(e){const r=`${e}/confirm`,t=440,i=600,o=G.screenLeft!==void 0?G.screenLeft:G.screenX,n=G.screenTop!==void 0?G.screenTop:G.screenY,a=G.innerWidth?G.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,l=G.innerHeight?G.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,c=a/2-t/2+o,h=l/2-i/2+n,p=G.open(r,"auth.albedo.link",`height=${i},width=${t},top=${h},left=${c},menubar=0,toolbar=0,location=0,status=0,personalbar=0,scrollbars=0,dependent=1`);return new lt(p,!0).onLoaded}let Ir=null;function wt(e){if(!Ir){const r=document.createElement("iframe");r.style.border="none",Object.assign(r,{width:"0",height:"0",frameBorder:"0",referrerPolicy:"origin",src:`${e}`}),document.body.appendChild(r),Ir=new lt(r.contentWindow)}return Ir.onLoaded}function ft({session:e,pubkey:r,grants:t,valid_until:i}){this.key=e,this.pubkey=r,this.grants=t.slice(),this.validUntil=i,Object.freeze(this),Object.freeze(this.grants)}ft.prototype={key:"",pubkey:"",grants:[],validUntil:0,get isExpired(){return this.validUntil-2e3<new Date().getTime()},toJSON(){return{session:this.key,pubkey:this.pubkey,grants:this.grants.slice(),valid_until:this.validUntil}}};const dt="albedo_session_";function pt(){return G.sessionStorage}function No(e){const r=new ft(e);pt().setItem(dt+r.pubkey,JSON.stringify(r))}function pi(e,r){let t;{const i=pt().getItem(dt+r);i&&(t=new ft(JSON.parse(i)))}return!t||t.isExpired||!t.grants.includes(e)?null:t}function Ao(){const e=pt();return Object.keys(e).filter(r=>r.indexOf(dt)===0).map(r=>JSON.parse(e.getItem(r)))}function Co(e,r){const{intent:t}=e;if(!t)return Promise.reject(new Error('Parameter "intent" is required.'));const i=di[t];if(!i)return Promise.reject(new Error(`Unknown intent: "${t}".`));let o;try{o=Uo(i,e)}catch(n){return Promise.reject(n)}return Po(o,r).then(n=>xo(o,n))}function Po(e,r){if(e.pubkey){const t=pi(e.intent,e.pubkey);if(t)return e.session=t.key,wt(r)}return setTimeout(()=>{e.intent==="implicit_flow"&&wt(r)},200),Io(r)}function xo(e,r){return r.postMessage(e).then(t=>(t.intent==="implicit_flow"&&t.granted&&No(t),t))}function Uo(e,r){if(typeof r!="object")throw new Error("Intent parameters expected.");const{intent:t,pubkey:i}=r,o={intent:t};if(i&&!/^G[0-9A-Z]{55}$/.test(i))throw new Error('Invalid "pubkey" parameter. Stellar account public key expected.');for(const n in e.params){const a=e.params[n],l=r[n];if(l)o[n]=l;else if(a.required){const c=Object.assign(new Error,ut.invalidIntentRequest);throw c.ext=`Parameter "${n}" is required for intent "${t}".`,c}}return o}function Mo(e=null){e===null&&(e=G.location.search),e[0]==="?"&&(e=e.substr(1));const r={};for(let t of e.split("&")){const[i,o]=t.split("=").map(n=>decodeURIComponent(n));r[i]=o}return r}function Do(e){typeof document>"u"||!document.addEventListener||document.addEventListener("click",function(t){if(t.target.tagName!=="A"||(t.target.href||"").indexOf("web+stellar:")!==0)return;t.preventDefault(),t.stopImmediatePropagation();const{pathname:i,search:o}=new URL(t.target.href);if(!["tx","pay"].includes(i)){alert(`Invalid operation requested: ${i}. It's likely an external application error. Please contact support team of ${G.location.origin}.`);return}const n=Mo(o);e.request(i,n)},!1)}if(typeof G=="object"&&typeof G.fetch!="function")throw new Error("Browser FetchAPI is not available. For legacy browsers support use polyfills such as whatwg-fetch.");function Tr(){this.frontendUrl="https://albedo.link"}Tr.prototype={frontendUrl:"https://albedo.link",request(e,r){return Co(Object.assign(r||{},{intent:e}),this.frontendUrl)},implicitFlow(e){return this.request("implicit_flow",e)},publicKey(e){return e=Object.assign({},e),e.token||(e.token=tt()),this.request("public_key",e)},tx(e){return this.request("tx",e)},pay(e){return this.request("pay",e)},trust(e){return this.request("trust",e)},exchange(e){return this.request("exchange",e)},signMessage(e){return e=Object.assign({},e,{message:Lo(e.message)}),this.request("sign_message",e)},generateRandomToken(){return tt()},isImplicitSessionAllowed(e,r){return!!pi(e,r)},listImplicitSessions(){return Ao()},forgetImplicitSession(e){forgetSession(e)}};function Lo(e){switch(typeof e){case"string":return e;case"undefined":return""}return JSON.stringify(e)}Tr.intentInterface=di;Tr.intentErrors=ut;const hi=new Tr;Do(hi);var ko={keyType:be.albedo,signTransaction:function(e){return X(this,void 0,void 0,function(){var r,t,i,o,n;return $(this,function(a){switch(a.label){case 0:if(r=e.transaction,t=e.key,t.privateKey!=="")throw new Error("Non-ledger key sent to ledger handler: "+JSON.stringify(t.publicKey));a.label=1;case 1:return a.trys.push([1,3,,4]),i=r.toXDR(),[4,hi.tx({xdr:i})];case 2:if(o=a.sent(),!o.signed_envelope_xdr)throw new Error("We couldn’t sign the transaction with Albedo.");return[2,sr.TransactionBuilder.fromXDR(o.signed_envelope_xdr,sr.Networks.PUBLIC)];case 3:throw n=a.sent(),new Error("We couldn’t sign the transaction with Albedo. "+n.toString()+".");case 4:return[2]}})})}},Ei={exports:{}};(function(e,r){(function(t,i){e.exports=i()})(er,function(){return function(t){var i={};function o(n){if(i[n])return i[n].exports;var a=i[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,o),a.l=!0,a.exports}return o.m=t,o.c=i,o.d=function(n,a,l){o.o(n,a)||Object.defineProperty(n,a,{enumerable:!0,get:l})},o.r=function(n){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},o.t=function(n,a){if(1&a&&(n=o(n)),8&a||4&a&&typeof n=="object"&&n&&n.__esModule)return n;var l=Object.create(null);if(o.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:n}),2&a&&typeof n!="string")for(var c in n)o.d(l,c,(function(h){return n[h]}).bind(null,c));return l},o.n=function(n){var a=n&&n.__esModule?function(){return n.default}:function(){return n};return o.d(a,"a",a),a},o.o=function(n,a){return Object.prototype.hasOwnProperty.call(n,a)},o.p="",o(o.s=0)}([function(t,i,o){var n,a;o.r(i),function(d){d.CREATE_ACCOUNT="CREATE_ACCOUNT",d.FUND_ACCOUNT="FUND_ACCOUNT",d.ADD_ACCOUNT="ADD_ACCOUNT",d.IMPORT_ACCOUNT="IMPORT_ACCOUNT",d.IMPORT_HARDWARE_WALLET="IMPORT_HARDWARE_WALLET",d.LOAD_ACCOUNT="LOAD_ACCOUNT",d.MAKE_ACCOUNT_ACTIVE="MAKE_ACCOUNT_ACTIVE",d.UPDATE_ACCOUNT_NAME="UPDATE_ACCOUNT_NAME",d.GET_MNEMONIC_PHRASE="GET_MNEMONIC_PHRASE",d.CONFIRM_MNEMONIC_PHRASE="CONFIRM_MNEMONIC_PHRASE",d.RECOVER_ACCOUNT="RECOVER_ACCOUNT",d.CONFIRM_PASSWORD="CONFIRM_PASSWORD",d.REJECT_ACCESS="REJECT_ACCESS",d.GRANT_ACCESS="GRANT_ACCESS",d.SIGN_TRANSACTION="SIGN_TRANSACTION",d.HANDLE_SIGNED_HW_TRANSACTION="HANDLE_SIGNED_HW_TRANSACTION",d.REJECT_TRANSACTION="REJECT_TRANSACTION",d.SIGN_FREIGHTER_TRANSACTION="SIGN_FREIGHTER_TRANSACTION",d.SIGN_FREIGHTER_SOROBAN_TRANSACTION="SIGN_FREIGHTER_SOROBAN_TRANSACTION",d.ADD_RECENT_ADDRESS="ADD_RECENT_ADDRESS",d.LOAD_RECENT_ADDRESSES="LOAD_RECENT_ADDRESSES",d.SIGN_OUT="SIGN_OUT",d.SHOW_BACKUP_PHRASE="SHOW_BACKUP_PHRASE",d.SAVE_SETTINGS="SAVE_SETTINGS",d.LOAD_SETTINGS="LOAD_SETTINGS",d.GET_CACHED_ASSET_ICON="GET_CACHED_ASSET_ICON",d.CACHE_ASSET_ICON="CACHE_ASSET_ICON",d.GET_CACHED_ASSET_DOMAIN="GET_CACHED_ASSET_DOMAIN",d.CACHE_ASSET_DOMAIN="CACHE_ASSET_DOMAIN",d.GET_BLOCKED_ACCOUNTS="GET_BLOCKED_ACCOUNTS",d.GET_BLOCKED_DOMAINS="GET_BLOCKED_DOMAINS",d.ADD_CUSTOM_NETWORK="ADD_CUSTOM_NETWORK",d.CHANGE_NETWORK="CHANGE_NETWORK",d.REMOVE_CUSTOM_NETWORK="REMOVE_CUSTOM_NETWORK",d.EDIT_CUSTOM_NETWORK="EDIT_CUSTOM_NETWORK",d.RESET_EXP_DATA="RESET_EXP_DATA",d.ADD_TOKEN_ID="ADD_TOKEN_ID",d.GET_TOKEN_IDS="GET_TOKEN_IDS"}(n||(n={})),function(d){d.REQUEST_ACCESS="REQUEST_ACCESS",d.SUBMIT_TRANSACTION="SUBMIT_TRANSACTION",d.REQUEST_NETWORK="REQUEST_NETWORK",d.REQUEST_NETWORK_DETAILS="REQUEST_NETWORK_DETAILS",d.REQUEST_CONNECTION_STATUS="REQUEST_CONNECTION_STATUS",d.REQUEST_ALLOWED_STATUS="REQUEST_ALLOWED_STATUS",d.SET_ALLOWED_STATUS="SET_ALLOWED_STATUS",d.REQUEST_USER_INFO="REQUEST_USER_INFO"}(a||(a={}));const l=d=>{const E=Date.now()+Math.random();return G.postMessage({source:"FREIGHTER_EXTERNAL_MSG_REQUEST",messageId:E,...d},G.location.origin),new Promise(m=>{let s=0;d.type===a.REQUEST_CONNECTION_STATUS&&(s=setTimeout(()=>{m({isConnected:!1}),G.removeEventListener("message",w)},2e3));const w=b=>{var O,C;b.source===G&&((O=b==null?void 0:b.data)===null||O===void 0?void 0:O.source)==="FREIGHTER_EXTERNAL_MSG_RESPONSE"&&((C=b==null?void 0:b.data)===null||C===void 0?void 0:C.messagedId)===E&&(m(b.data),G.removeEventListener("message",w),clearTimeout(s))};G.addEventListener("message",w,!1)})},c=()=>I?(async()=>{let d={publicKey:"",error:""};try{d=await l({type:a.REQUEST_ACCESS})}catch(s){console.error(s)}const{publicKey:E,error:m}=d;if(m)throw m;return E})():Promise.resolve(""),h=(d,E)=>I?(async(m,s,w)=>{let b="",O="",C="";typeof s=="object"?(b=s.network||"",O=s.accountToSign||"",C=s.networkPassphrase||""):(b=s||"",O=w||"");let q={signedTransaction:"",error:""};try{q=await l({transactionXdr:m,network:b,networkPassphrase:C,accountToSign:O,type:a.SUBMIT_TRANSACTION})}catch(J){console.error(J)}const{signedTransaction:K,error:j}=q;if(j)throw j;return K})(d,E):Promise.resolve(""),p=()=>I?G.freighter?Promise.resolve(G.freighter):(async()=>{let d={isConnected:!1};try{d=await l({type:a.REQUEST_CONNECTION_STATUS})}catch(E){console.error(E)}return d.isConnected})():Promise.resolve(!1),f=()=>I?(async()=>{let d={network:"",error:""};try{d=await l({type:a.REQUEST_NETWORK})}catch(s){console.error(s)}const{network:E,error:m}=d;if(m)throw m;return E})():Promise.resolve(""),u=()=>I?(async()=>{let d={networkDetails:{network:"",networkName:"",networkUrl:"",networkPassphrase:""},error:""};try{d=await l({type:a.REQUEST_NETWORK_DETAILS})}catch(O){console.error(O)}const{networkDetails:E,error:m}=d,{network:s,networkUrl:w,networkPassphrase:b}=E;if(m)throw m;return{network:s,networkUrl:w,networkPassphrase:b}})():Promise.resolve({network:"",networkUrl:"",networkPassphrase:""}),v=()=>I?(async()=>{let d={isAllowed:!1};try{d=await l({type:a.REQUEST_ALLOWED_STATUS})}catch(E){console.error(E)}return d.isAllowed})():Promise.resolve(!1),T=()=>I?(async()=>{let d={isAllowed:!1,error:""};try{d=await l({type:a.SET_ALLOWED_STATUS})}catch(s){console.error(s)}const{isAllowed:E,error:m}=d;if(m)throw m;return E})():Promise.resolve(!1),y=()=>I?(async()=>{let d={userInfo:{publicKey:""},error:""};try{d=await l({type:a.REQUEST_USER_INFO})}catch(s){console.error(s)}const{userInfo:E,error:m}=d;if(m)throw m;return E})():Promise.resolve({publicKey:""});o.d(i,"isBrowser",function(){return I}),o.d(i,"getPublicKey",function(){return c}),o.d(i,"signTransaction",function(){return h}),o.d(i,"isConnected",function(){return p}),o.d(i,"getNetwork",function(){return f}),o.d(i,"getNetworkDetails",function(){return u}),o.d(i,"isAllowed",function(){return v}),o.d(i,"setAllowed",function(){return T}),o.d(i,"getUserInfo",function(){return y});const I=typeof G<"u";i.default={getPublicKey:c,signTransaction:h,isConnected:p,getNetwork:f,getNetworkDetails:u,isAllowed:v,setAllowed:T,getUserInfo:y}}])})})(Ei);var Bo=Ei.exports;const Fo=ke(Bo);var qo={keyType:be.freighter,signTransaction:function(e){return X(this,void 0,void 0,function(){var r,t,i,o,n;return $(this,function(a){switch(a.label){case 0:if(r=e.transaction,t=e.key,i=e.custom,t.privateKey!=="")throw new Error("Non-ledger key sent to ledger handler: "+JSON.stringify(t.publicKey));a.label=1;case 1:return a.trys.push([1,3,,4]),[4,Fo.signTransaction(r.toXDR(),i&&i.network?i.network:void 0)];case 2:return o=a.sent(),[2,sr.TransactionBuilder.fromXDR(o,sr.Networks.PUBLIC)];case 3:throw n=a.sent(),new Error("We couldn’t sign the transaction with Freighter. "+n.toString()+".");case 4:return[2]}})})}},Ko=oo();const Go=ke(Ko);var Wo=ao();const Ge=ke(Wo);var Qo=so();function Nr(e){let r=[];return e.split("/").forEach(i=>{let o=parseInt(i,10);isNaN(o)||(i.length>1&&i[i.length-1]==="'"&&(o+=2147483648),r.push(o))}),r}function Ar(e,r){function t(i,o,n){return i>=o.length?n:r(o[i],i).then(function(a){return n.push(a),t(i+1,o,n)})}return Promise.resolve().then(()=>t(0,e,[]))}function jo(e,r){let t=typeof r<"u"?~~r:0;for(var i=0;i<e.length;i++){const o=e[i];let n=t>>>8&255;n^=o&255,n^=n>>>4,t=t<<8&65535,t^=n,n=n<<5&65535,t^=n,n=n<<7&65535,t^=n}return t}function Ho(e){let r=48,t=Buffer.from(e),i=Buffer.from([r]),o=Buffer.concat([i,t]),n=Buffer.alloc(2);n.writeUInt16LE(jo(o),0);let a=Buffer.concat([o,n]);return Go.encode(a)}function zo(e,r,t){return Ge.sign.detached.verify(new Uint8Array(e.toJSON().data),new Uint8Array(r.toJSON().data),new Uint8Array(t.toJSON().data))}function Ot(e){let r=new Qo.sha256;return r.update(e,"utf8"),r.digest()}function Cr(e){e.split("/").forEach(function(r){if(!r.toString().endsWith("'"))throw new Error("Detected a non-hardened path element in requested BIP32 path. Non-hardended paths are not supported at this time. Please use an all-hardened path. Example: 44'/148'/0'")})}const Sr=224,Vo=2,Jo=4,Yo=6,Xo=8,Pr=16,xr=150,$o=0,Zo=128,ea=0,ra=128,dr=36864,Ur=27013,bt=27684,It=27685,ta=27750,Nt=27904,or=28162,At=1540;class na{constructor(r,t="l0v"){this.transport=void 0,this.transport=r,r.decorateAppAPIMethods(this,["getAppConfiguration","getPublicKey","signTransaction","signHash"],t)}getAppConfiguration(){return this.transport.send(Sr,Yo,0,0).then(r=>{let t=r[0]===1||r[1]<2;return{version:""+r[1]+"."+r[2]+"."+r[3],multiOpsEnabled:t}})}getPublicKey(r,t,i){Cr(r);let o=[],n,a=Nr(r),l=Buffer.alloc(1+a.length*4);l[0]=a.length,a.forEach((p,f)=>{l.writeUInt32BE(p,1+4*f)});let c=Buffer.from("via lumina","ascii");o.push(Buffer.concat([l,c]));let h=!1;return Ar(o,p=>this.transport.send(Sr,h?Pr:Vo,t?1:0,i?1:0,p,[dr,or]).then(f=>{Buffer.from(f.slice(f.length-2)).readUInt16BE(0)===or&&(h=!0,o.push(Buffer.alloc(0))),n=f})).then(()=>{let p=0,f=n.slice(p,p+32);p+=32;let u=Ho(f);if(t){let v=n.slice(p,p+64);if(!zo(c,v,f))throw new Error("Bad signature. Keypair is invalid. Please report this.")}return{publicKey:u,raw:f}})}signTransaction(r,t){if(Cr(r),t.length>At)throw new Error("Transaction too large: max = "+At+"; actual = "+t.length);let i=[],o,n=Nr(r),a=1+n.length*4,l=Buffer.alloc(a);l[0]=n.length,n.forEach(function(p,f){l.writeUInt32BE(p,1+4*f)});let c=xr-a;if(t.length<=c)i.push(Buffer.concat([l,t]));else{let p=Buffer.alloc(c),f=0;for(t.copy(p,0,f,c),i.push(Buffer.concat([l,p])),f+=c;f<t.length;){let u=t.length-f;c=u<xr?u:xr,p=Buffer.alloc(c),t.copy(p,0,f,f+c),f+=c,i.push(p)}}let h=!1;return Ar(i,(p,f)=>this.transport.send(Sr,h?Pr:Jo,f===0?$o:Zo,f===i.length-1?ea:ra,p,[dr,Ur,bt,It,or]).then(u=>{Buffer.from(u.slice(u.length-2)).readUInt16BE(0)===or&&(h=!0,i.push(Buffer.alloc(0))),o=u})).then(()=>{let p=Buffer.from(o.slice(o.length-2)).readUInt16BE(0);if(p===dr)return{signature:Buffer.from(o.slice(0,o.length-2))};if(p===bt)return this.signHash_private(r,Ot(t));if(p===It)return this.signHash_private(r,Ot(t));throw new Error("Transaction approval request was rejected")})}signHash(r,t){return Cr(r),this.signHash_private(r,t)}signHash_private(r,t){let i=[],o,n=Nr(r),a=Buffer.alloc(1+n.length*4);a[0]=n.length,n.forEach(function(c,h){a.writeUInt32BE(c,1+4*h)}),i.push(Buffer.concat([a,t]));let l=!1;return Ar(i,c=>this.transport.send(Sr,l?Pr:Xo,0,0,c,[dr,Ur,ta,Nt,or]).then(h=>{Buffer.from(h.slice(h.length-2)).readUInt16BE(0)===or&&(l=!0,i.push(Buffer.alloc(0))),o=h})).then(()=>{let c=Buffer.from(o.slice(o.length-2)).readUInt16BE(0);if(c===dr)return{signature:Buffer.from(o.slice(0,o.length-2))};throw c===Ur?new Error("Transaction approval request was rejected"):c===Nt?new Error("Hash signing is not supported"):new Error("Hash signing not allowed. Have you enabled it in the app settings?")})}}var F=F||{},ia=F;F.EXTENSION_ID="kmendfapggjehodndflmmgagdbamhnfd";F.MessageTypes={U2F_REGISTER_REQUEST:"u2f_register_request",U2F_SIGN_REQUEST:"u2f_sign_request",U2F_REGISTER_RESPONSE:"u2f_register_response",U2F_SIGN_RESPONSE:"u2f_sign_response"};F.ErrorCodes={OK:0,OTHER_ERROR:1,BAD_REQUEST:2,CONFIGURATION_UNSUPPORTED:3,DEVICE_INELIGIBLE:4,TIMEOUT:5};F.Request;F.Response;F.Error;F.SignRequest;F.SignResponse;F.RegisterRequest;F.RegisterResponse;F.disconnect=function(){F.port_&&F.port_.port_&&(F.port_.port_.disconnect(),F.port_=null)};F.getMessagePort=function(e){if(typeof chrome<"u"&&chrome.runtime){var r={type:F.MessageTypes.U2F_SIGN_REQUEST,signRequests:[]};chrome.runtime.sendMessage(F.EXTENSION_ID,r,function(){chrome.runtime.lastError?F.getIframePort_(e):F.getChromeRuntimePort_(e)})}else F.getIframePort_(e)};F.getChromeRuntimePort_=function(e){var r=chrome.runtime.connect(F.EXTENSION_ID,{includeTlsChannelId:!0});setTimeout(function(){e(null,new F.WrappedChromeRuntimePort_(r))},0)};F.WrappedChromeRuntimePort_=function(e){this.port_=e};F.WrappedChromeRuntimePort_.prototype.postMessage=function(e){this.port_.postMessage(e)};F.WrappedChromeRuntimePort_.prototype.addEventListener=function(e,r){var t=e.toLowerCase();t=="message"||t=="onmessage"?this.port_.onMessage.addListener(function(i){r({data:i})}):console.error("WrappedChromeRuntimePort only supports onMessage")};F.getIframePort_=function(e){var r="chrome-extension://"+F.EXTENSION_ID,t=document.createElement("iframe");t.src=r+"/u2f-comms.html",t.setAttribute("style","display:none"),document.body.appendChild(t);var i=!1,o=new MessageChannel,n=function(a){a.data=="ready"?(o.port1.removeEventListener("message",n),i||(i=!0,e(null,o.port1))):console.error('First event on iframe port was not "ready"')};o.port1.addEventListener("message",n),o.port1.start(),t.addEventListener("load",function(){t.contentWindow.postMessage("init",r,[o.port2])}),setTimeout(function(){i||(i=!0,e(new Error("IFrame extension not supported")))},200)};F.EXTENSION_TIMEOUT_SEC=30;F.port_=null;F.waitingForPort_=[];F.reqCounter_=0;F.callbackMap_={};F.getPortSingleton_=function(e){F.port_?e(null,F.port_):(F.waitingForPort_.length==0&&F.getMessagePort(function(r,t){for(r||(F.port_=t,F.port_.addEventListener("message",F.responseHandler_));F.waitingForPort_.length;)F.waitingForPort_.shift()(r,t)}),F.waitingForPort_.push(e))};F.responseHandler_=function(e){var r=e.data,t=r.requestId;if(!t||!F.callbackMap_[t]){console.error("Unknown or missing requestId in response.");return}var i=F.callbackMap_[t];delete F.callbackMap_[t],i(null,r.responseData)};F.isSupported=function(e){F.getPortSingleton_(function(r,t){e(!r)})};F.sign=function(e,r,t){F.getPortSingleton_(function(i,o){if(i)return r(i);var n=++F.reqCounter_;F.callbackMap_[n]=r;var a={type:F.MessageTypes.U2F_SIGN_REQUEST,signRequests:e,timeoutSeconds:typeof t<"u"?t:F.EXTENSION_TIMEOUT_SEC,requestId:n};o.postMessage(a)})};F.register=function(e,r,t,i){F.getPortSingleton_(function(o,n){if(o)return t(o);var a=++F.reqCounter_;F.callbackMap_[a]=t;var l={type:F.MessageTypes.U2F_REGISTER_REQUEST,signRequests:r,registerRequests:e,timeoutSeconds:typeof i<"u"?i:F.EXTENSION_TIMEOUT_SEC,requestId:a};n.postMessage(l)})};var oa=We,Ct=ia,ht=typeof navigator<"u"&&!!navigator.userAgent,aa=ht&&navigator.userAgent.match(/Safari\//)&&!navigator.userAgent.match(/Chrome\//),sa=ht&&navigator.userAgent.match(/Edge\/1[2345]/),Mr=null;function _r(e){return Mr||(Mr=new e(function(r,t){function i(){r({u2f:null,native:!0})}if(!ht||aa)return i();var o=typeof G.u2f<"u"&&typeof G.u2f.sign=="function";if(o&&r({u2f:G.u2f,native:!0}),sa||location.protocol==="http:"||typeof MessageChannel>"u")return i();Ct.isSupported(function(n){n?r({u2f:Ct,native:!1}):i()})})),Mr}function We(e){return{isSupported:ca.bind(e),ensureSupport:ua.bind(e),register:la.bind(e),sign:fa.bind(e),ErrorCodes:We.ErrorCodes,ErrorNames:We.ErrorNames}}We.ErrorCodes={CANCELLED:-1,OK:0,OTHER_ERROR:1,BAD_REQUEST:2,CONFIGURATION_UNSUPPORTED:3,DEVICE_INELIGIBLE:4,TIMEOUT:5};We.ErrorNames={"-1":"CANCELLED",0:"OK",1:"OTHER_ERROR",2:"BAD_REQUEST",3:"CONFIGURATION_UNSUPPORTED",4:"DEVICE_INELIGIBLE",5:"TIMEOUT"};function Er(e,r){var t=r!=null?r.errorCode:1,i=We.ErrorNames[""+t],o=new Error(e);return o.metaData={type:i,code:t},o}function vi(e,r){var t={};return t.promise=new e(function(i,o){t.resolve=i,t.reject=o,r.then(i,o)}),t.promise.cancel=function(i,o){_r(e).then(function(n){o&&!n.native&&n.u2f.disconnect(),t.reject(Er(i,{errorCode:-1}))})},t}function ca(){var e=this;return _r(e).then(function(r){return!!r.u2f})}function Et(e){if(!e.u2f)throw location.protocol==="http:"?new Error("U2F isn't supported over http, only https"):new Error("U2F not supported")}function ua(){var e=this;return _r(e).then(Et)}function la(e,r,t){var i=this;return Array.isArray(e)||(e=[e]),typeof r=="number"&&typeof t>"u"&&(t=r,r=null),r||(r=[]),vi(i,_r(i).then(function(o){Et(o);var n=o.native,a=o.u2f;return new i(function(l,c){function h(u){u.errorCode?c(Er("Registration failed",u)):(delete u.errorCode,l(u))}function p(u,v){u?c(u):v.errorCode?c(Er("Registration failed",v)):l(v)}if(n){var f=e[0].appId;a.register(f,e,r,h,t)}else a.register(e,r,p,t)})})).promise}function fa(e,r){var t=this;return Array.isArray(e)||(e=[e]),vi(t,_r(t).then(function(i){Et(i);var o=i.native,n=i.u2f;return new t(function(a,l){function c(u){u.errorCode?l(Er("Sign failed",u)):(delete u.errorCode,a(u))}function h(u,v){u?l(u):v.errorCode?l(Er("Sign failed",v)):a(v)}if(o){var p=e[0].appId,f=e[0].challenge;n.sign(p,f,e,c,r)}else n.sign(e,h,r)})})).promise}function Rr(e){We[e]=function(){if(!er.Promise)throw new Error("The platform doesn't natively support promises");var r=[].slice.call(arguments);return We(er.Promise)[e].apply(null,r)}}Rr("isSupported");Rr("ensureSupport");Rr("register");Rr("sign");var wr=oa,da=ct();const pa=ke(da);var D=function(e){var r=function(i,o){Object.assign(this,o),this.name=e,this.message=i||e,this.stack=new Error().stack};return r.prototype=new Error,r};D("AccountNameRequired");D("AccountNotSupported");D("AmountRequired");D("BluetoothRequired");D("BtcUnmatchedApp");D("CantOpenDevice");D("CashAddrNotSupported");D("CurrencyNotSupported");D("DeviceAppVerifyNotSupported");D("DeviceGenuineSocketEarlyClose");D("DeviceNotGenuine");D("DeviceOnDashboardExpected");D("DeviceOnDashboardUnexpected");D("DeviceInOSUExpected");D("DeviceHalted");D("DeviceNameInvalid");D("DeviceSocketFail");D("DeviceSocketNoBulkStatus");D("DisconnectedDevice");D("DisconnectedDeviceDuringOperation");D("EnpointConfig");D("EthAppPleaseEnableContractData");D("FeeEstimationFailed");D("FirmwareNotRecognized");D("HardResetFail");D("InvalidXRPTag");D("InvalidAddress");D("InvalidAddressBecauseDestinationIsAlsoSource");D("LatestMCUInstalledError");D("UnknownMCU");D("LedgerAPIError");D("LedgerAPIErrorWithMessage");D("LedgerAPINotAvailable");D("ManagerAppAlreadyInstalled");D("ManagerAppRelyOnBTC");D("ManagerAppDepInstallRequired");D("ManagerAppDepUninstallRequired");D("ManagerDeviceLocked");D("ManagerFirmwareNotEnoughSpace");D("ManagerNotEnoughSpace");D("ManagerUninstallBTCDep");D("NetworkDown");D("NoAddressesFound");D("NotEnoughBalance");D("NotEnoughBalanceToDelegate");D("NotEnoughBalanceInParentAccount");D("NotEnoughSpendableBalance");D("NotEnoughBalanceBecauseDestinationNotCreated");D("NoAccessToCamera");D("NotEnoughGas");D("NotSupportedLegacyAddress");D("GasLessThanEstimate");D("PasswordsDontMatch");D("PasswordIncorrect");D("RecommendSubAccountsToEmpty");D("RecommendUndelegation");D("TimeoutTagged");D("UnexpectedBootloader");D("MCUNotGenuineToDashboard");D("RecipientRequired");D("UnavailableTezosOriginatedAccountReceive");D("UnavailableTezosOriginatedAccountSend");D("UpdateFetchFileFail");D("UpdateIncorrectHash");D("UpdateIncorrectSig");D("UpdateYourApp");D("UserRefusedDeviceNameChange");D("UserRefusedAddress");D("UserRefusedFirmwareUpdate");D("UserRefusedAllowManager");D("UserRefusedOnDevice");D("TransportOpenUserCancelled");D("TransportInterfaceNotAvailable");var ha=D("TransportRaceCondition");D("TransportWebUSBGestureRequired");D("DeviceShouldStayInApp");D("WebsocketConnectionError");D("WebsocketConnectionFailed");D("WrongDeviceForAccount");D("WrongAppForCurrency");D("ETHAddressNonEIP");D("CantScanQRCode");D("FeeNotLoaded");D("FeeRequired");D("FeeTooHigh");D("SyncError");D("PairingFailed");D("GenuineCheckFailed");D("LedgerAPI4xx");D("LedgerAPI5xx");D("FirmwareOrAppUpdateRequired");D("NoDBPathGiven");D("DBWrongPassword");D("DBNotReset");function Ze(e,r){this.name="TransportError",this.message=e,this.stack=new Error().stack,this.id=r}Ze.prototype=new Error;var nt={PIN_REMAINING_ATTEMPTS:25536,INCORRECT_LENGTH:26368,MISSING_CRITICAL_PARAMETER:26624,COMMAND_INCOMPATIBLE_FILE_STRUCTURE:27009,SECURITY_STATUS_NOT_SATISFIED:27010,CONDITIONS_OF_USE_NOT_SATISFIED:27013,INCORRECT_DATA:27264,NOT_ENOUGH_MEMORY_SPACE:27268,REFERENCED_DATA_NOT_FOUND:27272,FILE_ALREADY_EXISTS:27273,INCORRECT_P1_P2:27392,INS_NOT_SUPPORTED:27904,CLA_NOT_SUPPORTED:28160,TECHNICAL_PROBLEM:28416,OK:36864,MEMORY_PROBLEM:37440,NO_EF_SELECTED:37888,INVALID_OFFSET:37890,FILE_NOT_FOUND:37892,INCONSISTENT_FILE:37896,ALGORITHM_NOT_SUPPORTED:38020,INVALID_KCV:38021,CODE_NOT_INITIALIZED:38914,ACCESS_CONDITION_NOT_FULFILLED:38916,CONTRADICTION_SECRET_CODE_STATUS:38920,CONTRADICTION_INVALIDATION:38928,CODE_BLOCKED:38976,MAX_VALUE_REACHED:38992,GP_AUTH_FAILED:25344,LICENSING:28482,HALTED:28586};function Ea(e){switch(e){case 26368:return"Incorrect length";case 26624:return"Missing critical parameter";case 27010:return"Security not satisfied (dongle locked or have invalid access rights)";case 27013:return"Condition of use not satisfied (denied by the user?)";case 27264:return"Invalid data received";case 27392:return"Invalid parameter received"}if(28416<=e&&e<=28671)return"Internal error, please report"}function _i(e){this.name="TransportStatusError";var r=Object.keys(nt).find(function(o){return nt[o]===e})||"UNKNOWN_ERROR",t=Ea(e)||r,i=e.toString(16);this.message="Ledger device: "+t+" (0x"+i+")",this.stack=new Error().stack,this.statusCode=e,this.statusText=r}_i.prototype=new Error;class tr{constructor(){this.exchangeTimeout=3e4,this.unresponsiveTimeout=15e3,this.deviceModel=null,this._events=new pa,this.send=async(r,t,i,o,n=Buffer.alloc(0),a=[nt.OK])=>{if(n.length>=256)throw new Ze("data.length exceed 256 bytes limit. Got: "+n.length,"DataLengthTooBig");const l=await this.exchange(Buffer.concat([Buffer.from([r,t,i,o]),Buffer.from([n.length]),n])),c=l.readUInt16BE(l.length-2);if(!a.some(h=>h===c))throw new _i(c);return l},this.exchangeBusyPromise=void 0,this.exchangeAtomicImpl=async r=>{if(this.exchangeBusyPromise)throw new ha("An action was already pending on the Ledger device. Please deny or reconnect.");let t;const i=new Promise(a=>{t=a});this.exchangeBusyPromise=i;let o=!1;const n=setTimeout(()=>{o=!0,this.emit("unresponsive")},this.unresponsiveTimeout);try{const a=await r();return o&&this.emit("responsive"),a}finally{clearTimeout(n),t&&t(),this.exchangeBusyPromise=null}},this._appAPIlock=null}exchange(r){throw new Error("exchange not implemented")}setScrambleKey(r){}close(){return Promise.resolve()}on(r,t){this._events.on(r,t)}off(r,t){this._events.removeListener(r,t)}emit(r,...t){this._events.emit(r,...t)}setDebugMode(){console.warn("setDebugMode is deprecated. use @ledgerhq/logs instead. No logs are emitted in this anymore.")}setExchangeTimeout(r){this.exchangeTimeout=r}setExchangeUnresponsiveTimeout(r){this.unresponsiveTimeout=r}static create(r=3e3,t){return new Promise((i,o)=>{let n=!1;const a=this.listen({next:c=>{n=!0,a&&a.unsubscribe(),l&&clearTimeout(l),this.open(c.descriptor,r).then(i,o)},error:c=>{l&&clearTimeout(l),o(c)},complete:()=>{l&&clearTimeout(l),n||o(new Ze(this.ErrorMessage_NoDeviceFound,"NoDeviceFound"))}}),l=t?setTimeout(()=>{a.unsubscribe(),o(new Ze(this.ErrorMessage_ListenTimeout,"ListenTimeout"))},t):null})}decorateAppAPIMethods(r,t,i){for(let o of t)r[o]=this.decorateAppAPIMethod(o,r[o],r,i)}decorateAppAPIMethod(r,t,i,o){return async(...n)=>{const{_appAPIlock:a}=this;if(a)return Promise.reject(new Ze("Ledger Device is busy (lock "+a+")","TransportLocked"));try{return this._appAPIlock=r,this.setScrambleKey(o),await t.apply(i,n)}finally{this._appAPIlock=null}}}}tr.isSupported=void 0;tr.list=void 0;tr.listen=void 0;tr.open=void 0;tr.ErrorMessage_ListenTimeout="No Ledger device found (timeout)";tr.ErrorMessage_NoDeviceFound="No Ledger device found";let va=0;const Ke=[],Pt=(e,r,t)=>{const i={type:e,id:String(++va),date:new Date};r&&(i.message=r),t&&(i.data=t),ga(i)},_a=e=>(Ke.push(e),()=>{const r=Ke.indexOf(e);r!==-1&&(Ke[r]=Ke[Ke.length-1],Ke.pop())});function ga(e){for(let r=0;r<Ke.length;r++)try{Ke[r](e)}catch(t){console.error(t)}}typeof G<"u"&&(G.__ledgerLogsListen=_a);function ma(e,r,t){const i=new Ze(r,t);return i.originalError=e,i}function ya(e,r){const t=Buffer.alloc(e.length);for(let i=0;i<e.length;i++)t[i]=e[i]^r[i%r.length];return t}const xt=e=>e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),Sa=e=>e.replace(/-/g,"+").replace(/_/g,"/")+"==".substring(0,3*e.length%4);function Ta(e,r,t,i){const o=ya(e,t),n=Buffer.from("0000000000000000000000000000000000000000000000000000000000000000","hex"),a={version:"U2F_V2",keyHandle:xt(o.toString("base64")),challenge:xt(n.toString("base64")),appId:location.origin};return Pt("apdu","=> "+e.toString("hex")),wr.sign(a,r/1e3).then(l=>{const{signatureData:c}=l;if(typeof c=="string"){const h=Buffer.from(Sa(c),"base64");let p;return i?p=h.slice(5):p=h,Pt("apdu","<= "+p.toString("hex")),p}else throw l})}let it=[];function Ra(){it.forEach(e=>e.emit("disconnect")),it=[]}function wa(e){return e.metaData.code===5}class ur extends tr{static async open(r,t=5e3){return new ur}constructor(){super(),this.scrambleKey=void 0,this.unwrap=!0,it.push(this)}async exchange(r){try{return await Ta(r,this.exchangeTimeout,this.scrambleKey,this.unwrap)}catch(t){throw typeof t.metaData=="object"?(wa(t)&&Ra(),ma(t,"Failed to sign with Ledger device: U2F "+t.metaData.type,"U2F_"+t.metaData.code)):t}}setScrambleKey(r){this.scrambleKey=Buffer.from(r,"ascii")}setUnwrap(r){this.unwrap=r}close(){return Promise.resolve()}}ur.isSupported=wr.isSupported;ur.list=()=>wr.isSupported().then(e=>e?[null]:[]);ur.listen=e=>{let r=!1;return wr.isSupported().then(t=>{r||(t?(e.next({type:"add",descriptor:null}),e.complete()):e.error(new Ze("U2F browser support is needed for Ledger. Please use Chrome, Opera or Firefox with a U2F extension. Also make sure you're on an HTTPS connection","U2FNotSupported")))}),{unsubscribe:()=>{r=!0}}};var Oa={keyType:be.ledger,signTransaction:function(e){return X(this,void 0,void 0,function(){var r,t,i,o,n,a,l;return $(this,function(c){switch(c.label){case 0:if(r=e.transaction,t=e.key,t.privateKey!=="")throw new Error("Non-ledger key sent to ledger handler: "+JSON.stringify(t.publicKey));return[4,ur.create(60*1e3)];case 1:return i=c.sent(),o=new na(i),[4,o.signTransaction(t.path,r.signatureBase())];case 2:return n=c.sent(),a=De.Keypair.fromPublicKey(t.publicKey),l=new De.xdr.DecoratedSignature({hint:a.signatureHint(),signature:n.signature}),r.signatures.push(l),[2,Promise.resolve(r)]}})})}},ba={keyType:be.ledger,signTransaction:function(e){var r=e.transaction,t=e.key;if(t.privateKey==="")throw new Error("Non-plaintext key sent to plaintext handler: "+JSON.stringify(t.publicKey));var i=De.Keypair.fromSecret(t.privateKey);return r.sign(i),Promise.resolve(r)}},gi={},mi={exports:{}};(function(e){function r(t){return t&&t.__esModule?t:{default:t}}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(mi);var Qe=mi.exports,Dr={exports:{}},Lr={exports:{}},kr={exports:{}},Ut;function vt(){return Ut||(Ut=1,function(e){function r(t){"@babel/helpers - typeof";return e.exports=r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},e.exports.__esModule=!0,e.exports.default=e.exports,r(t)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports}(kr)),kr.exports}var Br={exports:{}},Mt;function Ia(){return Mt||(Mt=1,function(e){var r=vt().default;function t(i,o){if(r(i)!=="object"||i===null)return i;var n=i[Symbol.toPrimitive];if(n!==void 0){var a=n.call(i,o||"default");if(r(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(i)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(Br)),Br.exports}var Dt;function Na(){return Dt||(Dt=1,function(e){var r=vt().default,t=Ia();function i(o){var n=t(o,"string");return r(n)==="symbol"?n:String(n)}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports}(Lr)),Lr.exports}var Lt;function gr(){return Lt||(Lt=1,function(e){var r=Na();function t(i,o,n){return o=r(o),o in i?Object.defineProperty(i,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[o]=n,i}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(Dr)),Dr.exports}var Z={},Te={},kt;function Aa(){if(kt)return Te;kt=1,Te.__esModule=!0,Te.FIAT_RATES_UPDATE=Te.NOTIFICATION=Te.BLOCK=Te.CONNECT=Te.ERROR=void 0;var e="blockchain-error";Te.ERROR=e;var r="blockchain-connect";Te.CONNECT=r;var t="blockchain-block";Te.BLOCK=t;var i="blockchain-notification";Te.NOTIFICATION=i;var o="fiat-rates-update";return Te.FIAT_RATES_UPDATE=o,Te}var Y={},Bt;function Ca(){if(Bt)return Y;Bt=1,Y.__esModule=!0,Y.WAIT_FOR_SELECTION=Y.WORD=Y.PASSPHRASE_ON_DEVICE=Y.PASSPHRASE=Y.PIN=Y.BUTTON=Y.LOADING=Y.USED_ELSEWHERE=Y.RELEASED=Y.ACQUIRED=Y.RELEASE=Y.ACQUIRE=Y.CHANGED=Y.DISCONNECT=Y.CONNECT_UNACQUIRED=Y.CONNECT=void 0;var e="device-connect";Y.CONNECT=e;var r="device-connect_unacquired";Y.CONNECT_UNACQUIRED=r;var t="device-disconnect";Y.DISCONNECT=t;var i="device-changed";Y.CHANGED=i;var o="device-acquire";Y.ACQUIRE=o;var n="device-release";Y.RELEASE=n;var a="device-acquired";Y.ACQUIRED=a;var l="device-released";Y.RELEASED=l;var c="device-used_elsewhere";Y.USED_ELSEWHERE=c;var h="device-loading";Y.LOADING=h;var p="button";Y.BUTTON=p;var f="pin";Y.PIN=f;var u="passphrase";Y.PASSPHRASE=u;var v="passphrase_on_device";Y.PASSPHRASE_ON_DEVICE=v;var T="word";Y.WORD=T;var y="device-wait_for_selection";return Y.WAIT_FOR_SELECTION=y,Y}var pe={},Fr={exports:{}},qr={exports:{}},Ft;function _t(){return Ft||(Ft=1,function(e){function r(t,i){return e.exports=r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},e.exports.__esModule=!0,e.exports.default=e.exports,r(t,i)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports}(qr)),qr.exports}var qt;function yi(){return qt||(qt=1,function(e){var r=_t();function t(i,o){i.prototype=Object.create(o.prototype),i.prototype.constructor=i,r(i,o)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(Fr)),Fr.exports}var Kr={exports:{}},Gr={exports:{}},Kt;function Pa(){return Kt||(Kt=1,function(e){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},e.exports.__esModule=!0,e.exports.default=e.exports,r(t)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports}(Gr)),Gr.exports}var Wr={exports:{}},Gt;function xa(){return Gt||(Gt=1,function(e){function r(t){return Function.toString.call(t).indexOf("[native code]")!==-1}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports}(Wr)),Wr.exports}var Qr={exports:{}},jr={exports:{}},Wt;function Ua(){return Wt||(Wt=1,function(e){function r(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports}(jr)),jr.exports}var Qt;function Ma(){return Qt||(Qt=1,function(e){var r=_t(),t=Ua();function i(o,n,a){return t()?(e.exports=i=Reflect.construct.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=i=function(c,h,p){var f=[null];f.push.apply(f,h);var u=Function.bind.apply(c,f),v=new u;return p&&r(v,p.prototype),v},e.exports.__esModule=!0,e.exports.default=e.exports),i.apply(null,arguments)}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports}(Qr)),Qr.exports}var jt;function Da(){return jt||(jt=1,function(e){var r=Pa(),t=_t(),i=xa(),o=Ma();function n(a){var l=typeof Map=="function"?new Map:void 0;return e.exports=n=function(h){if(h===null||!i(h))return h;if(typeof h!="function")throw new TypeError("Super expression must either be null or a function");if(typeof l<"u"){if(l.has(h))return l.get(h);l.set(h,p)}function p(){return o(h,arguments,r(this).constructor)}return p.prototype=Object.create(h.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),t(p,h)},e.exports.__esModule=!0,e.exports.default=e.exports,n(a)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}(Kr)),Kr.exports}var Ht;function La(){if(Ht)return pe;Ht=1;var e=Qe;pe.__esModule=!0,pe.LIBUSB_ERROR_MESSAGE=pe.WEBUSB_ERROR_MESSAGE=pe.INVALID_PIN_ERROR_MESSAGE=pe.WRONG_PREVIOUS_SESSION_ERROR_MESSAGE=pe.TypedError=pe.TrezorError=pe.ERROR_CODES=void 0;var r=e(yi()),t=e(Da()),i={Init_NotInitialized:"TrezorConnect not yet initialized",Init_AlreadyInitialized:"TrezorConnect has been already initialized",Init_IframeBlocked:"Iframe blocked",Init_IframeTimeout:"Iframe timeout",Init_ManifestMissing:"Manifest not set. Read more at https://github.com/trezor/connect/blob/develop/docs/index.md",Popup_ConnectionMissing:"Unable to establish connection with iframe",Transport_Missing:"Transport is missing",Transport_InvalidProtobuf:"",Method_InvalidPackage:"This version of trezor-connect is not suitable to work without browser. Use trezor-connect@extended package instead",Method_InvalidParameter:"",Method_NotAllowed:"Method not allowed for this configuration",Method_PermissionsNotGranted:"Permissions not granted",Method_Cancel:"Cancelled",Method_Interrupted:"Popup closed",Method_UnknownCoin:"Coin not found",Method_AddressNotMatch:"Addresses do not match",Method_FirmwareUpdate_DownloadFailed:"Failed to download firmware binary",Method_CustomMessage_Callback:'Parameter "callback" is not a function',Method_Discovery_BundleException:"",Method_Override:"override",Method_NoResponse:"Call resolved without response",Backend_NotSupported:"BlockchainLink settings not found in coins.json",Backend_WorkerMissing:"",Backend_Disconnected:"Backend disconnected",Backend_Invalid:"Invalid backend",Backend_Error:"",Runtime:"",Device_NotFound:"Device not found",Device_InitializeFailed:"",Device_FwException:"",Device_ModeException:"",Device_Disconnected:"Device disconnected",Device_UsedElsewhere:"Device is used in another window",Device_InvalidState:"Passphrase is incorrect",Device_CallInProgress:"Device call in progress"};pe.ERROR_CODES=i;var o=function(p){(0,r.default)(f,p);function f(u,v){var T;return T=p.call(this,v)||this,T.code=u,T.message=v,T}return f}((0,t.default)(Error));pe.TrezorError=o;var n=function(f,u){return new o(f,u||i[f])};pe.TypedError=n;var a="wrong previous session";pe.WRONG_PREVIOUS_SESSION_ERROR_MESSAGE=a;var l="PIN invalid";pe.INVALID_PIN_ERROR_MESSAGE=l;var c="NetworkError: Unable to claim interface.";pe.WEBUSB_ERROR_MESSAGE=c;var h="LIBUSB_ERROR";return pe.LIBUSB_ERROR_MESSAGE=h,pe}var Re={},zt;function Si(){if(zt)return Re;zt=1,Re.__esModule=!0,Re.CALL=Re.ERROR=Re.INIT=Re.LOADED=Re.BOOTSTRAP=void 0;var e="iframe-bootstrap";Re.BOOTSTRAP=e;var r="iframe-loaded";Re.LOADED=r;var t="iframe-init";Re.INIT=t;var i="iframe-error";Re.ERROR=i;var o="iframe-call";return Re.CALL=o,Re}var pr={},Vt;function ka(){if(Vt)return pr;Vt=1,pr.__esModule=!0,pr.TYPES=void 0;var e=Object.freeze({bitcoin:"Bitcoin",ethereum:"Ethereum",eos:"Eos",nem:"NEM",stellar:"Stellar",cardano:"Cardano",ripple:"Ripple",tezos:"Tezors",binance:"Binance"});return pr.TYPES=e,pr}var ce={},Jt;function Ti(){if(Jt)return ce;Jt=1,ce.__esModule=!0,ce.CLOSE_WINDOW=ce.CANCEL_POPUP_REQUEST=ce.CLOSED=ce.HANDSHAKE=ce.EXTENSION_USB_PERMISSIONS=ce.ERROR=ce.INIT=ce.LOADED=ce.BOOTSTRAP=void 0;var e="popup-bootstrap";ce.BOOTSTRAP=e;var r="popup-loaded";ce.LOADED=r;var t="popup-init";ce.INIT=t;var i="popup-error";ce.ERROR=i;var o="open-usb-permissions";ce.EXTENSION_USB_PERMISSIONS=o;var n="popup-handshake";ce.HANDSHAKE=n;var a="popup-closed";ce.CLOSED=a;var l="ui-cancel-popup-request";ce.CANCEL_POPUP_REQUEST=l;var c="window.close";return ce.CLOSE_WINDOW=c,ce}var he={},Yt;function Ba(){if(Yt)return he;Yt=1,he.__esModule=!0,he.START_PENDING=he.DISABLE_WEBUSB=he.REQUEST=he.STREAM=he.UPDATE=he.ERROR=he.START=void 0;var e="transport-start";he.START=e;var r="transport-error";he.ERROR=r;var t="transport-update";he.UPDATE=t;var i="transport-stream";he.STREAM=i;var o="transport-request_device";he.REQUEST=o;var n="transport-disable_webusb";he.DISABLE_WEBUSB=n;var a="transport-start_pending";return he.START_PENDING=a,he}var N={},Xt;function Ri(){if(Xt)return N;Xt=1,N.__esModule=!0,N.IFRAME_FAILURE=N.ADDRESS_VALIDATION=N.BUNDLE_PROGRESS=N.LOGIN_CHALLENGE_RESPONSE=N.LOGIN_CHALLENGE_REQUEST=N.CUSTOM_MESSAGE_RESPONSE=N.CUSTOM_MESSAGE_REQUEST=N.CHANGE_SETTINGS=N.RECEIVE_WORD=N.RECEIVE_FEE=N.RECEIVE_ACCOUNT=N.CHANGE_ACCOUNT=N.RECEIVE_DEVICE=N.RECEIVE_PASSPHRASE=N.RECEIVE_PIN=N.RECEIVE_CONFIRMATION=N.RECEIVE_PERMISSION=N.REQUEST_WORD=N.REQUEST_BUTTON=N.INSUFFICIENT_FUNDS=N.UPDATE_CUSTOM_FEE=N.SELECT_FEE=N.SELECT_ACCOUNT=N.SELECT_DEVICE=N.SET_OPERATION=N.LOADING=N.CONNECT=N.INVALID_PASSPHRASE_ACTION=N.INVALID_PASSPHRASE=N.REQUEST_PASSPHRASE_ON_DEVICE=N.REQUEST_PASSPHRASE=N.INVALID_PIN=N.REQUEST_PIN=N.REQUEST_CONFIRMATION=N.REQUEST_PERMISSION=N.CLOSE_UI_WINDOW=N.REQUEST_UI_WINDOW=N.DEVICE_NEEDS_BACKUP=N.FIRMWARE_PROGRESS=N.FIRMWARE_NOT_INSTALLED=N.FIRMWARE_NOT_COMPATIBLE=N.FIRMWARE_NOT_SUPPORTED=N.FIRMWARE_OUTDATED=N.FIRMWARE_OLD=N.SEEDLESS=N.INITIALIZE=N.REQUIRE_MODE=N.NOT_IN_BOOTLOADER=N.BOOTLOADER=N.TRANSPORT=void 0;var e="ui-no_transport";N.TRANSPORT=e;var r="ui-device_bootloader_mode";N.BOOTLOADER=r;var t="ui-device_not_in_bootloader_mode";N.NOT_IN_BOOTLOADER=t;var i="ui-device_require_mode";N.REQUIRE_MODE=i;var o="ui-device_not_initialized";N.INITIALIZE=o;var n="ui-device_seedless";N.SEEDLESS=n;var a="ui-device_firmware_old";N.FIRMWARE_OLD=a;var l="ui-device_firmware_outdated";N.FIRMWARE_OUTDATED=l;var c="ui-device_firmware_unsupported";N.FIRMWARE_NOT_SUPPORTED=c;var h="ui-device_firmware_not_compatible";N.FIRMWARE_NOT_COMPATIBLE=h;var p="ui-device_firmware_not_installed";N.FIRMWARE_NOT_INSTALLED=p;var f="ui-firmware-progress";N.FIRMWARE_PROGRESS=f;var u="ui-device_needs_backup";N.DEVICE_NEEDS_BACKUP=u;var v="ui-request_window";N.REQUEST_UI_WINDOW=v;var T="ui-close_window";N.CLOSE_UI_WINDOW=T;var y="ui-request_permission";N.REQUEST_PERMISSION=y;var I="ui-request_confirmation";N.REQUEST_CONFIRMATION=I;var d="ui-request_pin";N.REQUEST_PIN=d;var E="ui-invalid_pin";N.INVALID_PIN=E;var m="ui-request_passphrase";N.REQUEST_PASSPHRASE=m;var s="ui-request_passphrase_on_device";N.REQUEST_PASSPHRASE_ON_DEVICE=s;var w="ui-invalid_passphrase";N.INVALID_PASSPHRASE=w;var b="ui-invalid_passphrase_action";N.INVALID_PASSPHRASE_ACTION=b;var O="ui-connect";N.CONNECT=O;var C="ui-loading";N.LOADING=C;var q="ui-set_operation";N.SET_OPERATION=q;var K="ui-select_device";N.SELECT_DEVICE=K;var j="ui-select_account";N.SELECT_ACCOUNT=j;var J="ui-select_fee";N.SELECT_FEE=J;var H="ui-update_custom_fee";N.UPDATE_CUSTOM_FEE=H;var de="ui-insufficient_funds";N.INSUFFICIENT_FUNDS=de;var L="ui-button";N.REQUEST_BUTTON=L;var R="ui-request_word";N.REQUEST_WORD=R;var U="ui-receive_permission";N.RECEIVE_PERMISSION=U;var Q="ui-receive_confirmation";N.RECEIVE_CONFIRMATION=Q;var M="ui-receive_pin";N.RECEIVE_PIN=M;var x="ui-receive_passphrase";N.RECEIVE_PASSPHRASE=x;var k="ui-receive_device";N.RECEIVE_DEVICE=k;var W="ui-change_account";N.CHANGE_ACCOUNT=W;var g="ui-receive_account";N.RECEIVE_ACCOUNT=g;var _="ui-receive_fee";N.RECEIVE_FEE=_;var A="ui-receive_word";N.RECEIVE_WORD=A;var S="ui-change_settings";N.CHANGE_SETTINGS=S;var z="ui-custom_request";N.CUSTOM_MESSAGE_REQUEST=z;var V="ui-custom_response";N.CUSTOM_MESSAGE_RESPONSE=V;var ae="ui-login_challenge_request";N.LOGIN_CHALLENGE_REQUEST=ae;var te="ui-login_challenge_response";N.LOGIN_CHALLENGE_RESPONSE=te;var ie="ui-bundle_progress";N.BUNDLE_PROGRESS=ie;var ue="ui-address_validation";N.ADDRESS_VALIDATION=ue;var re="ui-iframe_failure";return N.IFRAME_FAILURE=re,N}var we={},$t;function Fa(){if($t)return we;$t=1,we.__esModule=!0,we.POOL_RELAY_TYPE=we.CERTIFICATE_TYPE=we.ADDRESS_TYPE=we.NETWORK_IDS=we.PROTOCOL_MAGICS=void 0;var e=Object.freeze({mainnet:764824073,testnet:1097911063});we.PROTOCOL_MAGICS=e;var r=Object.freeze({mainnet:1,testnet:0});we.NETWORK_IDS=r;var t=Object.freeze({Base:0,Pointer:4,Enterprise:6,Byron:8,Reward:14});we.ADDRESS_TYPE=t;var i=Object.freeze({StakeRegistration:0,StakeDeregistration:1,StakeDelegation:2,StakePoolRegistration:3});we.CERTIFICATE_TYPE=i;var o=Object.freeze({SingleHostIp:0,SingleHostName:1,MultipleHostName:2});return we.POOL_RELAY_TYPE=o,we}var Zt;function je(){if(Zt)return Z;Zt=1,Z.__esModule=!0,Z.CARDANO=Z.UI=Z.TRANSPORT=Z.POPUP=Z.NETWORK=Z.IFRAME=Z.ERRORS=Z.DEVICE=Z.BLOCKCHAIN=Z.BLOCKCHAIN_EVENT=Z.RESPONSE_EVENT=Z.TRANSPORT_EVENT=Z.DEVICE_EVENT=Z.UI_EVENT=Z.CORE_EVENT=void 0;var e=p(Aa());Z.BLOCKCHAIN=e;var r=p(Ca());Z.DEVICE=r;var t=p(La());Z.ERRORS=t;var i=p(Si());Z.IFRAME=i;var o=p(ka());Z.NETWORK=o;var n=p(Ti());Z.POPUP=n;var a=p(Ba());Z.TRANSPORT=a;var l=p(Ri());Z.UI=l;var c=p(Fa());Z.CARDANO=c;function h(d){if(typeof WeakMap!="function")return null;var E=new WeakMap,m=new WeakMap;return(h=function(w){return w?m:E})(d)}function p(d,E){if(!E&&d&&d.__esModule)return d;if(d===null||typeof d!="object"&&typeof d!="function")return{default:d};var m=h(E);if(m&&m.has(d))return m.get(d);var s={},w=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var b in d)if(b!=="default"&&Object.prototype.hasOwnProperty.call(d,b)){var O=w?Object.getOwnPropertyDescriptor(d,b):null;O&&(O.get||O.set)?Object.defineProperty(s,b,O):s[b]=d[b]}return s.default=d,m&&m.set(d,s),s}var f="CORE_EVENT";Z.CORE_EVENT=f;var u="UI_EVENT";Z.UI_EVENT=u;var v="DEVICE_EVENT";Z.DEVICE_EVENT=v;var T="TRANSPORT_EVENT";Z.TRANSPORT_EVENT=T;var y="RESPONSE_EVENT";Z.RESPONSE_EVENT=y;var I="BLOCKCHAIN_EVENT";return Z.BLOCKCHAIN_EVENT=I,Z}var oe={},Hr={exports:{}},en;function qa(){return en||(en=1,function(e){var r=vt().default;function t(){e.exports=t=function(){return i},e.exports.__esModule=!0,e.exports.default=e.exports;var i={},o=Object.prototype,n=o.hasOwnProperty,a=Object.defineProperty||function(L,R,U){L[R]=U.value},l=typeof Symbol=="function"?Symbol:{},c=l.iterator||"@@iterator",h=l.asyncIterator||"@@asyncIterator",p=l.toStringTag||"@@toStringTag";function f(L,R,U){return Object.defineProperty(L,R,{value:U,enumerable:!0,configurable:!0,writable:!0}),L[R]}try{f({},"")}catch{f=function(U,Q,M){return U[Q]=M}}function u(L,R,U,Q){var M=R&&R.prototype instanceof y?R:y,x=Object.create(M.prototype),k=new J(Q||[]);return a(x,"_invoke",{value:C(L,U,k)}),x}function v(L,R,U){try{return{type:"normal",arg:L.call(R,U)}}catch(Q){return{type:"throw",arg:Q}}}i.wrap=u;var T={};function y(){}function I(){}function d(){}var E={};f(E,c,function(){return this});var m=Object.getPrototypeOf,s=m&&m(m(H([])));s&&s!==o&&n.call(s,c)&&(E=s);var w=d.prototype=y.prototype=Object.create(E);function b(L){["next","throw","return"].forEach(function(R){f(L,R,function(U){return this._invoke(R,U)})})}function O(L,R){function U(M,x,k,W){var g=v(L[M],L,x);if(g.type!=="throw"){var _=g.arg,A=_.value;return A&&r(A)=="object"&&n.call(A,"__await")?R.resolve(A.__await).then(function(S){U("next",S,k,W)},function(S){U("throw",S,k,W)}):R.resolve(A).then(function(S){_.value=S,k(_)},function(S){return U("throw",S,k,W)})}W(g.arg)}var Q;a(this,"_invoke",{value:function(x,k){function W(){return new R(function(g,_){U(x,k,g,_)})}return Q=Q?Q.then(W,W):W()}})}function C(L,R,U){var Q="suspendedStart";return function(M,x){if(Q==="executing")throw new Error("Generator is already running");if(Q==="completed"){if(M==="throw")throw x;return de()}for(U.method=M,U.arg=x;;){var k=U.delegate;if(k){var W=q(k,U);if(W){if(W===T)continue;return W}}if(U.method==="next")U.sent=U._sent=U.arg;else if(U.method==="throw"){if(Q==="suspendedStart")throw Q="completed",U.arg;U.dispatchException(U.arg)}else U.method==="return"&&U.abrupt("return",U.arg);Q="executing";var g=v(L,R,U);if(g.type==="normal"){if(Q=U.done?"completed":"suspendedYield",g.arg===T)continue;return{value:g.arg,done:U.done}}g.type==="throw"&&(Q="completed",U.method="throw",U.arg=g.arg)}}}function q(L,R){var U=R.method,Q=L.iterator[U];if(Q===void 0)return R.delegate=null,U==="throw"&&L.iterator.return&&(R.method="return",R.arg=void 0,q(L,R),R.method==="throw")||U!=="return"&&(R.method="throw",R.arg=new TypeError("The iterator does not provide a '"+U+"' method")),T;var M=v(Q,L.iterator,R.arg);if(M.type==="throw")return R.method="throw",R.arg=M.arg,R.delegate=null,T;var x=M.arg;return x?x.done?(R[L.resultName]=x.value,R.next=L.nextLoc,R.method!=="return"&&(R.method="next",R.arg=void 0),R.delegate=null,T):x:(R.method="throw",R.arg=new TypeError("iterator result is not an object"),R.delegate=null,T)}function K(L){var R={tryLoc:L[0]};1 in L&&(R.catchLoc=L[1]),2 in L&&(R.finallyLoc=L[2],R.afterLoc=L[3]),this.tryEntries.push(R)}function j(L){var R=L.completion||{};R.type="normal",delete R.arg,L.completion=R}function J(L){this.tryEntries=[{tryLoc:"root"}],L.forEach(K,this),this.reset(!0)}function H(L){if(L){var R=L[c];if(R)return R.call(L);if(typeof L.next=="function")return L;if(!isNaN(L.length)){var U=-1,Q=function M(){for(;++U<L.length;)if(n.call(L,U))return M.value=L[U],M.done=!1,M;return M.value=void 0,M.done=!0,M};return Q.next=Q}}return{next:de}}function de(){return{value:void 0,done:!0}}return I.prototype=d,a(w,"constructor",{value:d,configurable:!0}),a(d,"constructor",{value:I,configurable:!0}),I.displayName=f(d,p,"GeneratorFunction"),i.isGeneratorFunction=function(L){var R=typeof L=="function"&&L.constructor;return!!R&&(R===I||(R.displayName||R.name)==="GeneratorFunction")},i.mark=function(L){return Object.setPrototypeOf?Object.setPrototypeOf(L,d):(L.__proto__=d,f(L,p,"GeneratorFunction")),L.prototype=Object.create(w),L},i.awrap=function(L){return{__await:L}},b(O.prototype),f(O.prototype,h,function(){return this}),i.AsyncIterator=O,i.async=function(L,R,U,Q,M){M===void 0&&(M=Promise);var x=new O(u(L,R,U,Q),M);return i.isGeneratorFunction(R)?x:x.next().then(function(k){return k.done?k.value:x.next()})},b(w),f(w,p,"Generator"),f(w,c,function(){return this}),f(w,"toString",function(){return"[object Generator]"}),i.keys=function(L){var R=Object(L),U=[];for(var Q in R)U.push(Q);return U.reverse(),function M(){for(;U.length;){var x=U.pop();if(x in R)return M.value=x,M.done=!1,M}return M.done=!0,M}},i.values=H,J.prototype={constructor:J,reset:function(R){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!R)for(var U in this)U.charAt(0)==="t"&&n.call(this,U)&&!isNaN(+U.slice(1))&&(this[U]=void 0)},stop:function(){this.done=!0;var R=this.tryEntries[0].completion;if(R.type==="throw")throw R.arg;return this.rval},dispatchException:function(R){if(this.done)throw R;var U=this;function Q(_,A){return k.type="throw",k.arg=R,U.next=_,A&&(U.method="next",U.arg=void 0),!!A}for(var M=this.tryEntries.length-1;M>=0;--M){var x=this.tryEntries[M],k=x.completion;if(x.tryLoc==="root")return Q("end");if(x.tryLoc<=this.prev){var W=n.call(x,"catchLoc"),g=n.call(x,"finallyLoc");if(W&&g){if(this.prev<x.catchLoc)return Q(x.catchLoc,!0);if(this.prev<x.finallyLoc)return Q(x.finallyLoc)}else if(W){if(this.prev<x.catchLoc)return Q(x.catchLoc,!0)}else{if(!g)throw new Error("try statement without catch or finally");if(this.prev<x.finallyLoc)return Q(x.finallyLoc)}}}},abrupt:function(R,U){for(var Q=this.tryEntries.length-1;Q>=0;--Q){var M=this.tryEntries[Q];if(M.tryLoc<=this.prev&&n.call(M,"finallyLoc")&&this.prev<M.finallyLoc){var x=M;break}}x&&(R==="break"||R==="continue")&&x.tryLoc<=U&&U<=x.finallyLoc&&(x=null);var k=x?x.completion:{};return k.type=R,k.arg=U,x?(this.method="next",this.next=x.finallyLoc,T):this.complete(k)},complete:function(R,U){if(R.type==="throw")throw R.arg;return R.type==="break"||R.type==="continue"?this.next=R.arg:R.type==="return"?(this.rval=this.arg=R.arg,this.method="return",this.next="end"):R.type==="normal"&&U&&(this.next=U),T},finish:function(R){for(var U=this.tryEntries.length-1;U>=0;--U){var Q=this.tryEntries[U];if(Q.finallyLoc===R)return this.complete(Q.completion,Q.afterLoc),j(Q),T}},catch:function(R){for(var U=this.tryEntries.length-1;U>=0;--U){var Q=this.tryEntries[U];if(Q.tryLoc===R){var M=Q.completion;if(M.type==="throw"){var x=M.arg;j(Q)}return x}}throw new Error("illegal catch attempt")},delegateYield:function(R,U,Q){return this.delegate={iterator:H(R),resultName:U,nextLoc:Q},this.method==="next"&&(this.arg=void 0),T}},i}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(Hr)),Hr.exports}var zr,rn;function Or(){if(rn)return zr;rn=1;var e=qa()();zr=e;try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}return zr}var Vr={exports:{}},tn;function br(){return tn||(tn=1,function(e){function r(i,o,n,a,l,c,h){try{var p=i[c](h),f=p.value}catch(u){n(u);return}p.done?o(f):Promise.resolve(f).then(a,l)}function t(i){return function(){var o=this,n=arguments;return new Promise(function(a,l){var c=i.apply(o,n);function h(f){r(c,a,l,h,p,"next",f)}function p(f){r(c,a,l,h,p,"throw",f)}h(void 0)})}}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(Vr)),Vr.exports}var Jr={},Yr={exports:{}},nn;function Ka(){return nn||(nn=1,function(e){function r(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports}(Yr)),Yr.exports}var hr={},on;function Ga(){if(on)return hr;on=1,hr.__esModule=!0,hr.showPopupRequest=void 0;var e="TrezorConnectInteractionLayer",r=`
    <div class="trezorconnect-container" id="`+e+`">
        <div class="trezorconnect-window">
            <div class="trezorconnect-head">
                <svg class="trezorconnect-logo" x="0px" y="0px" viewBox="0 0 163.7 41.9" width="78px" height="20px" preserveAspectRatio="xMinYMin meet">
                    <polygon points="101.1,12.8 118.2,12.8 118.2,17.3 108.9,29.9 118.2,29.9 118.2,35.2 101.1,35.2 101.1,30.7 110.4,18.1 101.1,18.1"/>
                    <path d="M158.8,26.9c2.1-0.8,4.3-2.9,4.3-6.6c0-4.5-3.1-7.4-7.7-7.4h-10.5v22.3h5.8v-7.5h2.2l4.1,7.5h6.7L158.8,26.9z M154.7,22.5 h-4V18h4c1.5,0,2.5,0.9,2.5,2.2C157.2,21.6,156.2,22.5,154.7,22.5z"/>
                    <path d="M130.8,12.5c-6.8,0-11.6,4.9-11.6,11.5s4.9,11.5,11.6,11.5s11.7-4.9,11.7-11.5S137.6,12.5,130.8,12.5z M130.8,30.3 c-3.4,0-5.7-2.6-5.7-6.3c0-3.8,2.3-6.3,5.7-6.3c3.4,0,5.8,2.6,5.8,6.3C136.6,27.7,134.2,30.3,130.8,30.3z"/>
                    <polygon points="82.1,12.8 98.3,12.8 98.3,18 87.9,18 87.9,21.3 98,21.3 98,26.4 87.9,26.4 87.9,30 98.3,30 98.3,35.2 82.1,35.2 "/>
                    <path d="M24.6,9.7C24.6,4.4,20,0,14.4,0S4.2,4.4,4.2,9.7v3.1H0v22.3h0l14.4,6.7l14.4-6.7h0V12.9h-4.2V9.7z M9.4,9.7 c0-2.5,2.2-4.5,5-4.5s5,2,5,4.5v3.1H9.4V9.7z M23,31.5l-8.6,4l-8.6-4V18.1H23V31.5z"/>
                    <path d="M79.4,20.3c0-4.5-3.1-7.4-7.7-7.4H61.2v22.3H67v-7.5h2.2l4.1,7.5H80l-4.9-8.3C77.2,26.1,79.4,24,79.4,20.3z M71,22.5h-4V18 h4c1.5,0,2.5,0.9,2.5,2.2C73.5,21.6,72.5,22.5,71,22.5z"/>
                    <polygon points="40.5,12.8 58.6,12.8 58.6,18.1 52.4,18.1 52.4,35.2 46.6,35.2 46.6,18.1 40.5,18.1 "/>
                </svg>
                <div class="trezorconnect-close">
                    <svg x="0px" y="0px" viewBox="24 24 60 60" width="24px" height="24px" preserveAspectRatio="xMinYMin meet">
                        <polygon class="st0" points="40,67.9 42.1,70 55,57.1 67.9,70 70,67.9 57.1,55 70,42.1 67.9,40 55,52.9 42.1,40 40,42.1 52.9,55 "/>
                    </svg>
                </div>
            </div>
            <div class="trezorconnect-body">
                <h3>Popup was blocked</h3>
                <p>Please click to “Continue” to open popup manually</p>
                <button class="trezorconnect-open">Continue</button>
            </div>
        </div>
    </div>
`,t=function(o,n){if(!document.getElementById(e)){var a=document.createElement("div");a.id=e,a.className="trezorconnect-container",a.innerHTML=r,document.body&&document.body.appendChild(a);var l=a.getElementsByClassName("trezorconnect-open")[0];l.onclick=function(){o(),document.body&&document.body.removeChild(a)};var c=a.getElementsByClassName("trezorconnect-close")[0];c.onclick=function(){n(),document.body&&document.body.removeChild(a)}}};return hr.showPopupRequest=t,hr}var ar={},an;function wi(){if(an)return ar;an=1,ar.__esModule=!0,ar.getOnionDomain=r,ar.getOrigin=void 0;var e=function(i){if(typeof i!="string")return"unknown";if(i.indexOf("file://")===0)return"file://";var o=i.match(/^.+\:\/\/[^\/]+/);return Array.isArray(o)&&o.length>0?o[0]:"unknown"};ar.getOrigin=e;function r(t,i){if(Array.isArray(t))return t.map(function(p){return r(p,i)});if(typeof t=="string"){var o,n=(o=t.match(/^(http|ws)s?:\/\/([^:/]+\.)?([^/.]+\.[^/.]+)(\/.*)?$/i))!=null?o:[],a=n[1],l=n[2],c=n[3],h=n[4];return!c||!i[c]?t:a+"://"+(l||"")+i[c]+(h||"")}return t}return ar}var qe={},sn;function Oi(){if(sn)return qe;sn=1;var e=Qe;qe.__esModule=!0,qe.create=i,qe.createAsync=o,qe.resolveTimeoutPromise=n,qe.rejectTimeoutPromise=void 0;var r=e(Or()),t=e(br());function i(l,c){var h=function(T){},p=function(T){},f,u=new Promise(function(){var v=(0,t.default)(r.default.mark(function T(y,I){return r.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(h=y,p=I,typeof l!="function"){E.next=11;break}return E.prev=3,E.next=6,l();case 6:E.next=11;break;case 8:E.prev=8,E.t0=E.catch(3),I(E.t0);case 11:typeof l=="string"&&(f=l);case 12:case"end":return E.stop()}},T,null,[[3,8]])}));return function(T,y){return v.apply(this,arguments)}}());return{id:f,device:c,resolve:h,reject:p,promise:u}}function o(l){var c=function(v){},h=function(v){},p=new Promise(function(u,v){c=u,h=v}),f=function(){var u=(0,t.default)(r.default.mark(function v(){return r.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,l();case 2:case"end":return y.stop()}},v)}));return function(){return u.apply(this,arguments)}}();return{resolve:c,reject:h,promise:p,run:function(){return f(),p}}}function n(l,c){return new Promise(function(h){setTimeout(function(){h(c)},l)})}var a=function(c,h){return new Promise(function(p,f){setTimeout(function(){f(h)},c)})};return qe.rejectTimeoutPromise=a,qe}var cn;function Wa(){return cn||(cn=1,function(e){var r=Qe;e.__esModule=!0,e.default=void 0;var t=r(Or()),i=r(br()),o=r(Ka()),n=r(yi()),a=r(gr()),l=r(ct()),c=y(Ti()),h=y(Si()),p=y(Ri()),f=Ga(),u=wi(),v=Oi();function T(s){if(typeof WeakMap!="function")return null;var w=new WeakMap,b=new WeakMap;return(T=function(C){return C?b:w})(s)}function y(s,w){if(!w&&s&&s.__esModule)return s;if(s===null||typeof s!="object"&&typeof s!="function")return{default:s};var b=T(w);if(b&&b.has(s))return b.get(s);var O={},C=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var q in s)if(q!=="default"&&Object.prototype.hasOwnProperty.call(s,q)){var K=C?Object.getOwnPropertyDescriptor(s,q):null;K&&(K.get||K.set)?Object.defineProperty(O,q,K):O[q]=s[q]}return O.default=s,b&&b.set(s,O),O}var I=850,d=500,E=3e3,m=function(s){(0,n.default)(w,s);function w(O){var C;return C=s.call(this)||this,(0,a.default)((0,o.default)(C),"requestTimeout",0),(0,a.default)((0,o.default)(C),"closeInterval",0),(0,a.default)((0,o.default)(C),"extensionTabId",0),C.settings=O,C.origin=(0,u.getOrigin)(O.popupSrc),C.handleMessage=C.handleMessage.bind((0,o.default)(C)),C.iframeHandshake=(0,v.create)(h.LOADED),C.settings.env==="webextension"&&(C.handleExtensionConnect=C.handleExtensionConnect.bind((0,o.default)(C)),C.handleExtensionMessage=C.handleExtensionMessage.bind((0,o.default)(C)),chrome.runtime.onConnect.addListener(C.handleExtensionConnect)),G.addEventListener("message",C.handleMessage,!1),C}var b=w.prototype;return b.request=function(C){var q=this;if(C===void 0&&(C=!1),this.locked){this._window&&(this.settings.env==="webextension"?chrome.tabs.update(this._window.id,{active:!0}):this._window.focus());return}var K=this.open.bind(this);if(this.locked=!0,!this.settings.supportedBrowser)K();else{var j=C||this.settings.env==="webextension"?1:I;this.requestTimeout=G.setTimeout(function(){q.requestTimeout=0,K(C)},j)}},b.cancel=function(){this.close()},b.unlock=function(){this.locked=!1},b.open=function(C){var q=this,K=this.settings.popupSrc;if(!this.settings.supportedBrowser){this.openWrapper(K+"#unsupported");return}this.popupPromise=(0,v.create)(c.LOADED),this.openWrapper(C?K+"#loading":K),this.closeInterval=G.setInterval(function(){q._window&&(q.settings.env==="webextension"?chrome.tabs.get(q._window.id,function(j){j||(q.close(),q.emit(c.CLOSED))}):q._window.closed&&(q.close(),q.emit(c.CLOSED)))},d),this.openTimeout=G.setTimeout(function(){q.close(),(0,f.showPopupRequest)(q.open.bind(q),function(){q.emit(c.CLOSED)})},E)},b.openWrapper=function(C){var q=this;this.settings.env==="webextension"?chrome.windows.getCurrent(null,function(K){K.type!=="normal"?chrome.windows.create({url:C},function(j){chrome.tabs.query({windowId:j.id,active:!0},function(J){q._window=J[0]})}):chrome.tabs.query({currentWindow:!0,active:!0},function(j){q.extensionTabId=j[0].id,chrome.tabs.create({url:C,index:j[0].index+1},function(J){q._window=J})})}):this.settings.env==="electron"?this._window=G.open(C,"modal"):(this._window=G.open("","_blank"),this._window&&(this._window.location.href=C))},b.handleExtensionConnect=function(C){if(C.name==="trezor-connect"){if(!this._window||this._window&&this._window.id!==C.sender.tab.id){C.disconnect();return}G.clearTimeout(this.openTimeout),this.extensionPort=C,this.extensionPort.onMessage.addListener(this.handleExtensionMessage)}},b.handleExtensionMessage=function(C){var q=this;if(this.extensionPort){var K=this.extensionPort,j=C.data;if(!(!j||typeof j!="object"))if(j.type===c.ERROR){var J=j.payload&&typeof j.payload.error=="string"?j.payload.error:null;this.emit(c.CLOSED,J?"Popup error: "+J:null),this.close()}else j.type===c.LOADED?(this.popupPromise&&this.popupPromise.resolve(),this.iframeHandshake.promise.then(function(H){K.postMessage({type:c.INIT,payload:{settings:q.settings,useBroadcastChannel:H}})})):j.type===c.EXTENSION_USB_PERMISSIONS?chrome.tabs.query({currentWindow:!0,active:!0},function(H){chrome.tabs.create({url:"trezor-usb-permissions.html",index:H[0].index+1},function(de){})}):j.type===c.CLOSE_WINDOW&&(this.emit(c.CLOSED),this.close())}},b.handleMessage=function(C){var q=this,K=C.data;if(!((0,u.getOrigin)(C.origin)!==this.origin||!K||typeof K!="object"))if(K.type===h.LOADED){var j=K.payload&&typeof K.payload.useBroadcastChannel=="boolean"?K.payload.useBroadcastChannel:!1;this.iframeHandshake.resolve(j)}else if(K.type===c.BOOTSTRAP)G.clearTimeout(this.openTimeout);else if(K.type===c.ERROR&&this._window){var J=K.payload&&typeof K.payload.error=="string"?K.payload.error:null;this.emit(c.CLOSED,J?"Popup error: "+J:null),this.close()}else K.type===c.LOADED?(this.popupPromise&&this.popupPromise.resolve(),this.iframeHandshake.promise.then(function(H){q._window.postMessage({type:c.INIT,payload:{settings:q.settings,useBroadcastChannel:H}},q.origin)})):(K.type===c.CANCEL_POPUP_REQUEST||K.type===p.CLOSE_UI_WINDOW)&&this.close()},b.close=function(){this.locked=!1,this.popupPromise=void 0,this.requestTimeout&&(G.clearTimeout(this.requestTimeout),this.requestTimeout=0),this.openTimeout&&(G.clearTimeout(this.openTimeout),this.openTimeout=0),this.closeInterval&&(G.clearInterval(this.closeInterval),this.closeInterval=0),this.extensionPort&&(this.extensionPort.disconnect(),this.extensionPort=null),this.extensionTabId&&(chrome.tabs.update(this.extensionTabId,{active:!0}),this.extensionTabId=0),this._window&&(this.settings.env==="webextension"?(chrome.runtime.lastError,chrome.tabs.remove(this._window.id,function(){chrome.runtime.lastError})):this._window.close(),this._window=null)},b.postMessage=function(){var O=(0,i.default)(t.default.mark(function q(K){var j=this;return t.default.wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(!(!this._window&&K.type!==p.REQUEST_UI_WINDOW&&this.openTimeout)){H.next=4;break}return this.close(),(0,f.showPopupRequest)(this.open.bind(this),function(){j.emit(c.CLOSED)}),H.abrupt("return");case 4:if(!this.popupPromise){H.next=7;break}return H.next=7,this.popupPromise.promise;case 7:this._window&&this._window.postMessage(K,this.origin);case 8:case"end":return H.stop()}},q,this)}));function C(q){return O.apply(this,arguments)}return C}(),w}(l.default);e.default=m}(Jr)),Jr}var ee={},Xr={},un;function Qa(){return un||(un=1,function(e){e.__esModule=!0,e.default=void 0;var r='.trezorconnect-container{position:fixed!important;display:-webkit-box!important;display:-webkit-flex!important;display:-ms-flexbox!important;display:flex!important;-webkit-box-orient:vertical!important;-webkit-box-direction:normal!important;-webkit-flex-direction:column!important;-ms-flex-direction:column!important;flex-direction:column!important;-webkit-box-align:center!important;-webkit-align-items:center!important;-ms-flex-align:center!important;align-items:center!important;z-index:10000!important;width:100%!important;height:100%!important;top:0!important;left:0!important;background:rgba(0,0,0,.35)!important;overflow:auto!important;padding:20px!important;margin:0!important}.trezorconnect-container .trezorconnect-window{position:relative!important;display:block!important;width:370px!important;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif!important;margin:auto!important;border-radius:3px!important;background-color:#fff!important;text-align:center!important;overflow:hidden!important}.trezorconnect-container .trezorconnect-window .trezorconnect-head{text-align:left;padding:12px 24px!important;display:-webkit-box!important;display:-webkit-flex!important;display:-ms-flexbox!important;display:flex!important;-webkit-box-align:center!important;-webkit-align-items:center!important;-ms-flex-align:center!important;align-items:center!important}.trezorconnect-container .trezorconnect-window .trezorconnect-head .trezorconnect-logo{-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1}.trezorconnect-container .trezorconnect-window .trezorconnect-head .trezorconnect-close{cursor:pointer!important;height:24px!important}.trezorconnect-container .trezorconnect-window .trezorconnect-head .trezorconnect-close svg{fill:#757575;-webkit-transition:fill .3s ease-in-out!important;transition:fill .3s ease-in-out!important}.trezorconnect-container .trezorconnect-window .trezorconnect-head .trezorconnect-close:hover svg{fill:#494949}.trezorconnect-container .trezorconnect-window .trezorconnect-body{padding:24px 24px 32px!important;background:#FBFBFB!important;border-top:1px solid #EBEBEB}.trezorconnect-container .trezorconnect-window .trezorconnect-body h3{color:#505050!important;font-size:16px!important;font-weight:500!important}.trezorconnect-container .trezorconnect-window .trezorconnect-body p{margin:8px 0 24px!important;font-weight:400!important;color:#A9A9A9!important;font-size:12px!important}.trezorconnect-container .trezorconnect-window .trezorconnect-body button{width:100%!important;padding:12px 24px!important;margin:0!important;border-radius:3px!important;font-size:14px!important;font-weight:300!important;cursor:pointer!important;background:#01B757!important;color:#fff!important;border:0!important;-webkit-transition:background-color .3s ease-in-out!important;transition:background-color .3s ease-in-out!important}.trezorconnect-container .trezorconnect-window .trezorconnect-body button:hover{background-color:#00AB51!important}.trezorconnect-container .trezorconnect-window .trezorconnect-body button:active{background-color:#009546!important}/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImlucHV0IiwiJHN0ZGluIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQWNBLHlCQUNJLFNBQUEsZ0JBQ0EsUUFBQSxzQkFDQSxRQUFBLHVCQUNBLFFBQUEsc0JBRUEsUUFBQSxlQUNBLG1CQUFBLG1CQUNBLHNCQUFBLGlCQUNBLHVCQUFBLGlCQUNBLG1CQUFBLGlCQUNBLGVBQUEsaUJBRUEsa0JBQUEsaUJBQ0Esb0JBQUEsaUJBQ0EsZUFBQSxpQkNmTSxZQUFhLGlCREFyQixRQUFTLGdCQWtCSCxNQUFBLGVBQ0EsT0FBQSxlQUNBLElBQUEsWUFDQSxLQUFBLFlBQ0EsV0FBQSwwQkFDQSxTQUFBLGVBQ0EsUUFBQSxlQUNBLE9BQUEsWUNkUiwrQ0RYRSxTQUFVLG1CQTZCQSxRQUFBLGdCQUNBLE1BQUEsZ0JBQ0EsWUFBQSxjQUFBLG1CQUFBLFdBQUEsT0FBQSxpQkFBQSxNQUFBLHFCQUNBLE9BQUEsZUNmVixjQUFlLGNEakJmLGlCQWlCRSxlQWtCWSxXQUFBLGlCQ2ZkLFNBQVUsaUJEbUJJLG1FQUNBLFdBQUEsS0NoQmQsUUFBUyxLQUFLLGVEeEJkLFFBQVMsc0JBMENTLFFBQUEsdUJBQ0EsUUFBQSxzQkNmbEIsUUFBUyxlRGlCSyxrQkE1QlosaUJBOEJvQixvQkFBQSxpQkNoQmxCLGVBQWdCLGlCRC9CWixZQWlCTixpQkFzQ1EsdUZBQ0EsaUJBQUEsRUNwQlYsYUFBYyxFRHBDVixTQUFVLEVBMkRBLEtBQUEsRUFFQSx3RkNwQmQsT0FBUSxrQkR6Q1IsT0FBUSxlQWlFTSw0RkFDQSxLQUFBLFFBQ0EsbUJBQUEsS0FBQSxJQUFBLHNCQ3BCZCxXQUFZLEtBQUssSUFBSyxzQkR3QlIsa0dBQ0EsS0FBQSxRQUVBLG1FQUNBLFFBQUEsS0FBQSxLQUFBLGVBQ0EsV0FBQSxrQkFDQSxXQUFBLElBQUEsTUFBQSxRQUVBLHNFQUNBLE1BQUEsa0JBQ0EsVUFBQSxlQ3JCZCxZQUFhLGNEd0JLLHFFQ3JCbEIsT0FBUSxJQUFJLEVBQUksZUR3QkYsWUFBQSxjQUNJLE1BQUEsa0JDdEJsQixVQUFXLGVBRWIsMEVBQ0UsTUFBTyxlQUNQLFFBQVMsS0FBSyxlQUNkLE9BQVEsWUFDUixjQUFlLGNBQ2YsVUFBVyxlQUNYLFlBQWEsY0FDYixPQUFRLGtCQUNSLFdBQVksa0JBQ1osTUFBTyxlQUNQLE9BQVEsWUFDUixtQkFBb0IsaUJBQWlCLElBQUssc0JBQzFDLFdBQVksaUJBQWlCLElBQUssc0JBRXBDLGdGQUNFLGlCQUFrQixrQkFFcEIsaUZBQ0UsaUJBQWtCIn0= */',t=r;e.default=t}(Xr)),Xr}var ln;function ja(){if(ln)return ee;ln=1;var e=Qe;ee.__esModule=!0,ee.clearTimeout=ee.dispose=ee.postMessage=ee.init=ee.messagePromises=ee.error=ee.timeout=ee.initPromise=ee.origin=ee.instance=void 0;var r=e(Or()),t=e(br()),i=Oi(),o=je(),n=wi(),a=e(Qa()),l;ee.instance=l;var c;ee.origin=c;var h=(0,i.create)();ee.initPromise=h;var p=0;ee.timeout=p;var f;ee.error=f;var u=0,v={};ee.messagePromises=v;var T=function(){var s=(0,t.default)(r.default.mark(function w(b){var O,C,q,K,j;return r.default.wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return ee.initPromise=h=(0,i.create)(),O=document.getElementById("trezorconnect"),O?ee.instance=l=O:(ee.instance=l=document.createElement("iframe"),l.frameBorder="0",l.width="0px",l.height="0px",l.style.position="absolute",l.style.display="none",l.style.border="0px",l.style.width="0px",l.style.height="0px",l.id="trezorconnect"),b.env==="web"?(q=b.manifest?JSON.stringify(b.manifest):"undefined",K="version="+b.version+"&manifest="+encodeURIComponent(btoa(JSON.stringify(q))),C=b.iframeSrc+"?"+K):C=b.iframeSrc,l.setAttribute("src",C),b.webusb&&l.setAttribute("allow","usb"),ee.origin=c=(0,n.getOrigin)(l.src),ee.timeout=p=G.setTimeout(function(){h.reject(o.ERRORS.TypedError("Init_IframeTimeout"))},1e4),j=function(){if(!l){h.reject(o.ERRORS.TypedError("Init_IframeBlocked"));return}try{var L=l.contentWindow.location.origin;if(!L||L==="null"){I();return}}catch{}var R;typeof chrome<"u"&&chrome.runtime&&typeof chrome.runtime.onConnect<"u"&&(chrome.runtime.onConnect.addListener(function(){}),R=chrome.runtime.id),l.contentWindow.postMessage({type:o.IFRAME.INIT,payload:{settings:b,extension:R}},c),l.onload=void 0},l.attachEvent?l.attachEvent("onload",j):l.onload=j,document.body&&(document.body.appendChild(l),y()),H.prev=11,H.next=14,h.promise;case 14:H.next=20;break;case 16:throw H.prev=16,H.t0=H.catch(11),l&&(l.parentNode&&l.parentNode.removeChild(l),ee.instance=l=null),H.t0;case 20:return H.prev=20,G.clearTimeout(p),ee.timeout=p=0,H.finish(20);case 24:case"end":return H.stop()}},w,null,[[11,16,20,24]])}));return function(b){return s.apply(this,arguments)}}();ee.init=T;var y=function(){if(!l)throw o.ERRORS.TypedError("Init_IframeBlocked");var w=l.ownerDocument,b=w.head||w.getElementsByTagName("head")[0],O=document.createElement("style");O.setAttribute("type","text/css"),O.setAttribute("id","TrezorConnectStylesheet"),O.styleSheet?(O.styleSheet.cssText=a.default,b.appendChild(O)):(O.appendChild(document.createTextNode(a.default)),b.append(O))},I=function(){G.clearTimeout(p),ee.error=f=o.ERRORS.TypedError("Init_IframeBlocked"),E(),h.reject(f)},d=function(w,b){if(b===void 0&&(b=!0),!l)throw o.ERRORS.TypedError("Init_IframeBlocked");if(b){u++,w.id=u,v[u]=(0,i.create)();var O=v[u].promise;return l.contentWindow.postMessage(w,c),O}return l.contentWindow.postMessage(w,c),null};ee.postMessage=d;var E=function(){if(l&&l.parentNode)try{l.parentNode.removeChild(l)}catch{}ee.instance=l=null,ee.timeout=p=0};ee.dispose=E;var m=function(){G.clearTimeout(p)};return ee.clearTimeout=m,ee}var $r={},fn;function Ha(){return fn||(fn=1,function(e){e.__esModule=!0,e.default=void 0;var r=function(o,n){var a=o||".trezor-webusb-button",l=document.querySelectorAll(a),c=n+"?"+Date.now();l.forEach(function(h){if(h.getElementsByTagName("iframe").length<1){var p=h.getBoundingClientRect(),f=document.createElement("iframe");f.frameBorder="0",f.width=Math.round(p.width)+"px",f.height=Math.round(p.height)+"px",f.style.position="absolute",f.style.top="0px",f.style.left="0px",f.style.zIndex="1",f.setAttribute("allow","usb"),f.setAttribute("scrolling","no"),f.src=c,h.append(f)}})},t=r;e.default=t}($r)),$r}var $e={},dn;function za(){if(dn)return $e;dn=1,$e.__esModule=!0,$e.errorMessage=$e.parseMessage=void 0;var e=function(i){var o={event:i.event,type:i.type,payload:i.payload};return typeof i.id=="number"&&(o.id=i.id),typeof i.success=="boolean"&&(o.success=i.success),o};$e.parseMessage=e;var r=function(i){return{success:!1,payload:{error:i.message,code:i.code}}};return $e.errorMessage=r,$e}var Oe={},pn;function Va(){if(pn)return Oe;pn=1;var e=Qe;Oe.__esModule=!0,Oe.BlockchainMessage=Oe.ResponseMessage=Oe.TransportMessage=Oe.DeviceMessage=Oe.UiMessage=void 0;var r=e(gr()),t=je();function i(p,f){var u=Object.keys(p);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(p);f&&(v=v.filter(function(T){return Object.getOwnPropertyDescriptor(p,T).enumerable})),u.push.apply(u,v)}return u}function o(p){for(var f=1;f<arguments.length;f++){var u=arguments[f]!=null?arguments[f]:{};f%2?i(Object(u),!0).forEach(function(v){(0,r.default)(p,v,u[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(p,Object.getOwnPropertyDescriptors(u)):i(Object(u)).forEach(function(v){Object.defineProperty(p,v,Object.getOwnPropertyDescriptor(u,v))})}return p}var n=function(f,u){return{event:t.UI_EVENT,type:f,payload:u}};Oe.UiMessage=n;var a=function(f,u){return{event:t.DEVICE_EVENT,type:f,payload:u}};Oe.DeviceMessage=a;var l=function(f,u){return{event:t.TRANSPORT_EVENT,type:f,payload:u.error?o(o({},u),{},{error:u.error.message,code:u.error.code}):u}};Oe.TransportMessage=l;var c=function(f,u,v){return v===void 0&&(v=null),{event:t.RESPONSE_EVENT,type:t.RESPONSE_EVENT,id:f,success:u,payload:u?v:{error:v.error.message,code:v.error.code}}};Oe.ResponseMessage=c;var h=function(f,u){return{event:t.BLOCKCHAIN_EVENT,type:f,payload:u}};return Oe.BlockchainMessage=h,Oe}var xe={},hn;function Ja(){if(hn)return xe;hn=1;var e=Qe;xe.__esModule=!0,xe.parse=xe.corsValidator=xe.getEnv=xe.DEFAULT_PRIORITY=void 0;var r=e(gr());function t(T,y){var I=Object.keys(T);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(T);y&&(d=d.filter(function(E){return Object.getOwnPropertyDescriptor(T,E).enumerable})),I.push.apply(I,d)}return I}function i(T){for(var y=1;y<arguments.length;y++){var I=arguments[y]!=null?arguments[y]:{};y%2?t(Object(I),!0).forEach(function(d){(0,r.default)(T,d,I[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(T,Object.getOwnPropertyDescriptors(I)):t(Object(I)).forEach(function(d){Object.defineProperty(T,d,Object.getOwnPropertyDescriptor(I,d))})}return T}var o="8.2.12",n=o.split(".").map(function(T){return parseInt(T,10)}),a=n[0]+"/",l="https://connect.trezor.io/"+a,c=2;xe.DEFAULT_PRIORITY=c;var h={configSrc:"./data/config.json",version:o,debug:!1,priority:c,trustedHost:!1,connectSrc:l,iframeSrc:l+"iframe.html",popup:!0,popupSrc:l+"popup.html",webusbSrc:l+"webusb.html",transportReconnect:!1,webusb:!0,pendingTransportEvent:!0,supportedBrowser:typeof navigator<"u"?!/Trident|MSIE|Edge/.test(navigator.userAgent):!0,manifest:null,env:"web",lazyLoad:!1,timestamp:new Date().getTime(),interactionTimeout:600},p=function(y){if(y&&typeof y.email=="string"&&typeof y.appUrl=="string")return{email:y.email,appUrl:y.appUrl}},f=function(){if(typeof chrome<"u"&&chrome.runtime&&typeof chrome.runtime.onConnect<"u")return"webextension";if(typeof navigator<"u"){if(typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative")return"react-native";var y=navigator.userAgent.toLowerCase();if(y.indexOf(" electron/")>-1)return"electron"}return"web"};xe.getEnv=f;var u=function(y){if(typeof y=="string"&&(y.match(/^https:\/\/([A-Za-z0-9\-_]+\.)*trezor\.io\//)||y.match(/^https?:\/\/localhost:[58][0-9]{3}\//)||y.match(/^https:\/\/([A-Za-z0-9\-_]+\.)*sldev\.cz\//)||y.match(/^https?:\/\/([A-Za-z0-9\-_]+\.)*trezoriovpjcahpzkrewelclulmszwbqpzmzgub37gbcjlvluxtruqad\.onion\//)))return y};xe.corsValidator=u;var v=function(y){y===void 0&&(y={});var I=i({},h);if(Object.prototype.hasOwnProperty.call(y,"debug")&&(typeof y.debug=="boolean"?I.debug=y.debug:typeof y.debug=="string"&&(I.debug=y.debug==="true")),typeof y.connectSrc=="string"&&(I.connectSrc=y.connectSrc),typeof er<"u"&&typeof er.__TREZOR_CONNECT_SRC=="string"&&(I.connectSrc=u(er.__TREZOR_CONNECT_SRC),I.debug=!0),typeof G<"u"&&G.location&&typeof G.location.search=="string"){var d=G.location.search.split("&"),E=d.find(function(b){return b.indexOf("trezor-connect-src")>=0});if(E){var m=E.split("="),s=m[1];I.connectSrc=u(decodeURIComponent(s)),I.debug=!0}}var w=I.connectSrc||l;return I.iframeSrc=w+"iframe.html",I.popupSrc=w+"popup.html",I.webusbSrc=w+"webusb.html",typeof y.transportReconnect=="boolean"&&(I.transportReconnect=y.transportReconnect),typeof y.webusb=="boolean"&&(I.webusb=y.webusb),typeof y.popup=="boolean"&&(I.popup=y.popup),typeof y.lazyLoad=="boolean"&&(I.lazyLoad=y.lazyLoad),typeof y.pendingTransportEvent=="boolean"&&(I.pendingTransportEvent=y.pendingTransportEvent),typeof G<"u"&&G.location&&G.location.protocol==="file:"&&(I.origin="file://"+G.location.pathname,I.webusb=!1),typeof y.extension=="string"&&(I.extension=y.extension),typeof y.env=="string"?I.env=y.env:I.env=f(),typeof y.timestamp=="number"&&(I.timestamp=y.timestamp),typeof y.interactionTimeout=="number"&&(I.interactionTimeout=y.interactionTimeout),typeof y.manifest=="object"&&(I.manifest=p(y.manifest)),I};return xe.parse=v,xe}var Ue={},En;function Ya(){if(En)return Ue;En=1,Ue.__esModule=!0,Ue.getLog=Ue.enableLogByPrefix=Ue.enableLog=Ue.initLog=void 0;var e={DescriptorStream:"color: #77ab59",DeviceList:"color: #36802d",Device:"color: #bada55",Core:"color: #c9df8a",IFrame:"color: #FFFFFF; background: #f4a742;",Popup:"color: #f48a00"},r=100,t=function(){function c(p,f){this.prefix=p,this.enabled=f,this.messages=[],this.css=e[p]||"color: #000000; background: #FFFFFF;"}var h=c.prototype;return h.addMessage=function(f,u){for(var v=arguments.length,T=new Array(v>2?v-2:0),y=2;y<v;y++)T[y-2]=arguments[y];this.messages.push({level:f,prefix:u,message:T,timestamp:new Date().getTime()}),this.messages.length>r&&this.messages.shift()},h.log=function(){for(var f=arguments.length,u=new Array(f),v=0;v<f;v++)u[v]=arguments[v];if(this.addMessage.apply(this,["log",this.prefix].concat(u)),this.enabled){var T;(T=console).log.apply(T,[this.prefix].concat(u))}},h.error=function(){for(var f=arguments.length,u=new Array(f),v=0;v<f;v++)u[v]=arguments[v];if(this.addMessage.apply(this,["error",this.prefix].concat(u)),this.enabled){var T;(T=console).error.apply(T,[this.prefix].concat(u))}},h.warn=function(){for(var f=arguments.length,u=new Array(f),v=0;v<f;v++)u[v]=arguments[v];if(this.addMessage.apply(this,["warn",this.prefix].concat(u)),this.enabled){var T;(T=console).warn.apply(T,[this.prefix].concat(u))}},h.debug=function(){for(var f=arguments.length,u=new Array(f),v=0;v<f;v++)u[v]=arguments[v];if(this.addMessage.apply(this,["debug",this.prefix].concat(u)),this.enabled){var T;(T=console).log.apply(T,["%c"+this.prefix,this.css].concat(u))}},c}(),i={},o=function(h,p){var f=new t(h,!!p);return i[h]=f,f};Ue.initLog=o;var n=function(h){Object.keys(i).forEach(function(p){i[p].enabled=h})};Ue.enableLog=n;var a=function(h,p){i[h]&&(i[h].enabled=p)};Ue.enableLogByPrefix=a;var l=function(){var h=[];return Object.keys(i).forEach(function(p){h=h.concat(i[p].messages)}),h.sort(function(p,f){return p.timestamp-f.timestamp}),h};return Ue.getLog=l,Ue}var Zr={},vn={},_n={},gn;function bi(){return gn||(gn=1),_n}var mn={},yn;function Ii(){return yn||(yn=1,je()),mn}var Sn={},Tn;function Ni(){return Tn||(Tn=1),Sn}var B={},Rn;function Ai(){if(Rn)return B;Rn=1,B.__esModule=!0,B.Enum_TezosBallotType=B.Enum_TezosContractType=B.Enum_StellarSignerType=B.Enum_StellarMemoType=B.Enum_StellarAssetType=B.Enum_NEMImportanceTransferMode=B.Enum_NEMModificationType=B.Enum_NEMSupplyChangeType=B.Enum_NEMMosaicLevy=B.Enum_WordRequestType=B.Enum_RecoveryDeviceType=B.Enum_SdProtectOperationType=B.Enum_Capability=B.Enum_SafetyCheckLevel=B.Enum_BackupType=B.Enum_EthereumDataType=B.Enum_DebugButton=B.Enum_PinMatrixRequestType=B.Enum_ButtonRequestType=B.Enum_FailureType=B.Enum_CardanoTxWitnessType=B.Enum_CardanoTxSigningMode=B.Enum_CardanoTxAuxiliaryDataSupplementType=B.Enum_CardanoPoolRelayType=B.Enum_CardanoCertificateType=B.Enum_CardanoNativeScriptHashDisplayFormat=B.Enum_CardanoNativeScriptType=B.Enum_CardanoAddressType=B.Enum_CardanoDerivationType=B.Enum_RequestType=B.Enum_AmountUnit=B.Enum_DecredStakingSpendType=B.Enum_OutputScriptType=B.Enum_InputScriptType=B.Enum_BinanceTimeInForce=B.Enum_BinanceOrderSide=B.Enum_BinanceOrderType=void 0;var e=Object.freeze({OT_UNKNOWN:0,MARKET:1,LIMIT:2,OT_RESERVED:3});B.Enum_BinanceOrderType=e;var r=Object.freeze({SIDE_UNKNOWN:0,BUY:1,SELL:2});B.Enum_BinanceOrderSide=r;var t=Object.freeze({TIF_UNKNOWN:0,GTE:1,TIF_RESERVED:2,IOC:3});B.Enum_BinanceTimeInForce=t;var i=Object.freeze({SPENDADDRESS:0,SPENDMULTISIG:1,EXTERNAL:2,SPENDWITNESS:3,SPENDP2SHWITNESS:4,SPENDTAPROOT:5});B.Enum_InputScriptType=i;var o=Object.freeze({PAYTOADDRESS:0,PAYTOSCRIPTHASH:1,PAYTOMULTISIG:2,PAYTOOPRETURN:3,PAYTOWITNESS:4,PAYTOP2SHWITNESS:5,PAYTOTAPROOT:6});B.Enum_OutputScriptType=o;var n=Object.freeze({SSGen:0,SSRTX:1});B.Enum_DecredStakingSpendType=n;var a=Object.freeze({BITCOIN:0,MILLIBITCOIN:1,MICROBITCOIN:2,SATOSHI:3});B.Enum_AmountUnit=a;var l=Object.freeze({TXINPUT:0,TXOUTPUT:1,TXMETA:2,TXFINISHED:3,TXEXTRADATA:4,TXORIGINPUT:5,TXORIGOUTPUT:6,TXPAYMENTREQ:7});B.Enum_RequestType=l;var c=Object.freeze({LEDGER:0,ICARUS:1,ICARUS_TREZOR:2});B.Enum_CardanoDerivationType=c;var h=Object.freeze({BASE:0,BASE_SCRIPT_KEY:1,BASE_KEY_SCRIPT:2,BASE_SCRIPT_SCRIPT:3,POINTER:4,POINTER_SCRIPT:5,ENTERPRISE:6,ENTERPRISE_SCRIPT:7,BYRON:8,REWARD:14,REWARD_SCRIPT:15});B.Enum_CardanoAddressType=h;var p=Object.freeze({PUB_KEY:0,ALL:1,ANY:2,N_OF_K:3,INVALID_BEFORE:4,INVALID_HEREAFTER:5});B.Enum_CardanoNativeScriptType=p;var f=Object.freeze({HIDE:0,BECH32:1,POLICY_ID:2});B.Enum_CardanoNativeScriptHashDisplayFormat=f;var u=Object.freeze({STAKE_REGISTRATION:0,STAKE_DEREGISTRATION:1,STAKE_DELEGATION:2,STAKE_POOL_REGISTRATION:3});B.Enum_CardanoCertificateType=u;var v=Object.freeze({SINGLE_HOST_IP:0,SINGLE_HOST_NAME:1,MULTIPLE_HOST_NAME:2});B.Enum_CardanoPoolRelayType=v;var T=Object.freeze({NONE:0,CATALYST_REGISTRATION_SIGNATURE:1});B.Enum_CardanoTxAuxiliaryDataSupplementType=T;var y=Object.freeze({ORDINARY_TRANSACTION:0,POOL_REGISTRATION_AS_OWNER:1,MULTISIG_TRANSACTION:2,PLUTUS_TRANSACTION:3});B.Enum_CardanoTxSigningMode=y;var I=Object.freeze({BYRON_WITNESS:0,SHELLEY_WITNESS:1});B.Enum_CardanoTxWitnessType=I;var d=Object.freeze({Failure_UnexpectedMessage:1,Failure_ButtonExpected:2,Failure_DataError:3,Failure_ActionCancelled:4,Failure_PinExpected:5,Failure_PinCancelled:6,Failure_PinInvalid:7,Failure_InvalidSignature:8,Failure_ProcessError:9,Failure_NotEnoughFunds:10,Failure_NotInitialized:11,Failure_PinMismatch:12,Failure_WipeCodeMismatch:13,Failure_InvalidSession:14,Failure_FirmwareError:99});B.Enum_FailureType=d;var E=Object.freeze({ButtonRequest_Other:1,ButtonRequest_FeeOverThreshold:2,ButtonRequest_ConfirmOutput:3,ButtonRequest_ResetDevice:4,ButtonRequest_ConfirmWord:5,ButtonRequest_WipeDevice:6,ButtonRequest_ProtectCall:7,ButtonRequest_SignTx:8,ButtonRequest_FirmwareCheck:9,ButtonRequest_Address:10,ButtonRequest_PublicKey:11,ButtonRequest_MnemonicWordCount:12,ButtonRequest_MnemonicInput:13,_Deprecated_ButtonRequest_PassphraseType:14,ButtonRequest_UnknownDerivationPath:15,ButtonRequest_RecoveryHomepage:16,ButtonRequest_Success:17,ButtonRequest_Warning:18,ButtonRequest_PassphraseEntry:19,ButtonRequest_PinEntry:20});B.Enum_ButtonRequestType=E;var m=Object.freeze({PinMatrixRequestType_Current:1,PinMatrixRequestType_NewFirst:2,PinMatrixRequestType_NewSecond:3,PinMatrixRequestType_WipeCodeFirst:4,PinMatrixRequestType_WipeCodeSecond:5});B.Enum_PinMatrixRequestType=m;var s=Object.freeze({NO:0,YES:1,INFO:2});B.Enum_DebugButton=s;var w=Object.freeze({UINT:1,INT:2,BYTES:3,STRING:4,BOOL:5,ADDRESS:6,ARRAY:7,STRUCT:8});B.Enum_EthereumDataType=w;var b=Object.freeze({Bip39:0,Slip39_Basic:1,Slip39_Advanced:2});B.Enum_BackupType=b;var O=Object.freeze({Strict:0,PromptAlways:1,PromptTemporarily:2});B.Enum_SafetyCheckLevel=O;var C=Object.freeze({Capability_Bitcoin:1,Capability_Bitcoin_like:2,Capability_Binance:3,Capability_Cardano:4,Capability_Crypto:5,Capability_EOS:6,Capability_Ethereum:7,Capability_Lisk:8,Capability_Monero:9,Capability_NEM:10,Capability_Ripple:11,Capability_Stellar:12,Capability_Tezos:13,Capability_U2F:14,Capability_Shamir:15,Capability_ShamirGroups:16,Capability_PassphraseEntry:17});B.Enum_Capability=C;var q=Object.freeze({DISABLE:0,ENABLE:1,REFRESH:2});B.Enum_SdProtectOperationType=q;var K=Object.freeze({RecoveryDeviceType_ScrambledWords:0,RecoveryDeviceType_Matrix:1});B.Enum_RecoveryDeviceType=K;var j=Object.freeze({WordRequestType_Plain:0,WordRequestType_Matrix9:1,WordRequestType_Matrix6:2});B.Enum_WordRequestType=j;var J=Object.freeze({MosaicLevy_Absolute:1,MosaicLevy_Percentile:2});B.Enum_NEMMosaicLevy=J;var H=Object.freeze({SupplyChange_Increase:1,SupplyChange_Decrease:2});B.Enum_NEMSupplyChangeType=H;var de=Object.freeze({CosignatoryModification_Add:1,CosignatoryModification_Delete:2});B.Enum_NEMModificationType=de;var L=Object.freeze({ImportanceTransfer_Activate:1,ImportanceTransfer_Deactivate:2});B.Enum_NEMImportanceTransferMode=L;var R=Object.freeze({NATIVE:0,ALPHANUM4:1,ALPHANUM12:2});B.Enum_StellarAssetType=R;var U=Object.freeze({NONE:0,TEXT:1,ID:2,HASH:3,RETURN:4});B.Enum_StellarMemoType=U;var Q=Object.freeze({ACCOUNT:0,PRE_AUTH:1,HASH:2});B.Enum_StellarSignerType=Q;var M=Object.freeze({Implicit:0,Originated:1});B.Enum_TezosContractType=M;var x=Object.freeze({Yay:0,Nay:1,Pass:2});return B.Enum_TezosBallotType=x,B}var wn={},On;function Ci(){return On||(On=1),wn}var bn={},In;function Pi(){return In||(In=1),bn}var Nn={},An;function xi(){return An||(An=1),Nn}var Ee={},Cn;function Ui(){if(Cn)return Ee;Cn=1,Ee.__esModule=!0,Ee.CardanoTxWitnessType=Ee.CardanoTxSigningMode=Ee.CardanoPoolRelayType=Ee.CardanoNativeScriptHashDisplayFormat=Ee.CardanoNativeScriptType=Ee.CardanoCertificateType=Ee.CardanoAddressType=void 0;var e=Ai();return Ee.CardanoAddressType=e.Enum_CardanoAddressType,Ee.CardanoCertificateType=e.Enum_CardanoCertificateType,Ee.CardanoNativeScriptType=e.Enum_CardanoNativeScriptType,Ee.CardanoNativeScriptHashDisplayFormat=e.Enum_CardanoNativeScriptHashDisplayFormat,Ee.CardanoPoolRelayType=e.Enum_CardanoPoolRelayType,Ee.CardanoTxSigningMode=e.Enum_CardanoTxSigningMode,Ee.CardanoTxWitnessType=e.Enum_CardanoTxWitnessType,Ee}var Pn={},xn;function Mi(){return xn||(xn=1),Pn}var Un={},Mn;function Di(){return Mn||(Mn=1),Un}var Dn={},Ln;function Li(){return Ln||(Ln=1),Dn}var kn={},Bn;function ki(){return Bn||(Bn=1),kn}var Fn={},qn;function Bi(){return qn||(qn=1),Fn}var Kn={},Gn;function Fi(){return Gn||(Gn=1),Kn}var Wn={},Qn;function qi(){return Qn||(Qn=1),Wn}var jn={},Hn;function Ki(){return Hn||(Hn=1),jn}var zn={},Vn;function Gi(){return Vn||(Vn=1,je()),zn}var Jn={},Yn;function Wi(){return Yn||(Yn=1,je()),Jn}var Xn;function Xa(){if(Xn)return vn;Xn=1,r(je()),r(bi()),r(Ii()),r(Ni()),r(Ai()),r(Ci()),r(Pi()),r(xi()),r(Ui()),r(Mi()),r(Di()),r(Li()),r(ki()),r(Bi()),r(Fi()),r(qi()),r(Ki()),r(Gi()),r(Wi());function e(t){if(typeof WeakMap!="function")return null;var i=new WeakMap,o=new WeakMap;return(e=function(a){return a?o:i})(t)}function r(t,i){if(!i&&t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var o=e(i);if(o&&o.has(t))return o.get(t);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var c=a?Object.getOwnPropertyDescriptor(t,l):null;c&&(c.get||c.set)?Object.defineProperty(n,l,c):n[l]=t[l]}return n.default=t,o&&o.set(t,n),n}return vn}var $n={},Zn;function $a(){return Zn||(Zn=1),$n}var ei;function Qi(){return ei||(ei=1,function(e){e.__esModule=!0;var r=Xa();Object.keys(r).forEach(function(s){s==="default"||s==="__esModule"||s in e&&e[s]===r[s]||(e[s]=r[s])});var t=Gi();Object.keys(t).forEach(function(s){s==="default"||s==="__esModule"||s in e&&e[s]===t[s]||(e[s]=t[s])});var i=Ki();Object.keys(i).forEach(function(s){s==="default"||s==="__esModule"||s in e&&e[s]===i[s]||(e[s]=i[s])});var o=bi();Object.keys(o).forEach(function(s){s==="default"||s==="__esModule"||s in e&&e[s]===o[s]||(e[s]=o[s])});var n=Ci();Object.keys(n).forEach(function(s){s==="default"||s==="__esModule"||s in e&&e[s]===n[s]||(e[s]=n[s])});var a=Ii();Object.keys(a).forEach(function(s){s==="default"||s==="__esModule"||s in e&&e[s]===a[s]||(e[s]=a[s])});var l=Ni();Object.keys(l).forEach(function(s){s==="default"||s==="__esModule"||s in e&&e[s]===l[s]||(e[s]=l[s])});var c=Pi();Object.keys(c).forEach(function(s){s==="default"||s==="__esModule"||s in e&&e[s]===c[s]||(e[s]=c[s])});var h=xi();Object.keys(h).forEach(function(s){s==="default"||s==="__esModule"||s in e&&e[s]===h[s]||(e[s]=h[s])});var p=Ui();Object.keys(p).forEach(function(s){s==="default"||s==="__esModule"||s in e&&e[s]===p[s]||(e[s]=p[s])});var f=Mi();Object.keys(f).forEach(function(s){s==="default"||s==="__esModule"||s in e&&e[s]===f[s]||(e[s]=f[s])});var u=Di();Object.keys(u).forEach(function(s){s==="default"||s==="__esModule"||s in e&&e[s]===u[s]||(e[s]=u[s])});var v=Li();Object.keys(v).forEach(function(s){s==="default"||s==="__esModule"||s in e&&e[s]===v[s]||(e[s]=v[s])});var T=ki();Object.keys(T).forEach(function(s){s==="default"||s==="__esModule"||s in e&&e[s]===T[s]||(e[s]=T[s])});var y=Bi();Object.keys(y).forEach(function(s){s==="default"||s==="__esModule"||s in e&&e[s]===y[s]||(e[s]=y[s])});var I=Fi();Object.keys(I).forEach(function(s){s==="default"||s==="__esModule"||s in e&&e[s]===I[s]||(e[s]=I[s])});var d=qi();Object.keys(d).forEach(function(s){s==="default"||s==="__esModule"||s in e&&e[s]===d[s]||(e[s]=d[s])});var E=Wi();Object.keys(E).forEach(function(s){s==="default"||s==="__esModule"||s in e&&e[s]===E[s]||(e[s]=E[s])});var m=$a();Object.keys(m).forEach(function(s){s==="default"||s==="__esModule"||s in e&&e[s]===m[s]||(e[s]=m[s])})}(Zr)),Zr}var ri;function Za(){if(ri)return oe;ri=1;var e=Qe;oe.__esModule=!0,oe.disableWebUSB=oe.requestLogin=oe.customMessage=oe.getSettings=oe.renderWebUSBButton=oe.uiResponse=oe.call=oe.init=oe.cancel=oe.dispose=oe.manifest=oe.eventEmitter=void 0;var r=e(Or()),t=e(br()),i=e(gr()),o=e(ct()),n=e(Wa()),a=T(ja()),l=e(Ha()),c=za(),h=Va(),p=Ja(),f=Ya(),u=je();T(Qi());function v(M){if(typeof WeakMap!="function")return null;var x=new WeakMap,k=new WeakMap;return(v=function(g){return g?k:x})(M)}function T(M,x){if(!x&&M&&M.__esModule)return M;if(M===null||typeof M!="object"&&typeof M!="function")return{default:M};var k=v(x);if(k&&k.has(M))return k.get(M);var W={},g=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var _ in M)if(_!=="default"&&Object.prototype.hasOwnProperty.call(M,_)){var A=g?Object.getOwnPropertyDescriptor(M,_):null;A&&(A.get||A.set)?Object.defineProperty(W,_,A):W[_]=M[_]}return W.default=M,k&&k.set(M,W),W}function y(M,x){var k=Object.keys(M);if(Object.getOwnPropertySymbols){var W=Object.getOwnPropertySymbols(M);x&&(W=W.filter(function(g){return Object.getOwnPropertyDescriptor(M,g).enumerable})),k.push.apply(k,W)}return k}function I(M){for(var x=1;x<arguments.length;x++){var k=arguments[x]!=null?arguments[x]:{};x%2?y(Object(k),!0).forEach(function(W){(0,i.default)(M,W,k[W])}):Object.getOwnPropertyDescriptors?Object.defineProperties(M,Object.getOwnPropertyDescriptors(k)):y(Object(k)).forEach(function(W){Object.defineProperty(M,W,Object.getOwnPropertyDescriptor(k,W))})}return M}var d=new o.default;oe.eventEmitter=d;var E=(0,f.initLog)("[trezor-connect.js]"),m=(0,p.parse)(),s,w=function(){var x=new n.default(m);return x.on(u.POPUP.CLOSED,function(k){a.postMessage({type:u.POPUP.CLOSED,payload:k?{error:k}:null},!1)}),x},b=function(x){m=(0,p.parse)(I(I({},m),{},{manifest:x}))};oe.manifest=b;var O=function(){d.removeAllListeners(),a.dispose(),m=(0,p.parse)(),s&&s.close()};oe.dispose=O;var C=function(x){s&&s.emit(u.POPUP.CLOSED,x)};oe.cancel=C;var q=function(x){if(x.origin===a.origin){var k=(0,c.parseMessage)(x.data),W=k.event,g=k.type,_=k.payload,A=k.id||0;switch(E.log("handleMessage",k),W){case u.RESPONSE_EVENT:a.messagePromises[A]?(a.messagePromises[A].resolve({id:A,success:k.success,payload:_}),delete a.messagePromises[A]):E.warn("Unknown message id "+A);break;case u.DEVICE_EVENT:d.emit(W,k),d.emit(g,_);break;case u.TRANSPORT_EVENT:d.emit(W,k),d.emit(g,_);break;case u.BLOCKCHAIN_EVENT:d.emit(W,k),d.emit(g,_);break;case u.UI_EVENT:if(g===u.IFRAME.BOOTSTRAP){a.clearTimeout();break}g===u.IFRAME.LOADED&&a.initPromise.resolve(),g===u.IFRAME.ERROR&&a.initPromise.reject(_.error),d.emit(W,k),d.emit(g,_);break;default:E.log("Undefined message",W,x)}}},K=function(){var M=(0,t.default)(r.default.mark(function x(k){return r.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(k===void 0&&(k={}),console.warn("trezor-connect version 8 has been deprecated. Please start using @trezor/connect version 9 https://www.npmjs.com/package/@trezor/connect"),!a.instance){g.next=4;break}throw u.ERRORS.TypedError("Init_AlreadyInitialized");case 4:if(m=(0,p.parse)(I(I({},m),k)),m.manifest){g.next=7;break}throw u.ERRORS.TypedError("Init_ManifestMissing");case 7:if(!m.lazyLoad){g.next=10;break}return m.lazyLoad=!1,g.abrupt("return");case 10:return s||(s=w()),E.enabled=!!m.debug,G.addEventListener("message",q),G.addEventListener("unload",O),g.next=16,a.init(m);case 16:case"end":return g.stop()}},x)}));return function(k){return M.apply(this,arguments)}}();oe.init=K;var j=function(){var M=(0,t.default)(r.default.mark(function x(k){var W;return r.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(!(!a.instance&&!a.timeout)){_.next=15;break}if(m=(0,p.parse)(m),m.manifest){_.next=4;break}return _.abrupt("return",(0,c.errorMessage)(u.ERRORS.TypedError("Init_ManifestMissing")));case 4:return s||(s=w()),s.request(!0),_.prev=6,_.next=9,K(m);case 9:_.next=15;break;case 11:return _.prev=11,_.t0=_.catch(6),s&&(["Init_IframeBlocked","Init_IframeTimeout"].includes(_.t0.code)?s.postMessage((0,h.UiMessage)(u.UI.IFRAME_FAILURE)):s.close()),_.abrupt("return",(0,c.errorMessage)(_.t0));case 15:if(!a.timeout){_.next=17;break}return _.abrupt("return",(0,c.errorMessage)(u.ERRORS.TypedError("Init_ManifestMissing")));case 17:if(!a.error){_.next=19;break}return _.abrupt("return",(0,c.errorMessage)(a.error));case 19:return m.popup&&s&&s.request(),_.prev=20,_.next=23,a.postMessage({type:u.IFRAME.CALL,payload:k});case 23:if(W=_.sent,!W){_.next=27;break}return!W.success&&W.payload.code!=="Device_CallInProgress"&&s&&s.unlock(),_.abrupt("return",W);case 27:return s&&s.unlock(),_.abrupt("return",(0,c.errorMessage)(u.ERRORS.TypedError("Method_NoResponse")));case 31:return _.prev=31,_.t1=_.catch(20),E.error("__call error",_.t1),s&&s.close(),_.abrupt("return",(0,c.errorMessage)(_.t1));case 36:case"end":return _.stop()}},x,null,[[6,11],[20,31]])}));return function(k){return M.apply(this,arguments)}}();oe.call=j;var J=function(x){a.postMessage({event:u.UI_EVENT,type:u.UI.CUSTOM_MESSAGE_RESPONSE,payload:x})},H=function(x){if(!a.instance)throw u.ERRORS.TypedError("Init_NotInitialized");var k=x.type,W=x.payload;a.postMessage({event:u.UI_EVENT,type:k,payload:W})};oe.uiResponse=H;var de=function(x){(0,l.default)(x,m.webusbSrc)};oe.renderWebUSBButton=de;var L=function(){return a.instance?j({method:"getSettings"}):Promise.resolve((0,c.errorMessage)(u.ERRORS.TypedError("Init_NotInitialized")))};oe.getSettings=L;var R=function(){var M=(0,t.default)(r.default.mark(function x(k){var W,g,_;return r.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(a.instance){S.next=2;break}throw u.ERRORS.TypedError("Init_NotInitialized");case 2:if(typeof k.callback=="function"){S.next=4;break}return S.abrupt("return",(0,c.errorMessage)(u.ERRORS.TypedError("Method_CustomMessage_Callback")));case 4:return W=k.callback,g=function(){var z=(0,t.default)(r.default.mark(function V(ae){var te,ie;return r.default.wrap(function(re){for(;;)switch(re.prev=re.next){case 0:if(te=ae.data,!(te&&te.type===u.UI.CUSTOM_MESSAGE_REQUEST)){re.next=6;break}return re.next=4,W(te.payload);case 4:ie=re.sent,J(ie||{message:"release"});case 6:case"end":return re.stop()}},V)}));return function(ae){return z.apply(this,arguments)}}(),G.addEventListener("message",g,!1),S.next=9,j(I(I({method:"customMessage"},k),{},{callback:null}));case 9:return _=S.sent,G.removeEventListener("message",g),S.abrupt("return",_);case 12:case"end":return S.stop()}},x)}));return function(k){return M.apply(this,arguments)}}();oe.customMessage=R;var U=function(){var M=(0,t.default)(r.default.mark(function x(k){var W,g,_;return r.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(a.instance){S.next=2;break}throw u.ERRORS.TypedError("Init_NotInitialized");case 2:if(typeof k.callback!="function"){S.next=11;break}return W=k.callback,g=function(){var z=(0,t.default)(r.default.mark(function V(ae){var te,ie;return r.default.wrap(function(re){for(;;)switch(re.prev=re.next){case 0:if(te=ae.data,!(te&&te.type===u.UI.LOGIN_CHALLENGE_REQUEST)){re.next=12;break}return re.prev=2,re.next=5,W();case 5:ie=re.sent,a.postMessage({event:u.UI_EVENT,type:u.UI.LOGIN_CHALLENGE_RESPONSE,payload:ie}),re.next=12;break;case 9:re.prev=9,re.t0=re.catch(2),a.postMessage({event:u.UI_EVENT,type:u.UI.LOGIN_CHALLENGE_RESPONSE,payload:re.t0.message});case 12:case"end":return re.stop()}},V,null,[[2,9]])}));return function(ae){return z.apply(this,arguments)}}(),G.addEventListener("message",g,!1),S.next=8,j(I(I({method:"requestLogin"},k),{},{asyncChallenge:!0,callback:null}));case 8:return _=S.sent,G.removeEventListener("message",g),S.abrupt("return",_);case 11:return S.abrupt("return",j(I({method:"requestLogin"},k)));case 12:case"end":return S.stop()}},x)}));return function(k){return M.apply(this,arguments)}}();oe.requestLogin=U;var Q=function(){if(!a.instance)throw u.ERRORS.TypedError("Init_NotInitialized");a.postMessage({event:u.UI_EVENT,type:u.TRANSPORT.DISABLE_WEBUSB})};return oe.disableWebUSB=Q,oe}(function(e){var r=Qe;e.__esModule=!0;var t={};e.default=void 0;var i=r(gr()),o=je();Object.keys(o).forEach(function(f){f==="default"||f==="__esModule"||Object.prototype.hasOwnProperty.call(t,f)||f in e&&e[f]===o[f]||(e[f]=o[f])});var n=Za(),a=Qi();Object.keys(a).forEach(function(f){f==="default"||f==="__esModule"||Object.prototype.hasOwnProperty.call(t,f)||f in e&&e[f]===a[f]||(e[f]=a[f])});function l(f,u){var v=Object.keys(f);if(Object.getOwnPropertySymbols){var T=Object.getOwnPropertySymbols(f);u&&(T=T.filter(function(y){return Object.getOwnPropertyDescriptor(f,y).enumerable})),v.push.apply(v,T)}return v}function c(f){for(var u=1;u<arguments.length;u++){var v=arguments[u]!=null?arguments[u]:{};u%2?l(Object(v),!0).forEach(function(T){(0,i.default)(f,T,v[T])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(v)):l(Object(v)).forEach(function(T){Object.defineProperty(f,T,Object.getOwnPropertyDescriptor(v,T))})}return f}var h={manifest:n.manifest,init:n.init,getSettings:n.getSettings,on:function(u,v){n.eventEmitter.on(u,v)},off:function(u,v){n.eventEmitter.removeListener(u,v)},removeAllListeners:function(){n.eventEmitter.removeAllListeners()},uiResponse:n.uiResponse,blockchainGetAccountBalanceHistory:function(u){return(0,n.call)(c({method:"blockchainGetAccountBalanceHistory"},u))},blockchainGetCurrentFiatRates:function(u){return(0,n.call)(c({method:"blockchainGetCurrentFiatRates"},u))},blockchainGetFiatRatesForTimestamps:function(u){return(0,n.call)(c({method:"blockchainGetFiatRatesForTimestamps"},u))},blockchainDisconnect:function(u){return(0,n.call)(c({method:"blockchainDisconnect"},u))},blockchainEstimateFee:function(u){return(0,n.call)(c({method:"blockchainEstimateFee"},u))},blockchainGetTransactions:function(u){return(0,n.call)(c({method:"blockchainGetTransactions"},u))},blockchainSetCustomBackend:function(u){return(0,n.call)(c({method:"blockchainSetCustomBackend"},u))},blockchainSubscribe:function(u){return(0,n.call)(c({method:"blockchainSubscribe"},u))},blockchainSubscribeFiatRates:function(u){return(0,n.call)(c({method:"blockchainSubscribeFiatRates"},u))},blockchainUnsubscribe:function(u){return(0,n.call)(c({method:"blockchainUnsubscribe"},u))},blockchainUnsubscribeFiatRates:function(u){return(0,n.call)(c({method:"blockchainUnsubscribeFiatRates"},u))},customMessage:function(u){return(0,n.customMessage)(u)},requestLogin:function(u){return(0,n.requestLogin)(u)},cardanoGetAddress:function(u){var v=n.eventEmitter.listenerCount(o.UI.ADDRESS_VALIDATION)>0;return(0,n.call)(c(c({method:"cardanoGetAddress"},u),{},{useEventListener:v}))},cardanoGetNativeScriptHash:function(u){return(0,n.call)(c({method:"cardanoGetNativeScriptHash"},u))},cardanoGetPublicKey:function(u){return(0,n.call)(c({method:"cardanoGetPublicKey"},u))},cardanoSignTransaction:function(u){return(0,n.call)(c({method:"cardanoSignTransaction"},u))},cipherKeyValue:function(u){return(0,n.call)(c({method:"cipherKeyValue"},u))},composeTransaction:function(u){return(0,n.call)(c({method:"composeTransaction"},u))},ethereumGetAddress:function(u){var v=n.eventEmitter.listenerCount(o.UI.ADDRESS_VALIDATION)>0;return(0,n.call)(c(c({method:"ethereumGetAddress"},u),{},{useEventListener:v}))},ethereumGetPublicKey:function(u){return(0,n.call)(c({method:"ethereumGetPublicKey"},u))},ethereumSignMessage:function(u){return(0,n.call)(c({method:"ethereumSignMessage"},u))},ethereumSignTransaction:function(u){return(0,n.call)(c({method:"ethereumSignTransaction"},u))},ethereumSignTypedData:function(u){return(0,n.call)(c({method:"ethereumSignTypedData"},u))},ethereumVerifyMessage:function(u){return(0,n.call)(c({method:"ethereumVerifyMessage"},u))},getAccountInfo:function(u){return(0,n.call)(c({method:"getAccountInfo"},u))},getAddress:function(u){var v=n.eventEmitter.listenerCount(o.UI.ADDRESS_VALIDATION)>0;return(0,n.call)(c(c({method:"getAddress"},u),{},{useEventListener:v}))},getDeviceState:function(u){return(0,n.call)(c({method:"getDeviceState"},u))},getFeatures:function(u){return(0,n.call)(c({method:"getFeatures"},u))},getPublicKey:function(u){return(0,n.call)(c({method:"getPublicKey"},u))},liskGetAddress:function(){return(0,n.call)({method:"liskDeprecated"})},liskGetPublicKey:function(){return(0,n.call)({method:"liskDeprecated"})},liskSignMessage:function(){return(0,n.call)({method:"liskDeprecated"})},liskSignTransaction:function(){return(0,n.call)({method:"liskDeprecated"})},liskVerifyMessage:function(){return(0,n.call)({method:"liskDeprecated"})},nemGetAddress:function(u){var v=n.eventEmitter.listenerCount(o.UI.ADDRESS_VALIDATION)>0;return(0,n.call)(c(c({method:"nemGetAddress"},u),{},{useEventListener:v}))},nemSignTransaction:function(u){return(0,n.call)(c({method:"nemSignTransaction"},u))},pushTransaction:function(u){return(0,n.call)(c({method:"pushTransaction"},u))},rippleGetAddress:function(u){var v=n.eventEmitter.listenerCount(o.UI.ADDRESS_VALIDATION)>0;return(0,n.call)(c(c({method:"rippleGetAddress"},u),{},{useEventListener:v}))},rippleSignTransaction:function(u){return(0,n.call)(c({method:"rippleSignTransaction"},u))},signMessage:function(u){return(0,n.call)(c({method:"signMessage"},u))},signTransaction:function(u){return(0,n.call)(c({method:"signTransaction"},u))},stellarGetAddress:function(u){var v=n.eventEmitter.listenerCount(o.UI.ADDRESS_VALIDATION)>0;return(0,n.call)(c(c({method:"stellarGetAddress"},u),{},{useEventListener:v}))},stellarSignTransaction:function(u){return(0,n.call)(c({method:"stellarSignTransaction"},u))},tezosGetAddress:function(u){var v=n.eventEmitter.listenerCount(o.UI.ADDRESS_VALIDATION)>0;return(0,n.call)(c(c({method:"tezosGetAddress"},u),{},{useEventListener:v}))},tezosGetPublicKey:function(u){return(0,n.call)(c({method:"tezosGetPublicKey"},u))},tezosSignTransaction:function(u){return(0,n.call)(c({method:"tezosSignTransaction"},u))},eosGetPublicKey:function(u){return(0,n.call)(c({method:"eosGetPublicKey"},u))},eosSignTransaction:function(u){return(0,n.call)(c({method:"eosSignTransaction"},u))},binanceGetAddress:function(u){var v=n.eventEmitter.listenerCount(o.UI.ADDRESS_VALIDATION)>0;return(0,n.call)(c(c({method:"binanceGetAddress"},u),{},{useEventListener:v}))},binanceGetPublicKey:function(u){return(0,n.call)(c({method:"binanceGetPublicKey"},u))},binanceSignTransaction:function(u){return(0,n.call)(c({method:"binanceSignTransaction"},u))},verifyMessage:function(u){return(0,n.call)(c({method:"verifyMessage"},u))},resetDevice:function(u){return(0,n.call)(c({method:"resetDevice"},u))},wipeDevice:function(u){return(0,n.call)(c({method:"wipeDevice"},u))},applyFlags:function(u){return(0,n.call)(c({method:"applyFlags"},u))},applySettings:function(u){return(0,n.call)(c({method:"applySettings"},u))},backupDevice:function(u){return(0,n.call)(c({method:"backupDevice"},u))},changePin:function(u){return(0,n.call)(c({method:"changePin"},u))},firmwareUpdate:function(u){return(0,n.call)(c({method:"firmwareUpdate"},u))},recoveryDevice:function(u){return(0,n.call)(c({method:"recoveryDevice"},u))},getCoinInfo:function(u){return(0,n.call)(c({method:"getCoinInfo"},u))},rebootToBootloader:function(u){return(0,n.call)(c({method:"rebootToBootloader"},u))},setProxy:function(u){return(0,n.call)(c({method:"setProxy"},u))},dispose:n.dispose,cancel:n.cancel,renderWebUSBButton:n.renderWebUSBButton,disableWebUSB:n.disableWebUSB},p=h;e.default=p})(gi);const ti=ke(gi);var es=function(e){var r=0,t,i=e.weight;if(typeof e.ed25519PublicKey=="string"){var o=De.Keypair.fromPublicKey(e.ed25519PublicKey);t=o.rawPublicKey().toString("hex")}return e.preAuthTx instanceof Buffer&&(r=1,t=e.preAuthTx.toString("hex")),e.sha256Hash instanceof Buffer&&(r=2,t=e.sha256Hash.toString("hex")),{type:r,key:t,weight:i}},et=function(e){return e.isNative()?{type:0,code:e.getCode()}:{type:e.getAssetType()==="credit_alphanum4"?1:2,code:e.getCode(),issuer:e.getIssuer()}},rs=function(e){return new fo(e).times(1e7).toString()},ts=function(e){switch(e){case"pathPaymentStrictReceive":return"pathPayment";case"createPassiveSellOffer":return"createPassiveOffer";case"manageSellOffer":return"manageOffer";default:return e}},ns=function(e){switch(e.type){case De.MemoText:return{type:1,text:e.value};case De.MemoID:return{type:2,id:e.value};case De.MemoHash:return{type:3,hash:e.value?e.value.toString("hex"):""};case De.MemoReturn:return{type:4,hash:e.value?e.value.toString("hex"):""};default:return{type:0}}},is=function(e){if(e)return{minTime:Number.parseInt(e.minTime,10),maxTime:Number.parseInt(e.maxTime,10)}},os=function(e,r){var t=["amount","sendMax","destAmount","startingBalance","limit"],i=["asset","sendAsset","destAsset","selling","buying","line"],o=r.operations.map(function(n,a){var l=ne({},n);if(l.signer&&(l.signer=es(l.signer)),l.path&&(l.path=l.path.map(et)),typeof l.price=="string"){var c=r.tx.operations()[a];l.price={n:c.body().value().price().n(),d:c.body().value().price().d()}}if(t.forEach(function(p){typeof l[p]=="string"&&(l[p]=rs(l[p]))}),i.forEach(function(p){l[p]&&(l[p]=et(l[p]))}),l.type==="allowTrust"){var h=new De.Asset(l.assetCode,l.trustor);l.assetType=et(h).type}return l.type==="manageData"&&l.value&&(l.value=l.value.toString("hex")),l.type=ts(n.type),l});return{path:e,networkPassphrase:r.networkPassphrase,transaction:{source:r.source,fee:Number(r.fee),sequence:r.sequence,memo:ns(r.memo),timebounds:is(r.timeBounds),operations:o}}},as={keyType:be.trezor,signTransaction:function(e){return X(this,void 0,void 0,function(){var r,t,i,o,n,a,l;return $(this,function(c){switch(c.label){case 0:if(r=e.transaction,t=e.key,i=e.custom,t.privateKey!=="")throw new Error("Non-ledger key sent to ledger handler: "+JSON.stringify(t.publicKey));if(!i||!i.email||!i.appUrl)throw new Error(`Trezor Connect manifest with "email" and "appUrl" props is required.
        Make sure they are passed through "custom" prop.`);c.label=1;case 1:return c.trys.push([1,3,,4]),ti.manifest({email:i.email,appUrl:i.appUrl}),o=os("m/44'/148'/0'",r),[4,ti.stellarSignTransaction(o)];case 2:if(n=c.sent(),n.success)return a=Buffer.from(n.payload.signature,"hex").toString("base64"),r.addSignature(t.publicKey,a),[2,r];throw new Error(n.payload.error||"We couldn’t sign the transaction with Trezor.");case 3:throw l=c.sent(),new Error("We couldn’t sign the transaction with Trezor. "+l.toString()+".");case 4:return[2]}})})}},ss=function(){function e(r){var t;this.encrypterMap={},this.keyHandlerMap=(t={},t[be.albedo]=ko,t[be.ledger]=Oa,t[be.freighter]=qo,t[be.plaintextKey]=ba,t[be.trezor]=as,t),this.keyCache={},this.keyStore=r.keyStore,this.shouldCache=r.shouldCache||!1,this.defaultNetworkPassphrase=r.defaultNetworkPassphrase||De.Networks.PUBLIC}return e.prototype.registerKeyHandler=function(r){this.keyHandlerMap[r.keyType]=r},e.prototype.registerEncrypter=function(r){this.encrypterMap[r.name]=r},e.prototype.setDefaultNetworkPassphrase=function(r){this.defaultNetworkPassphrase=r},e.prototype.storeKey=function(r){return X(this,void 0,void 0,function(){var t,i,o,n,a,l,c,h;return $(this,function(p){switch(p.label){case 0:return t=r.key,i=r.password,o=r.encrypterName,n=t.id||""+Math.random(),a=ne({},t,{id:n}),l=this.encrypterMap[o],[4,l.encryptKey({key:a,password:i})];case 1:return c=p.sent(),[4,this.keyStore.storeKeys([c])];case 2:return h=p.sent(),this._writeIndexCache(a.id,a),[2,h[0]]}})})},e.prototype.loadKey=function(r,t){return X(this,void 0,void 0,function(){var i,o,n,a,l;return $(this,function(c){switch(c.label){case 0:return[4,this.keyStore.loadAllKeys()];case 1:if(i=c.sent(),o=i.filter(function(h){return h.id===r}),!o.length)throw new Error("Key not found with id '"+r+"'.");if(o.length>1)throw new Error("Too many keys found with id '"+r+"', that’s not supposed to happen!");n=o[0],a=this.encrypterMap[n.encrypterName],c.label=2;case 2:return c.trys.push([2,4,,5]),[4,a.decryptKey({encryptedKey:n,password:t})];case 3:return l=c.sent(),[3,5];case 4:throw c.sent(),new Error("Couldn’t decrypt key '"+r+"' with the supplied password.");case 5:return[2,l]}})})},e.prototype.loadAllKeyIds=function(){return X(this,void 0,void 0,function(){var r;return $(this,function(t){switch(t.label){case 0:return[4,this.keyStore.loadAllKeys()];case 1:return r=t.sent(),[2,r.map(function(i){return i.id})]}})})},e.prototype.removeKey=function(r){return X(this,void 0,void 0,function(){var t;return $(this,function(i){switch(i.label){case 0:return[4,this.keyStore.removeKey(r)];case 1:return t=i.sent(),this._writeIndexCache(r,void 0),[2,t]}})})},e.prototype.signTransaction=function(r){return X(this,void 0,void 0,function(){var t,i,o,n,a,l,c,h,p;return $(this,function(f){switch(f.label){case 0:return t=r.transaction,i=r.id,o=r.password,n=r.custom,a=this._readFromCache(i),a?[3,3]:[4,this.keyStore.loadKey(i)];case 1:if(l=f.sent(),!l)throw new Error("Couldn't sign the transaction: no key with id '"+i+"' found.");return c=this.encrypterMap[l.encrypterName],[4,c.decryptKey({encryptedKey:l,password:o})];case 2:a=f.sent(),this._writeIndexCache(i,a),f.label=3;case 3:return h=this.keyHandlerMap[a.type],[4,h.signTransaction({transaction:t,key:a,custom:n})];case 4:return p=f.sent(),[2,p]}})})},e.prototype.fetchAuthToken=function(r){return X(this,void 0,void 0,function(){var t,i,o,n,a,l,c,h,p,f,u,v,T,y,I,d,E,m,s,w,b,O,C,q,K,j,J,H,de,L;return $(this,function(R){switch(R.label){case 0:if(t=r.id,i=r.password,o=r.authServer,n=r.authServerKey,a=r.authServerHomeDomains,l=r.clientDomain,c=r.onChallengeTransactionSignature,h=c===void 0?function(U){return Promise.resolve(U)}:c,p=r.account,t===void 0)throw new Error("Required parameter `id` is missing!");if(i===void 0)throw new Error("Required parameter `password` is missing!");if(!o)throw new Error("Required parameter `authServer` is missing!");if(!n)throw new Error("Required parameter `authServerKey` is missing!");if(!a)throw new Error("Required parameter `authServerHomeDomains` is missing!");return f=this._readFromCache(t),f?[3,3]:[4,this.keyStore.loadKey(t)];case 1:if(u=R.sent(),!u)throw new Error("Couldn't fetch an auth token: no key with id '"+t+"' found.");return v=this.encrypterMap[u.encrypterName],[4,v.decryptKey({encryptedKey:u,password:i})];case 2:f=R.sent(),this._writeIndexCache(t,f),R.label=3;case 3:return p=p||f.publicKey,T=o+"?account="+encodeURIComponent(p),l&&(T+="&client_domain="+encodeURIComponent(l)),[4,fetch(T)];case 4:return y=R.sent(),y.status===200?[3,6]:[4,y.text()];case 5:throw I=R.sent(),new Error(`[KeyManager#fetchAuthToken] Failed to fetch a challenge transaction,
          error: `+JSON.stringify(I));case 6:return d=f.network||this.defaultNetworkPassphrase,[4,y.text()];case 7:E=R.sent();try{m=JSON.parse(E)}catch{throw new Error("Request for challenge returned invalid JSON: "+E)}if(m.error)throw new Error(m.error);if(m.network_passphrase!==void 0&&d!==m.network_passphrase)throw new Error('Network mismatch: the transfer server expects "'+m.network_passphrase+`", but you're using "`+d+'"');return s=sr.Utils.readChallengeTx(m.transaction,n,d,a,new URL(o).hostname).tx,[4,h(s)];case 8:return s=R.sent(),w=this.keyHandlerMap[f.type],[4,w.signTransaction({transaction:s,key:f})];case 9:return b=R.sent(),O=b.toEnvelope().toXDR().toString("base64"),[4,fetch(o,{method:"POST",body:JSON.stringify({transaction:O}),headers:{"Content-Type":"application/json"}})];case 10:return C=R.sent(),C.status===200?[3,12]:[4,C.text()];case 11:q=R.sent();try{throw K=JSON.parse(q),new Error(`[KeyManager#fetchAuthToken] Failed to return a signed transaction,
          error: `+K.error)}catch{throw new Error(`[KeyManager#fetchAuthToken] Failed to return a signed transaction,
          error code `+C.status+` and status text
          "`+q+'"')}R.label=12;case 12:return[4,C.text()];case 13:j=R.sent();try{if(J=JSON.parse(j),H=J.token,de=J.message,L=J.status,L===!1&&de)throw new Error(de);return[2,H]}catch{throw new Error(`[KeyManager#fetchAuthToken] Failed to validate signed transaction
        response, server responded with `+j)}return[2]}})})},e.prototype.changePassword=function(r){return X(this,void 0,void 0,function(){var t,i,o,n,a=this;return $(this,function(l){switch(l.label){case 0:return t=r.oldPassword,i=r.newPassword,[4,this.keyStore.loadAllKeys()];case 1:return o=l.sent(),[4,Promise.all(o.map(function(c){return X(a,void 0,void 0,function(){var h,p;return $(this,function(f){switch(f.label){case 0:return h=this.encrypterMap[c.encrypterName],[4,h.decryptKey({encryptedKey:c,password:t})];case 1:return p=f.sent(),this._writeIndexCache(p.id,p),[2,h.encryptKey({key:p,password:i})]}})})}))];case 2:return n=l.sent(),[2,this.keyStore.updateKeys(n)]}})})},e.prototype._readFromCache=function(r){if(this.shouldCache)return this.keyCache[r]},e.prototype._writeIndexCache=function(r,t){this.shouldCache&&t&&(this.keyCache[r]=t)},e}();function Be(e){var r=e.id;return{id:r}}var ni="stellarkeys",cs=function(){function e(){this.storage=null,this.prefix=ni}return e.prototype.configure=function(r){Object.assign(this,r)},e.prototype.hasKey=function(r){return X(this,void 0,void 0,function(){var t,i,o;return $(this,function(n){switch(n.label){case 0:return this.check(),this.storage===null?[3,2]:(o=(i=Object).keys,[4,this.storage.get(this.prefix+":"+r)]);case 1:return t=!!o.apply(i,[n.sent()]).length,[3,3];case 2:t=null,n.label=3;case 3:return[2,t]}})})},e.prototype.getKey=function(r){return X(this,void 0,void 0,function(){var t,i,o,n;return $(this,function(a){switch(a.label){case 0:return this.check(),t=this.prefix+":"+r,this.storage===null?[3,2]:[4,this.storage.get(t)];case 1:return o=a.sent(),[3,3];case 2:o=null,a.label=3;case 3:return i=o,n=i[t],[2,n||null]}})})},e.prototype.setKey=function(r,t){var i;return this.check(),this.storage!==null?this.storage.set((i={},i[this.prefix+":"+r]=ne({},t),i)):null},e.prototype.removeKey=function(r){return this.check(),this.storage!==null?this.storage.remove(this.prefix+":"+r):null},e.prototype.getAllKeys=function(){return X(this,void 0,void 0,function(){var r,t,i,o,n,a,l,c,h;return $(this,function(p){switch(p.label){case 0:return this.check(),r=RegExp("^"+ni+"\\:(.*)"),t=[],this.storage===null?[3,5]:[4,this.storage.get(null)];case 1:i=p.sent(),o=Object.keys(i),n=0,a=o,p.label=2;case 2:return n<a.length?(l=a[n],c=l,c!==null&&r.test(c)?[4,this.getKey(r.exec(c)[1])]:[3,4]):[3,5];case 3:h=p.sent(),h!==null&&t.push(h),p.label=4;case 4:return n++,[3,2];case 5:return[2,t]}})})},e.prototype.check=function(){if(this.storage===null)throw new Error("A storage object must have been set");if(this.prefix==="")throw new Error("A non-empty prefix must have been set");return this.storage!==null&&this.prefix!==""},e}(),us=function(){function e(){this.name="BrowserStorageKeyStore",this.keyStore=new cs}return e.prototype.configure=function(r){try{return this.keyStore.configure(r),Promise.resolve()}catch(t){return Promise.reject(t)}},e.prototype.storeKeys=function(r){return X(this,void 0,void 0,function(){var t,i,o,h,n,a,l,c,h;return $(this,function(p){switch(p.label){case 0:t=[],i=0,o=r,p.label=1;case 1:return i<o.length?(h=o[i],[4,this.keyStore.hasKey(h.id)]):[3,4];case 2:n=p.sent(),n&&t.push(h),p.label=3;case 3:return i++,[3,1];case 4:if(t.length)return[2,Promise.reject("Some keys were already stored in the keystore: "+t.map(function(f){return f.id}).join(", "))];for(a=[],l=0,c=r;l<c.length;l++)h=c[l],this.keyStore.setKey(h.id,h),a.push(Be(h));return[2,Promise.resolve(a)]}})})},e.prototype.updateKeys=function(r){var t=this,i=r.filter(function(n){return X(t,void 0,void 0,function(){return $(this,function(a){switch(a.label){case 0:return[4,this.keyStore.hasKey(n.id)];case 1:return[2,!a.sent()]}})})});if(i.length)return Promise.reject("Some keys couldn't be found in the keystore: "+i.map(function(n){return n.id}).join(", "));var o=r.map(function(n){return t.keyStore.setKey(n.id,n),Be(n)});return Promise.resolve(o)},e.prototype.loadKey=function(r){return X(this,void 0,void 0,function(){var t;return $(this,function(i){switch(i.label){case 0:return[4,this.keyStore.getKey(r)];case 1:return t=i.sent(),t?[2,Promise.resolve(t)]:[2,Promise.reject(r)]}})})},e.prototype.removeKey=function(r){return X(this,void 0,void 0,function(){var t,i;return $(this,function(o){switch(o.label){case 0:return this.keyStore.hasKey(r)?[4,this.keyStore.getKey(r)]:[2,Promise.reject(r)];case 1:return t=o.sent(),i=Be(t),this.keyStore.removeKey(r),[2,Promise.resolve(i)]}})})},e.prototype.loadAllKeys=function(){return X(this,void 0,void 0,function(){var r;return $(this,function(t){switch(t.label){case 0:return[4,this.keyStore.getAllKeys()];case 1:return r=t.sent(),[2,Promise.resolve(r)]}})})},e}(),ii="IdentityEncrypter",ls={name:ii,encryptKey:function(e){var r=e.key,t=r.type,i=r.privateKey,o=r.publicKey,n=r.path,a=r.extra,l=cr(r,["type","privateKey","publicKey","path","extra"]);return Promise.resolve(ne({},l,{encryptedBlob:JSON.stringify({type:t,publicKey:o,privateKey:i,path:n,extra:a}),encrypterName:ii,salt:"identity"}))},decryptKey:function(e){var r=e.encryptedKey,t=r;t.encrypterName,t.salt;var i=t.encryptedBlob,o=cr(t,["encrypterName","salt","encryptedBlob"]),n=JSON.parse(i);return Promise.resolve(ne({},o,n))}},fs=function(){function e(){this.storage=null,this.prefix="stellarkeys"}return e.prototype.configure=function(r){Object.assign(this,r)},e.prototype.hasKey=function(r){return this.check(),this.storage!==null?this.storage.getItem(this.prefix+":"+r)!==null:null},e.prototype.getKey=function(r){this.check();var t=this.storage!==null?this.storage.getItem(this.prefix+":"+r):null;return t?JSON.parse(t):null},e.prototype.setKey=function(r,t){return this.check(),this.storage!==null?this.storage.setItem(this.prefix+":"+r,JSON.stringify(ne({},t))):null},e.prototype.removeKey=function(r){return this.check(),this.storage!==null?this.storage.removeItem(this.prefix+":"+r):null},e.prototype.getAllKeys=function(){this.check();var r=RegExp("^"+this.prefix+"\\:(.*)"),t=[];if(this.storage!==null)for(var i=0;i<this.storage.length;i++){var o=this.storage.key(i);if(o!==null&&r.test(o)){var n=this.getKey(r.exec(o)[1]);n!==null&&t.push(n)}}return t},e.prototype.check=function(){if(this.storage===null)throw new Error("A storage object must have been set");if(this.prefix==="")throw new Error("A non-empty prefix must have been set");return this.storage!==null&&this.prefix!==""},e}(),ds=function(){function e(){this.name="LocalStorageKeyStore",this.keyStore=new fs}return e.prototype.configure=function(r){try{return this.keyStore.configure(r),Promise.resolve()}catch(t){return Promise.reject(t)}},e.prototype.storeKeys=function(r){var t=this,i=r.filter(function(n){return t.keyStore.hasKey(n.id)});if(i.length)return Promise.reject("Some keys were already stored in the keystore: "+i.map(function(n){return n.id}).join(", "));var o=r.map(function(n){return t.keyStore.setKey(n.id,n),Be(n)});return Promise.resolve(o)},e.prototype.updateKeys=function(r){var t=this,i=r.filter(function(n){return!t.keyStore.hasKey(n.id)});if(i.length)return Promise.reject("Some keys couldn't be found in the keystore: "+i.map(function(n){return n.id}).join(", "));var o=r.map(function(n){return t.keyStore.setKey(n.id,n),Be(n)});return Promise.resolve(o)},e.prototype.loadKey=function(r){var t=this.keyStore.getKey(r);return t?Promise.resolve(t):Promise.reject(r)},e.prototype.removeKey=function(r){if(!this.keyStore.hasKey(r))return Promise.reject(r);var t=Be(this.keyStore.getKey(r));return this.keyStore.removeKey(r),Promise.resolve(t)},e.prototype.loadAllKeys=function(){return Promise.resolve(this.keyStore.getAllKeys())},e}(),ps=function(){function e(){this.name="MemoryKeyStore",this.keyStore={}}return e.prototype.configure=function(){return Promise.resolve()},e.prototype.storeKeys=function(r){var t=this,i=r.filter(function(n){return!!t.keyStore[n.id]});if(i.length)return Promise.reject("Some keys were already stored in the keystore: "+i.map(function(n){return n.id}).join(", "));var o=r.map(function(n){return t.keyStore[n.id]=ne({},n),Be(t.keyStore[n.id])});return Promise.resolve(o)},e.prototype.updateKeys=function(r){var t=this,i=r.filter(function(n){return!t.keyStore[n.id]});if(i.length)return Promise.reject("Some keys couldn't be found in the keystore: "+i.map(function(n){return n.id}).join(", "));var o=r.map(function(n){var a=n.id;return t.keyStore[a]=ne({},n),Be(t.keyStore[a])});return Promise.resolve(o)},e.prototype.loadKey=function(r){return Promise.resolve(this.keyStore[r])},e.prototype.removeKey=function(r){if(!this.keyStore[r])return Promise.reject(r);var t=Be(this.keyStore[r]);return delete this.keyStore[r],Promise.resolve(t)},e.prototype.loadAllKeys=function(){return Promise.resolve(Object.values(this.keyStore).map(function(r){return r}))},e}(),ji={exports:{}};/*!
 * Fast "async" scrypt implementation in JavaScript.
 * Copyright (c) 2013-2016 Dmitry Chestnykh | BSD License
 * https://github.com/dchest/scrypt-async-js
 */(function(e){function r(t,i,o,n,a,l,c,h){function p(g){var _=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],A=1779033703,S=3144134277,z=1013904242,V=2773480762,ae=1359893119,te=2600822924,ie=528734635,ue=1541459225,re=new Array(64);function lr(Fe){for(var fr=0,P=Fe.length;P>=64;){var ve=A,ge=S,me=z,Ce=V,fe=ae,Ie=te,Ne=ie,Pe=ue,le,se,ye,Se,Ae;for(se=0;se<16;se++)ye=fr+se*4,re[se]=(Fe[ye]&255)<<24|(Fe[ye+1]&255)<<16|(Fe[ye+2]&255)<<8|Fe[ye+3]&255;for(se=16;se<64;se++)le=re[se-2],Se=(le>>>17|le<<32-17)^(le>>>19|le<<32-19)^le>>>10,le=re[se-15],Ae=(le>>>7|le<<32-7)^(le>>>18|le<<32-18)^le>>>3,re[se]=(Se+re[se-7]|0)+(Ae+re[se-16]|0)|0;for(se=0;se<64;se++)Se=(((fe>>>6|fe<<32-6)^(fe>>>11|fe<<32-11)^(fe>>>25|fe<<32-25))+(fe&Ie^~fe&Ne)|0)+(Pe+(_[se]+re[se]|0)|0)|0,Ae=((ve>>>2|ve<<32-2)^(ve>>>13|ve<<32-13)^(ve>>>22|ve<<32-22))+(ve&ge^ve&me^ge&me)|0,Pe=Ne,Ne=Ie,Ie=fe,fe=Ce+Se|0,Ce=me,me=ge,ge=ve,ve=Se+Ae|0;A=A+ve|0,S=S+ge|0,z=z+me|0,V=V+Ce|0,ae=ae+fe|0,te=te+Ie|0,ie=ie+Ne|0,ue=ue+Pe|0,fr+=64,P-=64}}lr(g);var nr,ir=g.length%64,He=g.length/536870912|0,ze=g.length<<3,mr=ir<56?56:120,_e=g.slice(g.length-ir,g.length);for(_e.push(128),nr=ir+1;nr<mr;nr++)_e.push(0);return _e.push(He>>>24&255),_e.push(He>>>16&255),_e.push(He>>>8&255),_e.push(He>>>0&255),_e.push(ze>>>24&255),_e.push(ze>>>16&255),_e.push(ze>>>8&255),_e.push(ze>>>0&255),lr(_e),[A>>>24&255,A>>>16&255,A>>>8&255,A>>>0&255,S>>>24&255,S>>>16&255,S>>>8&255,S>>>0&255,z>>>24&255,z>>>16&255,z>>>8&255,z>>>0&255,V>>>24&255,V>>>16&255,V>>>8&255,V>>>0&255,ae>>>24&255,ae>>>16&255,ae>>>8&255,ae>>>0&255,te>>>24&255,te>>>16&255,te>>>8&255,te>>>0&255,ie>>>24&255,ie>>>16&255,ie>>>8&255,ie>>>0&255,ue>>>24&255,ue>>>16&255,ue>>>8&255,ue>>>0&255]}function f(g,_,A){g.length>64&&(g=p(g.push?g:Array.prototype.slice.call(g,0)));var S,z=64+_.length+4,V=new Array(z),ae=new Array(64),te=[];for(S=0;S<64;S++)V[S]=54;for(S=0;S<g.length;S++)V[S]^=g[S];for(S=0;S<_.length;S++)V[64+S]=_[S];for(S=z-4;S<z;S++)V[S]=0;for(S=0;S<64;S++)ae[S]=92;for(S=0;S<g.length;S++)ae[S]^=g[S];function ie(){for(var ue=z-1;ue>=z-4;ue--){if(V[ue]++,V[ue]<=255)return;V[ue]=0}}for(;A>=32;)ie(),te=te.concat(p(ae.concat(p(V)))),A-=32;return A>0&&(ie(),te=te.concat(p(ae.concat(p(V))).slice(0,A))),te}function u(g,_,A,S){var z=g[0]^_[A++],V=g[1]^_[A++],ae=g[2]^_[A++],te=g[3]^_[A++],ie=g[4]^_[A++],ue=g[5]^_[A++],re=g[6]^_[A++],lr=g[7]^_[A++],nr=g[8]^_[A++],ir=g[9]^_[A++],He=g[10]^_[A++],ze=g[11]^_[A++],mr=g[12]^_[A++],_e=g[13]^_[A++],Fe=g[14]^_[A++],fr=g[15]^_[A++],P,ve,ge=z,me=V,Ce=ae,fe=te,Ie=ie,Ne=ue,Pe=re,le=lr,se=nr,ye=ir,Se=He,Ae=ze,Ve=mr,Je=_e,Ye=Fe,Xe=fr;for(ve=0;ve<8;ve+=2)P=ge+Ve,Ie^=P<<7|P>>>32-7,P=Ie+ge,se^=P<<9|P>>>32-9,P=se+Ie,Ve^=P<<13|P>>>32-13,P=Ve+se,ge^=P<<18|P>>>32-18,P=Ne+me,ye^=P<<7|P>>>32-7,P=ye+Ne,Je^=P<<9|P>>>32-9,P=Je+ye,me^=P<<13|P>>>32-13,P=me+Je,Ne^=P<<18|P>>>32-18,P=Se+Pe,Ye^=P<<7|P>>>32-7,P=Ye+Se,Ce^=P<<9|P>>>32-9,P=Ce+Ye,Pe^=P<<13|P>>>32-13,P=Pe+Ce,Se^=P<<18|P>>>32-18,P=Xe+Ae,fe^=P<<7|P>>>32-7,P=fe+Xe,le^=P<<9|P>>>32-9,P=le+fe,Ae^=P<<13|P>>>32-13,P=Ae+le,Xe^=P<<18|P>>>32-18,P=ge+fe,me^=P<<7|P>>>32-7,P=me+ge,Ce^=P<<9|P>>>32-9,P=Ce+me,fe^=P<<13|P>>>32-13,P=fe+Ce,ge^=P<<18|P>>>32-18,P=Ne+Ie,Pe^=P<<7|P>>>32-7,P=Pe+Ne,le^=P<<9|P>>>32-9,P=le+Pe,Ie^=P<<13|P>>>32-13,P=Ie+le,Ne^=P<<18|P>>>32-18,P=Se+ye,Ae^=P<<7|P>>>32-7,P=Ae+Se,se^=P<<9|P>>>32-9,P=se+Ae,ye^=P<<13|P>>>32-13,P=ye+se,Se^=P<<18|P>>>32-18,P=Xe+Ye,Ve^=P<<7|P>>>32-7,P=Ve+Xe,Je^=P<<9|P>>>32-9,P=Je+Ve,Ye^=P<<13|P>>>32-13,P=Ye+Je,Xe^=P<<18|P>>>32-18;_[S++]=g[0]=ge+z|0,_[S++]=g[1]=me+V|0,_[S++]=g[2]=Ce+ae|0,_[S++]=g[3]=fe+te|0,_[S++]=g[4]=Ie+ie|0,_[S++]=g[5]=Ne+ue|0,_[S++]=g[6]=Pe+re|0,_[S++]=g[7]=le+lr|0,_[S++]=g[8]=se+nr|0,_[S++]=g[9]=ye+ir|0,_[S++]=g[10]=Se+He|0,_[S++]=g[11]=Ae+ze|0,_[S++]=g[12]=Ve+mr|0,_[S++]=g[13]=Je+_e|0,_[S++]=g[14]=Ye+Fe|0,_[S++]=g[15]=Xe+fr|0}function v(g,_,A,S,z){for(;z--;)g[_++]=A[S++]}function T(g,_,A,S,z){for(;z--;)g[_++]^=A[S++]}function y(g,_,A,S,z){v(g,0,_,A+(2*z-1)*16,16);for(var V=0;V<2*z;V+=2)u(g,_,A+V*16,S+V*8),u(g,_,A+V*16+16,S+V*8+z*16)}function I(g,_,A){return g[_+(2*A-1)*16]}function d(g){for(var _=[],A=0;A<g.length;A++){var S=g.charCodeAt(A);if(S<128)_.push(S);else if(S<2048)_.push(192|S>>6),_.push(128|S&63);else if(S<55296)_.push(224|S>>12),_.push(128|S>>6&63),_.push(128|S&63);else{if(A>=g.length-1)throw new Error("invalid string");A++,S=(S&1023)<<10,S|=g.charCodeAt(A)&1023,S+=65536,_.push(240|S>>18),_.push(128|S>>12&63),_.push(128|S>>6&63),_.push(128|S&63)}}return _}function E(g){for(var _="0123456789abcdef".split(""),A=g.length,S=[],z=0;z<A;z++)S.push(_[g[z]>>>4&15]),S.push(_[g[z]>>>0&15]);return S.join("")}function m(g){for(var _="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),A=g.length,S=[],z=0,V,ae,te,ie;z<A;)V=z<A?g[z++]:0,ae=z<A?g[z++]:0,te=z<A?g[z++]:0,ie=(V<<16)+(ae<<8)+te,S.push(_[ie>>>3*6&63]),S.push(_[ie>>>2*6&63]),S.push(_[ie>>>1*6&63]),S.push(_[ie>>>0*6&63]);return A%3>0&&(S[S.length-1]="=",A%3===1&&(S[S.length-2]="=")),S.join("")}var s=-1>>>0,w=1;if(typeof o=="object"){if(arguments.length>4)throw new Error("scrypt: incorrect number of arguments");var b=o;if(c=n,o=b.logN,typeof o>"u")if(typeof b.N<"u"){if(b.N<2||b.N>s)throw new Error("scrypt: N is out of range");if(b.N&b.N-1)throw new Error("scrypt: N is not a power of 2");o=Math.log(b.N)/Math.LN2}else throw new Error("scrypt: missing N parameter");w=b.p||1,n=b.r,a=b.dkLen||32,l=b.interruptStep||0,h=b.encoding}if(w<1)throw new Error("scrypt: invalid p");if(n<=0)throw new Error("scrypt: invalid r");if(o<1||o>31)throw new Error("scrypt: logN must be between 1 and 31");var O=1<<o>>>0,C,q,K,j;if(n*w>=1<<30||n>s/128/w||n>s/256||O>s/128/n)throw new Error("scrypt: parameters are too large");typeof t=="string"&&(t=d(t)),typeof i=="string"&&(i=d(i)),typeof Int32Array<"u"?(C=new Int32Array(64*n),q=new Int32Array(32*O*n),j=new Int32Array(16)):(C=[],q=[],j=new Array(16)),K=f(t,i,w*128*n);var J=0,H=32*n;function de(g){for(var _=0;_<32*n;_++){var A=g+_*4;C[J+_]=(K[A+3]&255)<<24|(K[A+2]&255)<<16|(K[A+1]&255)<<8|(K[A+0]&255)<<0}}function L(g,_){for(var A=g;A<_;A+=2)v(q,A*(32*n),C,J,32*n),y(j,C,J,H,n),v(q,(A+1)*(32*n),C,H,32*n),y(j,C,H,J,n)}function R(g,_){for(var A=g;A<_;A+=2){var S=I(C,J,n)&O-1;T(C,J,q,S*(32*n),32*n),y(j,C,J,H,n),S=I(C,H,n)&O-1,T(C,H,q,S*(32*n),32*n),y(j,C,H,J,n)}}function U(g){for(var _=0;_<32*n;_++){var A=C[J+_];K[g+_*4+0]=A>>>0&255,K[g+_*4+1]=A>>>8&255,K[g+_*4+2]=A>>>16&255,K[g+_*4+3]=A>>>24&255}}var Q=typeof setImmediate<"u"?setImmediate:setTimeout;function M(g,_,A,S,z){(function V(){Q(function(){S(g,g+A<_?g+A:_),g+=A,g<_?V():z()})})()}function x(g){var _=f(t,K,a);return g==="base64"?m(_):g==="hex"?E(_):g==="binary"?new Uint8Array(_):_}function k(){for(var g=0;g<w;g++)de(g*128*n),L(0,O),R(0,O),U(g*128*n);c(x(h))}function W(g){de(g*128*n),M(0,O,l*2,L,function(){M(0,O,l*2,R,function(){U(g*128*n),g+1<w?Q(function(){W(g+1)}):c(x(h))})})}typeof l=="function"&&(h=c,c=l,l=1e3),l<=0?k():W(0)}e.exports=r})(ji);var hs=ji.exports;const Es=ke(hs);var Hi={exports:{}};(function(e){(function(r,t){e.exports?e.exports=t():(r.nacl||(r.nacl={}),r.nacl.util=t())})(er,function(){var r={};function t(i){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(i))throw new TypeError("invalid encoding")}return r.decodeUTF8=function(i){if(typeof i!="string")throw new TypeError("expected string");var o,n=unescape(encodeURIComponent(i)),a=new Uint8Array(n.length);for(o=0;o<n.length;o++)a[o]=n.charCodeAt(o);return a},r.encodeUTF8=function(i){var o,n=[];for(o=0;o<i.length;o++)n.push(String.fromCharCode(i[o]));return decodeURIComponent(escape(n.join("")))},typeof atob>"u"?typeof Buffer.from<"u"?(r.encodeBase64=function(i){return Buffer.from(i).toString("base64")},r.decodeBase64=function(i){return t(i),new Uint8Array(Array.prototype.slice.call(Buffer.from(i,"base64"),0))}):(r.encodeBase64=function(i){return new Buffer(i).toString("base64")},r.decodeBase64=function(i){return t(i),new Uint8Array(Array.prototype.slice.call(new Buffer(i,"base64"),0))}):(r.encodeBase64=function(i){var o,n=[],a=i.length;for(o=0;o<a;o++)n.push(String.fromCharCode(i[o]));return btoa(n.join(""))},r.decodeBase64=function(i){t(i);var o,n=atob(i),a=new Uint8Array(n.length);for(o=0;o<n.length;o++)a[o]=n.charCodeAt(o);return a}),r})})(Hi);var vs=Hi.exports;const vr=ke(vs);var _s=32,ot=Ge.secretbox.nonceLength;Ge.secretbox.keyLength;var zi=1,gs=zi,ms=Ge.secretbox.keyLength;function Vi(e){var r=e.password,t=e.salt,i=e.dkLen,o=i===void 0?ms:i,n=[32768,8,1],a=n[0],l=n[1],c=n[2];return new Promise(function(h,p){Es(r,t,{N:a,r:l,p:c,dkLen:o,encoding:"binary"},function(f){f?h(f):p(new Error("scryptPass failed, derivedKey is null"))})})}function ys(){return vr.encodeBase64(Ge.randomBytes(_s))}function Ss(e){return X(this,void 0,void 0,function(){var r,t,i,o,n,a,l,c,h,p;return $(this,function(f){switch(f.label){case 0:return r=e.phrase,t=e.password,i=e.salt,o=e.nonce,n=i||ys(),a=o||Ge.randomBytes(ot),[4,Vi({password:t,salt:n})];case 1:if(l=f.sent(),c=vr.decodeUTF8(r),h=Ge.secretbox(c,a,l),!h)throw new Error("Encryption failed");return p=new Uint8Array(1+a.length+h.length),p.set([gs]),p.set(a,1),p.set(h,1+a.length),[2,{encryptedPhrase:vr.encodeBase64(p),salt:n}]}})})}function Ts(e){return X(this,void 0,void 0,function(){var r,t,i,o,n,a,l,c,h;return $(this,function(p){switch(p.label){case 0:return r=e.phrase,t=e.password,i=e.salt,[4,Vi({password:t,salt:i})];case 1:if(o=p.sent(),n=vr.decodeBase64(r),a=n[0],a===zi)c=n.slice(1,1+ot),h=n.slice(1+ot),l=Ge.secretbox.open(h,c,o);else throw new Error("Cipher version "+a+" not supported.");if(!l)throw new Error("That passphrase wasn’t valid.");return[2,vr.encodeUTF8(l)]}})})}var oi="ScryptEncrypter",Rs={name:oi,encryptKey:function(e){return X(this,void 0,void 0,function(){var r,t,i,o,n,a,l,c,h,p,f;return $(this,function(u){switch(u.label){case 0:return r=e.key,t=e.password,i=r.privateKey,o=r.path,n=r.extra,a=r.publicKey,l=r.type,c=cr(r,["privateKey","path","extra","publicKey","type"]),[4,Ss({password:t,phrase:JSON.stringify({privateKey:i,path:o,extra:n,publicKey:a,type:l})})];case 1:return h=u.sent(),p=h.encryptedPhrase,f=h.salt,[2,ne({},c,{encryptedBlob:p,encrypterName:oi,salt:f})]}})})},decryptKey:function(e){return X(this,void 0,void 0,function(){var r,t,i,o,n,a,l,c;return $(this,function(h){switch(h.label){case 0:return r=e.encryptedKey,t=e.password,r.encrypterName,i=r.salt,o=r.encryptedBlob,n=cr(r,["encrypterName","salt","encryptedBlob"]),c=(l=JSON).parse,[4,Ts({phrase:o,salt:i,password:t})];case 1:return a=c.apply(l,[h.sent()]),[2,ne({},n,a)]}})})}},at={BrowserStorageKeyStore:us,IdentityEncrypter:ls,MemoryKeyStore:ps,LocalStorageKeyStore:ds,ScryptEncrypter:Rs},Ji={},ws=e=>encodeURIComponent(e).replace(/[!'()*]/g,r=>`%${r.charCodeAt(0).toString(16).toUpperCase()}`),Yi="%[a-f0-9]{2}",ai=new RegExp("("+Yi+")|([^%]+?)","gi"),si=new RegExp("("+Yi+")+","gi");function st(e,r){try{return[decodeURIComponent(e.join(""))]}catch{}if(e.length===1)return e;r=r||1;var t=e.slice(0,r),i=e.slice(r);return Array.prototype.concat.call([],st(t),st(i))}function Os(e){try{return decodeURIComponent(e)}catch{for(var r=e.match(ai)||[],t=1;t<r.length;t++)e=st(r,t).join(""),r=e.match(ai)||[];return e}}function bs(e){for(var r={"%FE%FF":"��","%FF%FE":"��"},t=si.exec(e);t;){try{r[t[0]]=decodeURIComponent(t[0])}catch{var i=Os(t[0]);i!==t[0]&&(r[t[0]]=i)}t=si.exec(e)}r["%C2"]="�";for(var o=Object.keys(r),n=0;n<o.length;n++){var a=o[n];e=e.replace(new RegExp(a,"g"),r[a])}return e}var Is=function(e){if(typeof e!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch{return bs(e)}},Ns=(e,r)=>{if(!(typeof e=="string"&&typeof r=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(r==="")return[e];const t=e.indexOf(r);return t===-1?[e]:[e.slice(0,t),e.slice(t+r.length)]},As=function(e,r){for(var t={},i=Object.keys(e),o=Array.isArray(r),n=0;n<i.length;n++){var a=i[n],l=e[a];(o?r.indexOf(a)!==-1:r(a,l,e))&&(t[a]=l)}return t};(function(e){const r=ws,t=Is,i=Ns,o=As,n=d=>d==null;function a(d){switch(d.arrayFormat){case"index":return E=>(m,s)=>{const w=m.length;return s===void 0||d.skipNull&&s===null||d.skipEmptyString&&s===""?m:s===null?[...m,[h(E,d),"[",w,"]"].join("")]:[...m,[h(E,d),"[",h(w,d),"]=",h(s,d)].join("")]};case"bracket":return E=>(m,s)=>s===void 0||d.skipNull&&s===null||d.skipEmptyString&&s===""?m:s===null?[...m,[h(E,d),"[]"].join("")]:[...m,[h(E,d),"[]=",h(s,d)].join("")];case"comma":case"separator":return E=>(m,s)=>s==null||s.length===0?m:m.length===0?[[h(E,d),"=",h(s,d)].join("")]:[[m,h(s,d)].join(d.arrayFormatSeparator)];default:return E=>(m,s)=>s===void 0||d.skipNull&&s===null||d.skipEmptyString&&s===""?m:s===null?[...m,h(E,d)]:[...m,[h(E,d),"=",h(s,d)].join("")]}}function l(d){let E;switch(d.arrayFormat){case"index":return(m,s,w)=>{if(E=/\[(\d*)\]$/.exec(m),m=m.replace(/\[\d*\]$/,""),!E){w[m]=s;return}w[m]===void 0&&(w[m]={}),w[m][E[1]]=s};case"bracket":return(m,s,w)=>{if(E=/(\[\])$/.exec(m),m=m.replace(/\[\]$/,""),!E){w[m]=s;return}if(w[m]===void 0){w[m]=[s];return}w[m]=[].concat(w[m],s)};case"comma":case"separator":return(m,s,w)=>{const b=typeof s=="string"&&s.includes(d.arrayFormatSeparator),O=typeof s=="string"&&!b&&p(s,d).includes(d.arrayFormatSeparator);s=O?p(s,d):s;const C=b||O?s.split(d.arrayFormatSeparator).map(q=>p(q,d)):s===null?s:p(s,d);w[m]=C};default:return(m,s,w)=>{if(w[m]===void 0){w[m]=s;return}w[m]=[].concat(w[m],s)}}}function c(d){if(typeof d!="string"||d.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function h(d,E){return E.encode?E.strict?r(d):encodeURIComponent(d):d}function p(d,E){return E.decode?t(d):d}function f(d){return Array.isArray(d)?d.sort():typeof d=="object"?f(Object.keys(d)).sort((E,m)=>Number(E)-Number(m)).map(E=>d[E]):d}function u(d){const E=d.indexOf("#");return E!==-1&&(d=d.slice(0,E)),d}function v(d){let E="";const m=d.indexOf("#");return m!==-1&&(E=d.slice(m)),E}function T(d){d=u(d);const E=d.indexOf("?");return E===-1?"":d.slice(E+1)}function y(d,E){return E.parseNumbers&&!Number.isNaN(Number(d))&&typeof d=="string"&&d.trim()!==""?d=Number(d):E.parseBooleans&&d!==null&&(d.toLowerCase()==="true"||d.toLowerCase()==="false")&&(d=d.toLowerCase()==="true"),d}function I(d,E){E=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},E),c(E.arrayFormatSeparator);const m=l(E),s=Object.create(null);if(typeof d!="string"||(d=d.trim().replace(/^[?#&]/,""),!d))return s;for(const w of d.split("&")){if(w==="")continue;let[b,O]=i(E.decode?w.replace(/\+/g," "):w,"=");O=O===void 0?null:["comma","separator"].includes(E.arrayFormat)?O:p(O,E),m(p(b,E),O,s)}for(const w of Object.keys(s)){const b=s[w];if(typeof b=="object"&&b!==null)for(const O of Object.keys(b))b[O]=y(b[O],E);else s[w]=y(b,E)}return E.sort===!1?s:(E.sort===!0?Object.keys(s).sort():Object.keys(s).sort(E.sort)).reduce((w,b)=>{const O=s[b];return O&&typeof O=="object"&&!Array.isArray(O)?w[b]=f(O):w[b]=O,w},Object.create(null))}e.extract=T,e.parse=I,e.stringify=(d,E)=>{if(!d)return"";E=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},E),c(E.arrayFormatSeparator);const m=O=>E.skipNull&&n(d[O])||E.skipEmptyString&&d[O]==="",s=a(E),w={};for(const O of Object.keys(d))m(O)||(w[O]=d[O]);const b=Object.keys(w);return E.sort!==!1&&b.sort(E.sort),b.map(O=>{const C=d[O];return C===void 0?"":C===null?h(O,E):Array.isArray(C)?C.reduce(s(O),[]).join("&"):h(O,E)+"="+h(C,E)}).filter(O=>O.length>0).join("&")},e.parseUrl=(d,E)=>{E=Object.assign({decode:!0},E);const[m,s]=i(d,"#");return Object.assign({url:m.split("?")[0]||"",query:I(T(d),E)},E&&E.parseFragmentIdentifier&&s?{fragmentIdentifier:p(s,E)}:{})},e.stringifyUrl=(d,E)=>{E=Object.assign({encode:!0,strict:!0},E);const m=u(d.url).split("?")[0]||"",s=e.extract(d.url),w=e.parse(s,{sort:!1}),b=Object.assign(w,d.query);let O=e.stringify(b,E);O&&(O=`?${O}`);let C=v(d.url);return d.fragmentIdentifier&&(C=`#${h(d.fragmentIdentifier,E)}`),`${m}${O}${C}`},e.pick=(d,E,m)=>{m=Object.assign({parseFragmentIdentifier:!0},m);const{url:s,query:w,fragmentIdentifier:b}=e.parseUrl(d,m);return e.stringifyUrl({url:s,query:o(w,E),fragmentIdentifier:b},m)},e.exclude=(d,E,m)=>{const s=Array.isArray(E)?w=>!E.includes(w):(w,b)=>!E(w,b);return e.pick(d,s,m)}})(Ji);const rr=ke(Ji);function gt(e){var r=new URL(e.response.url),t=r.origin,i=r.pathname,o=r.search,n=r.hash,a="",l=e,c=l.callback_url,h=l.request;if(c==="postMessage")a=(o?"&":"?")+"callback=postMessage";else if(c&&h){var p=new URL(c),f=ne({},rr.parse(p.search));f.request=encodeURIComponent(JSON.stringify(h)),p.search=rr.stringify(f),a=(o?"&":"?")+"callback="+encodeURIComponent(p.toString())}return""+t+i+o+a+n}function Xi(e){var r=e.response,t=e.window,i=new URL(r.url).origin;return new Promise(function(o,n){var a=function(l){l.origin===i&&(t.removeEventListener("message",a),t.close(),l.data.status==="success"?o(l.data):n(l.data))};t.addEventListener("message",a),t.location.href=gt({response:r,callback_url:"postMessage"})})}var Cs=co;function Ps(e,r){return Cs(e,r)}var xs=Ps;const ci=ke(xs);function Us(e){return e.withdraw!==void 0&&e.deposit!==void 0}function Ms(e){if(!Us(e))throw new Error("The endpoint didn't return a valid info response!");var r=e,t=r.fee,i=r.transactions,o=r.transaction;return{withdraw:Ls(e),deposit:ks(e),fee:t,transactions:i,transaction:o}}var $i=function(e,r){var t=e.fee_fixed,i=e.fee_percent;return t!==void 0&&Number(t)>=0||i!==void 0&&Number(i)>=0?{type:"simple",fixed:t,percent:i}:{type:r?"complex":"none"}};function Ds(e){var r=e[0],t=e[1];return{name:r,fields:Object.entries(t.fields||{}).map(Zi)}}function Zi(e){var r=e[0],t=e[1];return ne({},t,{name:r})}function Ls(e){return Object.entries(e.withdraw).reduce(function(r,t){var i=t[0],o=t[1],n=$i(o,!!(e.fee&&e.fee.enabled));return r[i]={asset_code:i,fee:n,min_amount:o.min_amount,max_amount:o.max_amount,authentication_required:!!o.authentication_required,types:Object.entries(o.types||{}).map(Ds)},r},{})}function ks(e){return Object.entries(e.deposit).reduce(function(r,t){var i=t[0],o=t[1],n=$i(o,!!(e.fee&&e.fee.enabled));return r[i]={asset_code:i,fee:n,min_amount:o.min_amount,max_amount:o.max_amount,authentication_required:!!o.authentication_required,fields:Object.entries(o.fields||{}).map(Zi)},r},{})}function ui(e){return e._id&&e.id===void 0&&(e.id=e._id),e.amount&&e.amount_in===void 0&&e.amount_out===void 0&&(e.amount_in=e.amount,e.amount_out=e.amount),e}var eo=function(){function e(r,t,i,o){if(!r)throw new Error("Required parameter `transferServer` missing!");if(!t)throw new Error("Required parameter `account` missing!");if(!o)throw new Error("Required parameter `operation` missing!");this.transferServer=r.replace(/\/$/,""),this.operation=o,this.account=t,this.lang=i,this._watchOneTransactionRegistry={},this._watchAllTransactionsRegistry={},this._transactionsRegistry={},this._transactionsIgnoredRegistry={},this._oneTransactionWatcher={}}return e.prototype.fetchInfo=function(){return X(this,void 0,void 0,function(){var r,t,i,o,n,a,l,c;return $(this,function(h){switch(h.label){case 0:return[4,fetch(this.transferServer+"/info?lang="+this.lang)];case 1:return r=h.sent(),r.ok?[3,3]:[4,r.text()];case 2:t=h.sent();try{throw i=JSON.parse(t),o=i.error,n=i.message,new Error("Error fetching info from "+this.transferServer+": error "+(o||n))}catch{throw new Error("Error fetching info from "+this.transferServer+`: error 
          code `+r.status+', response text: "'+t+'"')}h.label=3;case 3:return[4,r.text()];case 4:a=h.sent();try{return l=JSON.parse(a),c=Ms(l),this.info=c,[2,c]}catch{throw new Error("Error parsing the response of "+this.transferServer+"/info as JSON: "+a)}return[2]}})})},e.prototype.getHeaders=function(r){if(r===void 0&&(r={}),r.Authorization&&this.authToken)throw new Error("You passed an `Authorization` header that will get wiped out by SEP-10 auth");return new Headers(this.authToken?ne({},r,{Authorization:"Bearer "+this.authToken}):r)},e.prototype.setAuthToken=function(r){this.authToken=r},e.prototype.fetchTransactions=function(r){return X(this,void 0,void 0,function(){var t,i,o,n,a,l,c,h,p;return $(this,function(f){switch(f.label){case 0:return t=this.getAuthStatus("fetchTransactions",r.asset_code),r.show_all_transactions||(i=r.kind||(this.operation==="deposit"?"deposit":"withdrawal")),[4,fetch(this.transferServer+"/transactions?"+rr.stringify(ne({},r,{kind:i})),{headers:t?this.getHeaders():void 0})];case 1:return o=f.sent(),o.ok?[3,3]:[4,o.text()];case 2:n=f.sent();try{throw a=JSON.parse(n),l=a.error,c=a.message,new Error("Error fetching transactions from "+this.transferServer+": error "+(l||c))}catch{throw new Error("Error fetching transactions from "+this.transferServer+`: error 
          code `+o.status+', response text: "'+n+'"')}f.label=3;case 3:return[4,o.text()];case 4:h=f.sent();try{return p=JSON.parse(h).transactions,[2,p.map(ui)]}catch{throw new Error("Invalid transaction response from "+this.transferServer+": "+h)}return[2]}})})},e.prototype.fetchTransaction=function(r,t){return t===void 0&&(t=!1),X(this,void 0,void 0,function(){var i,o,n,a,l,c,h,p,f,u,v,T,y,I;return $(this,function(d){switch(d.label){case 0:if(i=r.asset_code,o=r.id,n=r.stellar_transaction_id,a=r.external_transaction_id,l=r.lang,o===void 0&&n===void 0&&a===void 0)throw new Error("fetchTransaction: One of `id`, `external_transaction_id`, or `stellar_transaction_id` must be provided! ");return c=this.getAuthStatus(t?"watchOneTransaction":"fetchTransaction",i),h={},o?h={id:o}:n?h={stellar_transaction_id:n}:a&&(h={external_transaction_id:a}),l&&(h=ne({lang:l},h)),[4,fetch(this.transferServer+"/transaction?"+rr.stringify(h),{headers:c?this.getHeaders():void 0})];case 1:return p=d.sent(),p.ok?[3,3]:[4,p.text()];case 2:f=d.sent();try{throw u=JSON.parse(f),v=u.error,T=u.message,new Error("Error fetching transaction "+h+" from "+this.transferServer+": error "+(v||T))}catch{throw new Error("Error fetching transaction "+h+" from "+this.transferServer+`: error 
          code `+p.status+', response text: "'+f+'"')}d.label=3;case 3:return[4,p.text()];case 4:y=d.sent();try{return I=JSON.parse(y).transaction,[2,ui(I)]}catch{throw new Error("Fetch transaction response wasn't valid JSON: "+y)}return[2]}})})},e.prototype.watchAllTransactions=function(r){var t=this,i,o=r.asset_code,n=r.onMessage,a=r.onError,l=r.watchlist,c=l===void 0?[]:l,h=r.timeout,p=h===void 0?5e3:h,f=r.isRetry,u=f===void 0?!1:f,v=cr(r,["asset_code","onMessage","onError","watchlist","timeout","isRetry"]),T=c.reduce(function(y,I){var d;return ne({},y,(d={},d[I]=!0,d))},{});return u||(this._watchAllTransactionsRegistry=ne({},this._watchAllTransactionsRegistry,(i={},i[o]=!0,i))),this.fetchTransactions(ne({asset_code:o},v||{})).then(function(y){if(t._watchAllTransactionsRegistry[o]){try{var I=y.filter(function(d){var E=d.status.indexOf("pending")===0||d.status===Me.incomplete,m=t._transactionsRegistry[o][d.id];return u?m?!ci(m,d):!!([Me.completed,Me.refunded,Me.error].includes(d.status)&&u&&!t._transactionsIgnoredRegistry[o][d.id]||E):T[d.id]?!0:(E||(t._transactionsIgnoredRegistry[o][d.id]=d),E)});I.forEach(function(d){t._transactionsRegistry[o][d.id]=d,d.status===Me.error?a(d):n(d)})}catch(d){a(d);return}t._allTransactionsWatcher&&clearTimeout(t._allTransactionsWatcher),t._allTransactionsWatcher=setTimeout(function(){t.watchAllTransactions(ne({asset_code:o,onMessage:n,onError:a,timeout:p,isRetry:!0},v||{}))},p)}}).catch(function(y){a(y)}),{refresh:function(){t._watchAllTransactionsRegistry[o]&&(t._allTransactionsWatcher&&clearTimeout(t._allTransactionsWatcher),t.watchAllTransactions(ne({asset_code:o,onMessage:n,onError:a,timeout:p,isRetry:!0},v||{})))},stop:function(){t._allTransactionsWatcher&&(t._watchAllTransactionsRegistry[o]=!1,t._transactionsRegistry[o]={},t._transactionsIgnoredRegistry[o]={},clearTimeout(t._allTransactionsWatcher))}}},e.prototype.watchOneTransaction=function(r){var t=this,i,o,n=r.asset_code,a=r.id,l=r.external_transaction_id,c=r.stellar_transaction_id,h=r.onMessage,p=r.onSuccess,f=r.onError,u=r.timeout,v=u===void 0?5e3:u,T=r.isRetry,y=T===void 0?!1:T,I=cr(r,["asset_code","id","external_transaction_id","stellar_transaction_id","onMessage","onSuccess","onError","timeout","isRetry"]),d=a||l||c;if(d===void 0)throw new Error("fetchTransaction: One of `id`, `external_transaction_id`, or `stellar_transaction_id` must be provided! ");return y||(this._watchOneTransactionRegistry=ne({},this._watchOneTransactionRegistry,(i={},i[n]=ne({},this._watchOneTransactionRegistry[n]||{},(o={},o[d]=!0,o)),i))),this.fetchTransaction(ne({asset_code:n,id:a},I||{}),!0).then(function(E){if(t._watchOneTransactionRegistry[n]&&t._watchOneTransactionRegistry[n][d]){var m=t._transactionsRegistry[n][E.id];m&&ci(m,E)||(t._transactionsRegistry[n][E.id]=E,E.status.indexOf("pending")===0?(t._oneTransactionWatcher[d]&&clearTimeout(t._oneTransactionWatcher[d]),t._oneTransactionWatcher[d]=setTimeout(function(){t.watchOneTransaction(ne({asset_code:n,id:a,external_transaction_id:l,stellar_transaction_id:c,onMessage:h,onSuccess:p,onError:f,timeout:v,isRetry:!0},I||{}))},v),h(E)):[Me.completed,Me.refunded].includes(E.status)?p(E):f(E))}}).catch(function(E){f(E)}),{refresh:function(){t._watchOneTransactionRegistry[n]&&t._watchOneTransactionRegistry[n][d]&&(t._oneTransactionWatcher[d]&&clearTimeout(t._oneTransactionWatcher[d]),t.watchOneTransaction(ne({asset_code:n,id:a,external_transaction_id:l,stellar_transaction_id:c,onMessage:h,onSuccess:p,onError:f,timeout:v,isRetry:!0},I||{})))},stop:function(){t._oneTransactionWatcher[d]&&(t._watchOneTransactionRegistry[n][d]=!1,clearTimeout(t._oneTransactionWatcher[d]))}}},e.prototype.fetchFinalFee=function(r){return X(this,void 0,void 0,function(){var t,i,o,n,a,l,c,h,p,f,u;return $(this,function(v){switch(v.label){case 0:if(!this.info||!this.info[this.operation])throw new Error("Run fetchSupportedAssets before running fetchFinalFee!");if(t=this.info[this.operation][r.asset_code],!t)throw new Error("Can't get fee for an unsupported asset, '"+r.asset_code);switch(i=t.fee,o=i.type,o){case"none":return[3,1];case"simple":return[3,2];case"complex":return[3,3]}return[3,8];case 1:return[2,0];case 2:return n=i,[2,(n.percent||0)/100*Number(r.amount)+(n.fixed||0)];case 3:return[4,fetch(this.transferServer+"/fee?"+rr.stringify(ne({},r,i,{operation:this.operation})))];case 4:return a=v.sent(),a.ok?[3,6]:[4,a.text()];case 5:l=v.sent();try{throw c=JSON.parse(l),h=c.error,p=c.message,new Error("Error fetching fees from "+this.transferServer+": error "+(h||p))}catch{throw new Error("Error fetching fees from "+this.transferServer+`: error 
              code `+a.status+', response text: "'+l+'"')}v.label=6;case 6:return[4,a.text()];case 7:f=v.sent();try{return u=JSON.parse(f).fee,[2,u]}catch{throw new Error("Fee endpoint returned invalid JSON: "+f)}v.label=8;case 8:throw new Error("Invalid fee type found! Got '"+i.type+"' but expected one of 'none', 'simple', 'complex'")}})})},e.prototype.getAuthStatus=function(r,t){if(!t)throw new Error("Required parameter `asset_code` not provided!");if(!this.info||!this.info[this.operation])throw new Error("Run fetchSupportedAssets before running "+r+"!");var i=this.info[this.operation][t];if(!i)throw new Error("Asset "+t+" is not supported by "+this.transferServer);if(!this.authToken)throw new Error(`
        Asset `+t+` requires authentication. Run KeyManager's 
        fetchAuthToken function, then run setAuthToken to set it.
        `);return!0},e}(),Bs=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;function Fs(e){return!!e.match(Bs)}(function(e){fi(r,e);function r(t,i,o){return o===void 0&&(o="en"),e.call(this,t,i,o,"deposit")||this}return r.prototype.startDeposit=function(t,i,o){return i===void 0&&(i=!1),o===void 0&&(o={}),X(this,void 0,void 0,function(){var n,a,l,c,h,p,f,u,T,v,T,y,I,d,E,m;return $(this,function(s){switch(s.label){case 0:return n=ne({},t,{account:this.account,lang:this.lang}),a=this.getAuthStatus("deposit",t.asset_code),i?(h=new FormData,Object.keys(n).forEach(function(w){h.append(w,n[w])}),[4,fetch(this.transferServer+"/transactions/deposit/interactive",{method:"POST",body:h,headers:a?this.getHeaders(o):void 0})]):[3,2];case 1:return l=s.sent(),[3,4];case 2:return p=rr.stringify(n),[4,fetch(this.transferServer+"/deposit?"+p,{headers:a?this.getHeaders(o):void 0})];case 3:l=s.sent(),s.label=4;case 4:return f=!i&&this.transferServer.includes("anchorusd.com"),!l.ok&&!f?[4,l.text()]:[3,6];case 5:u=s.sent();try{throw T=JSON.parse(u).error,new Error("Error starting deposit to "+this.transferServer+": error "+T)}catch{throw new Error("Error starting deposit to "+this.transferServer+`: error 
          code `+l.status+', status text: "'+u+'"')}s.label=6;case 6:return[4,l.text()];case 7:v=s.sent();try{c=JSON.parse(v)}catch{throw new Error("Error parsing the deposit response as JSON: "+v)}if(c.error)throw T=new Error(typeof c.error=="string"?c.error:JSON.stringify(c.error)),T.originalResponse=c,T;return a&&c.type===Le.interactive_customer_info_needed&&c.url&&c.url.indexOf("jwt")===-1&&(y=new URL(c.url),I=y.origin,d=y.pathname,E=y.search,m=y.hash,c.url=""+I+d+E+(E?"&":"?")+"jwt="+this.authToken+m),this.request=n,this.response=c,[2,c]}})})},r.prototype.fetchSupportedAssets=function(){return X(this,void 0,void 0,function(){var t,i=this;return $(this,function(o){switch(o.label){case 0:return[4,this.fetchInfo()];case 1:return t=o.sent().deposit,Object.keys(t).forEach(function(n){i._watchOneTransactionRegistry[n]=i._watchOneTransactionRegistry[n]||{},i._watchAllTransactionsRegistry[n]=!1,i._transactionsRegistry[n]=i._transactionsRegistry[n]||{},i._transactionsIgnoredRegistry[n]=i._transactionsIgnoredRegistry[n]||{}}),[2,t]}})})},r.prototype.getAssetInfo=function(t){if(!this.info||!this.info[this.operation])throw new Error("Run fetchSupportedAssets before running getAssetInfo!");if(!this.info[this.operation][t])throw new Error("Asset not supported: "+t);return this.info[this.operation][t]},r.prototype.fetchKycInBrowser=function(t){return X(this,void 0,void 0,function(){var i;return $(this,function(o){switch(o.label){case 0:if(!this.response||!this.request)throw new Error("Run startDeposit before calling fetchKycInBrowser!");if(this.response.type!==Le.interactive_customer_info_needed||!this.response.url)throw new Error("KYC not needed for this deposit!");return[4,Xi({response:this.response,request:this.request,window:t})];case 1:if(i=o.sent(),i.type===Le.customer_info_status)switch(i.status){case"denied":return[2,Promise.reject(i)];case"pending":return[2,Promise.reject(i)];case"success":return[2,Promise.resolve(i)];default:throw new Error("Invalid KYC response received: '"+i.status+"'.")}return i.status===Me.completed?[2,Promise.resolve(i)]:[2,Promise.reject(i)]}})})},r.prototype.getKycUrl=function(t){if(!this.response||!this.request)throw new Error("Run startDeposit before calling getKycUrl!");if(this.response.type!==Le.interactive_customer_info_needed||!this.response.url)throw new Error("KYC not needed for this deposit!");return gt({response:this.response,request:this.request,callback_url:t})},r.prototype.validateFields=function(t,i){if(!this.info||!this.info[this.operation])throw new Error("Run fetchSupportedAssets before running fetchFinalFee!");var o=this.info[this.operation][t];if(!o)throw new Error("Can't get fee for an unsupported asset, '"+t);var n=o.fields||[];return n.reduce(function(a,l){if(!a||l.optional)return a;var c=i[l.name];if(!c)return!1;if(l.choices){var h=l.choices.reduce(function(p,f){var u;return ne({},p,(u={},u[f]=!0,u))},{});if(!h[c])return!1}return l.name==="email"||l.name==="email_address"&&!Fs(c)||l.name==="amount"&&isNaN(parseFloat(c))?!1:a},!0)},r})(eo);(function(e){fi(r,e);function r(t,i,o){return o===void 0&&(o="en"),e.call(this,t,i,o,"withdraw")||this}return r.prototype.startWithdraw=function(t,i,o){return i===void 0&&(i=!1),o===void 0&&(o={}),X(this,void 0,void 0,function(){var n,a,l,c,h,p,f,u,T,v,T,y,I,d,E,m;return $(this,function(s){switch(s.label){case 0:return n=ne({},t,{account:this.account,lang:this.lang}),a=this.getAuthStatus("withdraw",t.asset_code),i?(h=new FormData,Object.keys(n).forEach(function(w){h.append(w,n[w])}),[4,fetch(this.transferServer+"/transactions/withdraw/interactive",{method:"POST",body:h,headers:a?this.getHeaders(o):void 0})]):[3,2];case 1:return l=s.sent(),[3,4];case 2:return p=rr.stringify(n),[4,fetch(this.transferServer+"/withdraw?"+p,{headers:a?this.getHeaders(o):void 0})];case 3:l=s.sent(),s.label=4;case 4:return f=!i&&this.transferServer.includes("anchorusd.com"),!l.ok&&!f?[4,l.text()]:[3,6];case 5:u=s.sent();try{throw T=JSON.parse(u).error,new Error("Error starting withdrawal to "+this.transferServer+": error "+T)}catch{throw new Error("Error starting withdrawal to "+this.transferServer+`: error 
          code `+l.status+', status text: "'+u+'"')}s.label=6;case 6:return[4,l.text()];case 7:v=s.sent();try{c=JSON.parse(v)}catch{throw new Error("Error parsing the deposit response as JSON: "+v)}if(c.error)throw T=new Error(c.error),T.originalResponse=c,T;return a&&c.type===Le.interactive_customer_info_needed&&c.url&&c.url.indexOf("jwt")===-1&&(y=new URL(c.url),I=y.origin,d=y.pathname,E=y.search,m=y.hash,c.url=""+I+d+E+(E?"&":"?")+"jwt="+this.authToken+m),this.request=n,this.response=c,[2,c]}})})},r.prototype.fetchSupportedAssets=function(){return X(this,void 0,void 0,function(){var t,i=this;return $(this,function(o){switch(o.label){case 0:return[4,this.fetchInfo()];case 1:return t=o.sent().withdraw,Object.keys(t).forEach(function(n){i._watchOneTransactionRegistry[n]=i._watchOneTransactionRegistry[n]||{},i._watchAllTransactionsRegistry[n]=!1,i._transactionsRegistry[n]=i._transactionsRegistry[n]||{},i._transactionsIgnoredRegistry[n]=i._transactionsIgnoredRegistry[n]||{}}),[2,t]}})})},r.prototype.getAssetInfo=function(t){if(!this.info||!this.info[this.operation])throw new Error("Run fetchSupportedAssets before running getAssetInfo!");if(!this.info[this.operation][t])throw new Error("Asset not supported: "+t);return this.info[this.operation][t]},r.prototype.fetchKycInBrowser=function(t){return X(this,void 0,void 0,function(){var i;return $(this,function(o){switch(o.label){case 0:if(!this.response||!this.request)throw new Error("Run startWithdraw before calling fetchKycInBrowser!");if(this.response.type!==Le.interactive_customer_info_needed||!this.response.url)throw new Error("KYC not needed for this withdrawal!");return[4,Xi({response:this.response,request:this.request,window:t})];case 1:if(i=o.sent(),i.type===Le.customer_info_status)switch(i.status){case"denied":return[2,Promise.reject(i)];case"pending":return[2,Promise.reject(i)];case"success":return[2,Promise.resolve(i)];default:throw new Error("Invalid KYC response received: '"+i.status+"'.")}return i.status===Me.completed?[2,Promise.resolve(i)]:[2,Promise.reject(i)]}})})},r.prototype.getKycUrl=function(t){if(!this.response||!this.request)throw new Error("Run startWithdraw before calling getKycUrl!");if(this.response.type!==Le.interactive_customer_info_needed||!this.response.url)throw new Error("KYC not needed for this withdrawal!");return gt({response:this.response,request:this.request,callback_url:t})},r})(eo);function qs(){const{subscribe:e,set:r}=uo("bpa:walletStore",{keyId:"",publicKey:""});return{subscribe:e,register:async({publicKey:t,secretKey:i,pincode:o})=>{try{let a=await rt().storeKey({key:{type:be.plaintextKey,publicKey:t,privateKey:i},password:o,encrypterName:at.ScryptEncrypter.name});r({keyId:a.id,publicKey:t,devInfo:{secretKey:i}})}catch(n){throw console.error("Error saving key",n),yr(400,{message:n.toString()})}},confirmPincode:async({pincode:t,firstPincode:i="",signup:o=!1})=>{if(o){if(t!==i)throw yr(400,{message:"pincode mismatch"})}else try{const n=rt();let{keyId:a}=mt(li);await n.loadKey(a,t)}catch{throw yr(400,{message:"invalid pincode"})}},sign:async({transactionXDR:t,network:i,pincode:o})=>{try{return await rt().signTransaction({transaction:sr.TransactionBuilder.fromXDR(t,i),id:mt(li).keyId,password:o})}catch(n){throw console.error("Error signing transaction",n),yr(400,{message:n.toString()})}}}}const li=qs(),rt=()=>{const e=new at.LocalStorageKeyStore;e.configure({prefix:"bpa",storage:localStorage});const r=new ss({keyStore:e});return r.registerEncrypter(at.ScryptEncrypter),r};export{li as w};
